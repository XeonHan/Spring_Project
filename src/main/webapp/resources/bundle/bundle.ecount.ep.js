window.__define_resource&&__define_resource("MSG10490","LBL14183","LBL02267","LBL02928","MSG06982","MSG10837","MSG05158","LBL21020","LBL40237","LBL12940","MSG07380","MSG07402","MSG10831","MSG07379","MSG01396","LBL40117","BTN00108","LBL10378","BTN00133","BTN00357","MSG00729","LBL01593","LBL12561","LBL12562","LBL08150","MSG05582","MSG05733","MSG03611","LBL10811","LBL10810","LBL20566","LBL05716","LBL20558","LBL08162","BTN00168","LBL18571","LBL00301","LBL05639","LBL18572","LBL18573","LBL18574","MSG80035","LBL02482","LBL03786","LBL02684","LBL02509","LBL00228","LBL70053","BTN00425");ecount.class("ecount.widget",null,{init:function(n){if(this.getInitData){var t=this.getInitData(n);t&&this.setInitData&&this.setInitData(t)}$.extend(this,n);try{ecount.runtime.notify(ECountEvent.Type.INITIALIZED_WIDGET,null,{ecPageID:this.ecPageID,layoutType:this.__type})}catch(i){}},destroy:function(){this.$el&&this.$el.remove()},render:function(n){this.setDefault&&this.setDefault();this.$el=this.useTemplateOnlyRender?$(this.template):$(ecount.widget.parseHTML.apply(this));this.hidden&&this.$el.hide();n.append(this.$el)}});ecount.widget.initializer="ecount#initializer";ecount.widget.initializerByCombine="ecount#initializerByCombine";ecount.widget.beforeAutoCompleteRequest="ecount#beforeAutoComplete";ecount.widget.autocompleteBeforeSelected="ecount#autocompleteBeforeSelected";ecount.widget.PROCESSBOOKMARK="ecount#processbookmark";ecount.widget.FORM_LOAD_COMPLETE="ecount#formLoadComplete";ecount.widget.RESIZE_FORM_HEADER="ecount#resizeFormHeader";ecount.widget.preInitPopupHandler="ecount#preInitPopupHandler";ecount.widget.LAZY_INITIALIZER="ecount#lazyInitializer";ecount.widget.LAZY_RENDER_CONTROL_GRID="ecount#lazyRenderControlGrid";ecount.widget.LAZY_RENDER_CONTROL="ecount#lazyRender";ecount.widget.serverNowDate="ecount#serverNowDate";ecount.widget.createEcPath=function(n,t,i,r,u,f,e){return[n||"",t||"",i||"",r||"",u||"",f||"",e||""].join(ecount.separator.ecPath)};ecount.widget.regisetrRequiredControlEvent=function(n){n.events.on({"control.change":n._ON_CHANGE_CONTROL,"control.openPopup":n._ON_POPUP,"anchor.click":n._ON_CLICK_CONTROL,"button.click":n._ON_CLICK_CONTROL,"dropdown.click":n._ON_CLICK_CONTROL,onClickControl:n._ON_CLICK_CONTROL,"control.focusout":n._ON_MOVE_FOCUS,"control.showError":n._ON_SHOWERROR_CONTROL,"control.hideError":n._ON_HIDEERROR_CONTROL,scope:n})};ecount.widget.serialize=function(n,t){var r={},i=null;return n.length===undefined&&(n=[n]),Array.prototype.forEach.call(n,function(n){n.isSerializeEnabled()&&(i=n.serialize(t?n.id:null),i&&($.isArray(i)?i.forEach(function(n){n&&(r[n.key]=n.value)}):(n._hideDateControl&&(r[n.name+"_DATECHK"]=i[n.name+"_DATECHK"]),n.useFnActivedItem()&&(r[n.name+"_FN"]=i[n.name+"_FN"]),r[i.key]=i.value)))}),r};ecount.widget.serializeWrap=function(n,t){var u={},r={},i=null;return n.length===undefined&&(n=[n]),Array.prototype.forEach.call(n,function(n){n.isSerializeEnabled()&&(i=n.serialize(t?n.id:null),i&&(r={},$.isArray(i)?i.forEach(function(n){n&&(r[n.key]=n.value)}):(n._hideDateControl&&(r[n.name+"_DATECHK"]=i[n.name+"_DATECHK"]),n.useFnActivedItem()&&(r[n.name+"_FN"]=i[n.name+"_FN"]),r[i.key]=i.value),u[n.id]=r))}),u};ecount.widget.serializeAdditionalData=function(n,t){var r={},i=null;return n.length===undefined&&(n=[n]),Array.prototype.forEach.call(n,function(n){i=n.serializeAdditionalData(t?n.id:null);i&&($.isArray(i)?i.forEach(function(n){n&&(r[n.key]={name:n.name,value:n.value})}):r[n.id]={name:i.name,value:i.value})}),r};ecount.widget.createDisplayID=function(n,t,i){function u(n,t){var r,i;if(n)for(i=0;i<t.length;i++)if(r=t[i],n.indexOf(r)>-1)return r;return n}var r=n.controlType;r=u(r,["widget.button","widget.link","widget.list"]);switch(r){case"widget.link":case"widget.link.dataToggle":case"widget.button":case"widget.button.group":case"widget.button.nextSlip":case"widget.searchGroup":case"widget.checkbox.linkLabel":case"widget.input.buttonGroup":case"widget.itemList":case"widget.button.loadSlip":case"widget.button.electronicApproval":case"widget.topBottomSetting":case"widget.list":case"widget.button.search":case"widget.button.dropdownList":case"widget.category":n.displayID=[t,i,n.id].join("-")}};ecount.widget.extract=function(n){var t={};return $(n).each(function(n,i){t[i.id]=i.extract.call(i)}),t};ecount.widget.clone=function(n){var t={};return $(n).each(function(n,i){t[i.id]=i.clone.call(i)}),t};ecount.widget.replaceAttr=function(n,t){var i,r;t.pcid&&(n=n.split("{{cid}}").join('{{cid}}" data-pcid="'+t.pcid));for(r in t)if(i=t[r],r!="pcid"){switch(r){case"value":i=(i+"").escapeHTML(!0);break;case"attr.checked":i=i?"checked":"";break;case"attr.selected":i=i?"selected":"";break;case"attr.disabled":i=i?"disabled":"";break;case"attr.readonly":i=i?"readonly":"";break;case"attr.target":i=i?'target="'+i+'"':"";break;case"style.color":i=i?"color:"+i+";":"";break;case"style.bgcolor":i=i?"background-color:"+i+";":""}n=n.split("{{"+r+"}}").join(i)}return n};ecount.widget.parseHTML=function(n,t){var l=n||this.data,a=ecount.control.template,f=t||this.template,r=f.match(/\(\((.*?)\)\)/g),e,u,s,i,h,c,o;if(r===null)return f;for(i=0,h=r.length;i<h;i++)u=a[r[i].replace(/\(\(|\)\)/g,"")],this.pcid&&r[i].toUpperCase().indexOf("FN")>-1&&(u=u.replace(new RegExp("{{cid}}","g"),'{{cid}}" data-pcid="'+this.pcid)),this._hideDateControl&&this.data[i].hidDate&&(u=u.replace(/^\(|\)$/g,"")),e=l[i],e&&(e.index=this.__index||i),this.findex!=undefined&&(e.findex=this.findex),s=u,c=ecount.widget.replaceAttr(s,e),o=f.split(r[i]),o.length>1&&(f=[o.shift(),o.join(r[i])].join(c));return f};ecount.widget.isVisible=function(n){if(n)return n.nodeType===3&&(n=n.parentNode),n.offsetWidth>0||n.offsetHeight>0||n.getAttribute("data-layouttype")=="grid"};ecount.widget.removeChild=function(n){n.parentNode&&n.parentNode.removeChild(n);for(var t=n.firstChild;t;)n.removeChild(t),t=n.firstChild;n.parentNode&&n.parentNode.removeChild(n)};ecount.widget.control={};ecount.widget.control.template=/\(\((.*?)\)\)/gi;ecount.Class=function(){var t=arguments.length,r=arguments[0],n=arguments[t-1],i=typeof n.initialize=="function"?n.initialize:function(){r.prototype.initialize.apply(this,arguments)},u;return t>1?(u=[i,r].concat(Array.prototype.slice.call(arguments).slice(1,t-1),n),ecount.inherit.apply(null,u)):i.prototype=n,i};ecount.inherit=function(n,t){var u=function(){},r,f,i;for(u.prototype=t.prototype,n.prototype=new u,r=2,f=arguments.length;r<f;r++)i=arguments[r],typeof i=="function"&&(i=i.prototype),$.extend(n.prototype,i)};ecount.class("ecount.layout","ecount.widget",{_isShow:!0,ecIKey:null,_forcedDisplayPosition:null,isResponsiveHeight:!1,init:function(n){ecount.widget.prototype.init.apply(this,arguments);this._options=n;this._initLayoutId();this.setEcPath();this.setEcIKey()},_initLayoutId:function(){this.id||(this.id=ecount.common.uuid(this.__type,ecount.delimiter))},getEcPath:function(){return this.ecPath},setEcPath:function(){this.ecPath=ecount.widget.createEcPath(this.ecPageID,this.containerName,this.tabId,this.id,this.gridID,"",this.pcid)},getEcIKey:function(){return this.ecIKey},setEcIKey:function(){this.ecIKey=ecount.global.registerEcInstance(this)},render:function(){ecount.widget.prototype.render.apply(this,arguments);this.setEcIKeyInDOM();this.boundary&&this.setDropdownPosition()},setEcIKeyInDOM:function(){var n=this.getLayoutWrapper(),t=this.getEcIKey();n&&t&&(n[0].ecIKey=t)},getLayoutWrapper:function(){return this.$el},getLayerServiceKey:function(n){var i=ecount.layer.constValue,r=n.ecPath,t;switch(n.ecService){case i.FN:t="fn";break;case i.TABLE:t="table";break;case i.DROPDOWN:t=n.cindex;break;case i.SELECTBOX:t=n.ecRoleIndex||n.ecFunctionId;break;case i.SPECTRUM:t="spectrum";break;case i.AUTOCOMPLETE:t=n.cindex}return ecount.common.makeServiceKey(r,t)},destroy:function(){if(this.ecIKey&&!this.serviceKey&&ecount.global.removeEcInstance(this.ecIKey,this.containerName||this.__type),this.itemList){for(var n=this.itemList.length;n-->0;)this.itemList[n].destroy&&this.itemList[n].destroy(),this.itemList[n]=null,delete this.itemList[n];this.itemList.length=null;delete this.itemList;this.controls&&(this.controls.length=null,delete this.controls)}this.events&&this.events.destroy();this.containerDelegator&&this.containerDelegator.destroy();this.$el&&this.$el.length>0&&(ecount.widget.removeChild(this.$el[0]),this.$el=null,delete this.$el)},transferEvent:function(n){this.delegator&&this.delegator.triggerEvent(n.type,n)},getAutoTransferEvent:function(n,t){var f=new ecount.events(n),r,i,u;if(n=n?n:this,t=_.isPlainObject(t)?t:{},t.scope=n,n.delegator&&n.delegator.listeners)for(r=Object.keys(n.delegator.listeners),i=0;i<r.length;i++)u=r[i],t[u]||(t[u]=this.transferEvent);f.on(t);return f},activate:function(){this.show()},deactivate:function(){this.hide()},show:function(){this.$el.show();this._isShow=!0},_show:function(){this.detachDropdown();this.$el.addClass("show");this.pnode&&this.pnode.addClass("open");this.setDropdownPosition();this.dropdownHideBindEvent();this._isShow=!0},hide:function(n){this.$el&&(!!n&&_.isBoolean(n.force)&&n.force===!0?this.$el.attr("style","display: none !important"):this.$el.hide());this._isShow=!1},_hide:function(){this.$el.removeClass("show");this.pnode&&this.pnode.removeClass("open");this.appendDropdown();this.dropdownHideUnBindEvent();this._isShow=!1},update:function(){},detachDropdown:function(){var t=this.pnode,i=this,n;t.find(this.$el).detach();this.clickHandler&&typeof this.clickHandler=="function"&&this.$el.find("a[data-trigger=click]").bind("mousedown",function(n){if(n&&n.which!=1)return!1;ecount.global.setTimeout(this.ecPageID,function(){i.clickHandler(n)})}.bind(this));this.removeItem&&typeof this.removeItem=="function"&&this.$el.find("a > span.close").bind("mousedown",function(n){this.removeItem(n.currentTarget.getAttribute("list-id"));n.preventDefault();n.stopPropagation()}.bind(this));n=this.dropdownTarget=="container"?this.eventContainer:$(document.body);n.append(this.$el)},appendDropdown:function(){var n=this.pnode;$(document.body).find(this.$el);this.clickHandler&&typeof this.clickHandler=="function"&&this.$el.find("a[data-trigger=click]").unbind("mousedown");this.removeItem&&typeof this.removeItem=="function"&&this.$el.find("a > span.close").unbind("mousedown");n.append(this.$el)},setPopover:function(n,t){var u=n,f=this.popupLevel||t.popupContext?$("div[data-ecpageid="+this.ecPageID+"]").closest("div.ui-dialog"):"body",i=(t.content||"").cr2br(),e=t.placement?t.placement:"auto",r;$.isEmpty(i)||(delete t.content,r=_.merge({type:this.popoverType,content:i,placement:e,container:f,html:!0,animation:!1,trigger:"manual",followMouse:!0,directShow:!0},t||{}),ecount.popover.create(u,r))},destroyPopover:function(n){var t=n;ecount.popover.destroy(t)},setDropdownPosition:function(){var t={},i=this.$el.outerWidth(),r=this.$el.outerHeight(),o=this.boundary.offset||{},n=2-ecount.common.getZoomRatio(),u=this.boundary.bottom*n+r*n>$(window).height(),f=this.isResponsiveHeight?!1:u,e=this.boundary.left+i*n>$(window).width();if(this._options.zIndex!=undefined&&(t["z-index"]=this._options.zIndex),this.isOwnFixedPosition)return!1;this.isSetDropdownSize;t.left=e||this.directionX=="right"?(this.boundary.right-i*n)/n:this.boundary.left;t.top=f||this._forcedDisplayPosition=="top"?(this.boundary.top-r+2)*n/n:this.boundary.bottom;this.isResponsiveHeight&&u&&(t.height="auto",t.bottom="5px");this.$el.css(t);return;var n,i},dropdownHideBindEvent:function(){var n=this.pcid||this._tabId||"";this.$pageContainer&&this.$pageContainer.bind("scroll.ecDropdown"+n,function(n){this.hide(n)}.bind(this));this.$tabPane&&this.$tabPane.bind("scroll.ecDropdown"+n,function(n){this.hide(n)}.bind(this));ecount.runtime.observe(this.ecPageID,"resize",this.hide.bind(this))},dropdownHideUnBindEvent:function(){var n=this.pcid||this._tabId||"";this.$pageContainer&&this.$pageContainer.unbind("scroll.ecDropdown"+n);this.$tabPane&&this.$tabPane.unbind("scroll.ecDropdown"+n);ecount.runtime.stopObserving(this.ecPageID,"resize")},isShow:function(){return!this.hidden&&this._isShow},toggleIf:function(n){this._isShow===n&&(this._isShow?this.hide():this.show())},toggle:function(n){typeof n=="number"?this.$el.slideToggle(n):this.$el.toggle()},height:function(){return this.$el.parent().height()},getHeight:function(){return this.$el.height()},getWidth:function(){return this.$el.width()},size:function(){return this.itemList.length},traverse:function(n){for(var u=[this.itemList],i,r,f,t;i=u.pop();)for(r=i.length?i.length:0;r--;)t=i[r],t&&(f=n(t),f!==!1&&t.itemList&&t.itemList.length>0&&u.push(t.itemList))},find:function(n,t){var i=[];return this.traverse(function(r){return n(r)&&i.push(r),_.isFunction(t)==!1||t(r)!=!0}),i},hasFocus:function(){return this.$el&&this.$el.find(document.activeElement).length},bindScrollEvent:function(n,t){ecount.runtime.observe("scroll.page.eventContainer",n,t)},getControl:function(n,t,i,r){var f,e,u;return r=r||{},t instanceof Object?(f=t[0].parentTabId,t.length>1&&(e=t[1].childTabId),u=this.find(function(t){return t&&t.__type==widget.generator.CONTROL&&(!t.pId||[f,e].contains(t.pId))&&(!i||t.__pnode==i)&&(!n||t.id==n)})):(t!==!1&&(f=t||(this.currentTabId=="__ecAddNewTab"?"newTab":this.currentTabId)),u=this.find(function(t){return t&&t.__type==widget.generator.CONTROL&&t.__will_destroy!==!0&&(!t.pId||!f||t.pId==f)&&(!i||t.__pnode==i)&&(!n||t.id==n)})),u&&(u.length&&u.length>1&&(u=u.filter(function(n){return!n.pcid&&(r.gridID?n.gridID==r.gridID:!n.gridID)})),u.reverse()),u?u[0]:null},getItemById:function(n,t,i){var u,f,r;return t instanceof Object?(u=t[0].parentTabId,t.length>1&&(f=t[1].childTabId),r=this.find(function(t){return t&&(!t.pId||[u,f].contains(t.pId))&&(!i||t.__pnode==i)&&(!n||t.id==n)})):(t!==!1&&(u=t||this.currentTabId),r=this.find(function(t){return t&&(!t.pId||!u||t.pId==u)&&(!i||t.__pnode==i)&&(!n||t.id==n)})),r&&(r.length&&r.length>1&&(r=r.filter(function(n){return!n.pcid})),r.reverse()),r?r[0]:null},getTabsById:function(n){var r,t=this.find(function(n){return n.__type==widget.generator.TABCONTENTS}),i;if(t&&t.length>0)for(i=0;i<t.length;i++)if(r=t[i],r.tabs.id==n)return r.tabs;return null},getTabsAll:function(){var r,i,n=this.find(function(n){return n.__type==widget.generator.TABCONTENTS}),t;if(n&&n.length>0)for(t=0;t<n.length;t++)r=n[t],i=n[t].tabs;return i},getBoardListView:function(n){return this.find(function(t){return t.__type==widget.generator.BOARDLISTVIEW&&(!n||t.id==n)})},getSafeControl:function(n){return this.currentTabId.indexOf("custom")>-1||this.currentTabId=="newTab"?this.getControl(n)||this.getControl(n,"all"):this.getControl(n,"all")},getControlByName:function(n,t,i){var r,f,u;return t instanceof Object?(r=t[0].parentTabId,f=t[1].childTabId,u=this.find(function(t){return t&&t.__type==widget.generator.CONTROL&&(!t.pId||!r||t.pId==r||!t.pId||!f||t.pId==f)&&(!i||t.__pnode==i)&&(!n||t.name==n)})):(r=t||this.currentTabId,u=this.find(function(t){return t&&t.__type==widget.generator.CONTROL&&(!t.pId||!r||t.pId==r)&&(!i||t.__pnode==i)&&(!n||t.name==n)})),u&&u.reverse(),u?u[0]:null},onLoadItems:function(n){n||(n={target:this.containerName,type:this.__type,__self:this});this.containerDelegator?this.containerDelegator.triggerEvent("item.onload",n):this.delegator&&this.delegator.triggerEvent("item.onload",n)},hasHorizontalScrollbar:function(){try{return this.$el[0].scrollWidth>this.$el[0].clientWidth}catch(n){return!1}},hasVertivalScrollbar:function(){try{return this.$el[0].scrollHeight>this.$el[0].clientHeight}catch(n){return!1}},_onBeforeEventExecute:function(n,t,i,r){var u="_ON_BEFORE_"+n.handler.toUpperCase().split(".").shift();ec$.safeCall(this,u,n,t,i,r)},_ON_BEFORE_CHANGE:function(){return!0},_ON_CHANGE:function(n,t,i,r){return this._onBeforeEventExecute(n,t,i,r)===!1?!1:this.ON_CHANGE(n,t,i,r)===!1?!1:void 0},ON_CHANGE:function(){},_ON_BEFORE_CLICK:function(){return!0},_ON_CLICK:function(n,t,i,r){return this._onBeforeEventExecute(n,t,i,r)===!1?!1:this.ON_CLICK(n,t,i,r)===!1?!1:void 0},ON_CLICK:function(){},_ON_SCROLL:function(n){if(this.ON_SCROLL(n)===!1)return!1},ON_SCROLL:function(){},_ON_COPY:function(n,t,i,r){return this._onBeforeEventExecute(n,t,i,r)===!1?!1:this.ON_COPY(n,t,i,r)===!1?!1:void 0},ON_COPY:function(){},_ON_CUT:function(n,t,i,r){return this._onBeforeEventExecute(n,t,i,r)===!1?!1:this.ON_CUT(n,t,i,r)===!1?!1:void 0},ON_CUT:function(){},_ON_PASTE:function(n,t,i,r){return this._onBeforeEventExecute(n,t,i,r)===!1?!1:this.ON_PASTE(n,t,i,r)===!1?!1:void 0},ON_PASTE:function(){},_ON_BEFORE_CONTEXTMENU:function(){return!0},_ON_CONTEXTMENU:function(n,t,i,r){return this._onBeforeEventExecute(n,t,i,r)===!1?!1:this.ON_CONTEXTMENU(n,t,i,r)===!1?!1:void 0},ON_CONTEXTMENU:function(){},_ON_BEFORE_MOUSEOVER:function(){return!0},_ON_MOUSEOVER:function(n,t,i,r){return this._onBeforeEventExecute(n,t,i,r)===!1?!1:this.ON_MOUSEOVER(n,t,i,r)===!1?!1:void 0},ON_MOUSEOVER:function(){},_ON_BEFORE_MOUSEOUT:function(){return!0},_ON_MOUSEOUT:function(n,t,i,r){return this._onBeforeEventExecute(n,t,i,r)===!1?!1:this.ON_MOUSEOUT(n,t,i,r)===!1?!1:void 0},ON_MOUSEOUT:function(){},_ON_BEFORE_MOUSEDOWN:function(){return!0},_ON_MOUSEDOWN:function(n,t,i,r){return this._onBeforeEventExecute(n,t,i,r)===!1?!1:this.ON_MOUSEDOWN(n,t,i,r)===!1?!1:void 0},ON_MOUSEDOWN:function(){},_ON_BEFORE_INPUT:function(){return!0},_ON_INPUT:function(n,t,i,r){return this._onBeforeEventExecute(n,t,i,r)===!1?!1:this.ON_INPUT(n,t,i,r)===!1?!1:void 0},ON_INPUT:function(){},_ON_BEFORE_FOCUSIN:function(){return!0},_ON_FOCUSIN:function(n,t,i,r){return this._onBeforeEventExecute(n,t,i,r)===!1?!1:this.ON_FOCUSIN(n,t,i,r)===!1?!1:void 0},ON_FOCUSIN:function(){},_ON_BEFORE_FOCUSOUT:function(){return!0},_ON_FOCUSOUT:function(n,t,i,r){return this._onBeforeEventExecute(n,t,i,r)===!1?!1:this.ON_FOCUSOUT(n,t,i,r)===!1?!1:void 0},ON_FOCUSOUT:function(){},_ON_BEFORE_KEYPRESS_OTHERS:function(){return!0},_ON_KEYPRESS_OTHERS:function(n,t,i,r){return this._onBeforeEventExecute(n,t,i,r)===!1?!1:this.ON_KEYPRESS_OTHERS(n,t,i,r)===!1?!1:void 0},ON_KEYPRESS_OTHERS:function(){},_ON_BEFORE_KEYDOWN:function(){return!0},_ON_KEYDOWN:function(n,t,i,r){return this._onBeforeEventExecute(n,t,i,r)===!1?!1:this["_ON_"+n.keyEventHandlerName]&&this["_ON_"+n.keyEventHandlerName](n,t,i,r)===!1?!1:void 0},_ON_KEYDOWN_SERVICE:function(n,t,i,r){if(this["_ON_"+n.keyEventHandlerName+"_SERVICE"]&&this["_ON_"+n.keyEventHandlerName+"_SERVICE"](n,t,i,r)===!1)return!1},ON_KEYDOWN:function(){},_ON_BEFORE_KEYUP:function(){return!0},_ON_KEYUP:function(n,t,i,r){return this._onBeforeEventExecute(n,t,i,r)===!1?!1:this["_ON_"+n.keyEventHandlerName]&&this["_ON_"+n.keyEventHandlerName](n,t,i,r)===!1?!1:void 0},_ON_KEYUP_SERVICE:function(n,t,i,r){if(this["_ON_"+n.keyEventHandlerName+"_SERVICE"]&&this["_ON_"+n.keyEventHandlerName+"_SERVICE"](n,t,i,r)===!1)return!1},ON_KEYUP:function(){},_ON_KEYPRESS:function(n,t,i,r){if(this["_ON_"+n.keyEventHandlerName]&&this["_ON_"+n.keyEventHandlerName](n,t,i,r)===!1)return!1},_ON_KEYPRESS_SERVICE:function(n,t,i,r){if(this["_ON_"+n.keyEventHandlerName+"_SERVICE"]&&this["_ON_"+n.keyEventHandlerName+"_SERVICE"](n,t,i,r)===!1)return!1},_ON_BEFORE_DBLCLICK:function(){return!0},_ON_DBLCLICK:function(n,t,i,r){return this._onBeforeEventExecute(n,t,i,r)===!1?!1:this.ON_DBLCLICK(n,t,i,r)===!1?!1:void 0},ON_DBLCLICK:function(){},_ON_KEYDOWN_ESC:function(){if(this.ON_KEYDOWN_ESC.apply(this,arguments)===!1)return!1},ON_KEYDOWN_ESC:function(){},_ON_KEYDOWN_ARROW_UP:function(){if(this.ON_KEYDOWN_ARROW_UP.apply(this,arguments)===!1)return!1},ON_KEYDOWN_ARROW_UP:function(){},_ON_KEYDOWN_ARROW_DOWN:function(){if(this.ON_KEYDOWN_ARROW_DOWN.apply(this,arguments)===!1)return!1},ON_KEYDOWN_ARROW_DOWN:function(){},_ON_KEYDOWN_ARROW_RIGHT_SERVICE:function(){if(this.ON_KEYDOWN_ARROW_RIGHT_SERVICE.apply(this,arguments)===!1)return!1},ON_KEYDOWN_ARROW_RIGHT_SERVICE:function(){},_ON_KEYDOWN_ARROW_LEFT_SERVICE:function(){if(this.ON_KEYDOWN_ARROW_LEFT_SERVICE.apply(this,arguments)===!1)return!1},ON_KEYDOWN_ARROW_LEFT_SERVICE:function(){},_ON_KEYDOWN_UTILITY:function(){if(this.ON_KEYDOWN_UTILITY.apply(this,arguments)===!1)return!1},ON_KEYDOWN_UTILITY:function(){},_ON_KEYDOWN_TAB:function(){if(this.ON_KEYDOWN_TAB.apply(this,arguments)===!1)return!1},ON_KEYDOWN_TAB:function(){},_ON_KEYDOWN_ENTER:function(){if(this.ON_KEYDOWN_ENTER.apply(this,arguments)===!1)return!1},ON_KEYDOWN_ENTER:function(){},_ON_KEYDOWN_SPACE_SERVICE:function(){if(this.ON_KEYDOWN_SPACE_SERVICE.apply(this,arguments)===!1)return!1},ON_KEYDOWN_SPACE_SERVICE:function(){},_ON_KEYDOWN_F1:function(){if(this.ON_KEYDOWN_F1.apply(this,arguments)===!1)return!1},ON_KEYDOWN_F1:function(){},_ON_KEYDOWN_F2:function(){if(this.ON_KEYDOWN_F2.apply(this,arguments)===!1)return!1},ON_KEYDOWN_F2:function(){},_ON_KEYDOWN_F3:function(){if(this.ON_KEYDOWN_F3.apply(this,arguments)===!1)return!1},ON_KEYDOWN_F3:function(){},_ON_KEYDOWN_F4:function(){if(this.ON_KEYDOWN_F4.apply(this,arguments)===!1)return!1},ON_KEYDOWN_F4:function(){},_ON_KEYDOWN_F5:function(){if(this.ON_KEYDOWN_F5.apply(this,arguments)===!1)return!1},ON_KEYDOWN_F5:function(){},_ON_KEYDOWN_F6:function(){if(this.ON_KEYDOWN_F6.apply(this,arguments)===!1)return!1},ON_KEYDOWN_F6:function(){},_ON_KEYDOWN_F7:function(){if(this.ON_KEYDOWN_F7.apply(this,arguments)===!1)return!1},ON_KEYDOWN_F7:function(){},_ON_KEYDOWN_F8:function(){if(this.ON_KEYDOWN_F8.apply(this,arguments)===!1)return!1},ON_KEYDOWN_F8:function(){},_ON_KEYDOWN_F9:function(){if(this.ON_KEYDOWN_F9.apply(this,arguments)===!1)return!1},ON_KEYDOWN_F9:function(){},_ON_KEYDOWN_F10:function(){if(this.ON_KEYDOWN_F10.apply(this,arguments)===!1)return!1},ON_KEYDOWN_F10:function(){},_ON_KEYDOWN_F11:function(){if(this.ON_KEYDOWN_F11.apply(this,arguments)===!1)return!1},ON_KEYDOWN_F11:function(){},_ON_KEYDOWN_F12:function(){if(this.ON_KEYDOWN_F12.apply(this,arguments)===!1)return!1},ON_KEYDOWN_F12:function(){},_ON_KEYDOWN_OTHERS:function(){if(this.ON_KEYDOWN_OTHERS.apply(this,arguments)===!1)return!1},ON_KEYDOWN_OTHERS:function(){},_ON_CLICK_SERVICE:function(){if(this.ON_CLICK_SERVICE.apply(this,arguments)===!1)return!1},ON_CLICK_SERVICE:function(){return!0},_ON_MOUSEOVER_SERVICE:function(){if(this.ON_MOUSEOVER_SERVICE.apply(this,arguments)===!1)return!1},ON_MOUSEOVER_SERVICE:function(){return!0},_ON_MOUSEOUT_SERVICE:function(){if(this.ON_MOUSEOUT_SERVICE.apply(this,arguments)===!1)return!1},ON_MOUSEOUT_SERVICE:function(){return!0},_ON_MOUSEDOWN_SERVICE:function(){if(this.ON_MOUSEDOWN_SERVICE.apply(this,arguments)===!1)return!1},ON_MOUSEDOWN_SERVICE:function(){return!0},_ON_FOCUSIN_SERVICE:function(){if(this.ON_FOCUSIN_SERVICE.apply(this,arguments)===!1)return!1},ON_FOCUSIN_SERVICE:function(){return!0},_ON_FOCUSOUT_SERVICE:function(){if(this.ON_FOCUSOUT_SERVICE.apply(this,arguments)===!1)return!1},ON_FOCUSOUT_SERVICE:function(){return!0},_ON_INPUT_SERVICE:function(){if(this.ON_INPUT_SERVICE.apply(this,arguments)===!1)return!1},ON_INPUT_SERVICE:function(){return!0},_ON_KEYDOWN_ESC_SERVICE:function(){if(this.ON_KEYDOWN_ESC_SERVICE.apply(this,arguments)===!1)return!1},ON_KEYDOWN_ESC_SERVICE:function(){return!0},_ON_KEYDOWN_ARROW_UP_SERVICE:function(){if(this.ON_KEYDOWN_ARROW_UP_SERVICE.apply(this,arguments)===!1)return!1},ON_KEYDOWN_ARROW_UP_SERVICE:function(){return!0},_ON_KEYDOWN_ARROW_DOWN_SERVICE:function(){if(this.ON_KEYDOWN_ARROW_DOWN_SERVICE.apply(this,arguments)===!1)return!1},ON_KEYDOWN_ARROW_DOWN_SERVICE:function(){return!0},_ON_KEYDOWN_ENTER_SERVICE:function(){if(this.ON_KEYDOWN_ENTER_SERVICE.apply(this,arguments)===!1)return!1},ON_KEYDOWN_ENTER_SERVICE:function(){return!0},_ON_KEYDOWN_TAB_SERVICE:function(){if(this.ON_KEYDOWN_TAB_SERVICE.apply(this,arguments)===!1)return!1},ON_KEYDOWN_TAB_SERVICE:function(){return!0},_ON_KEYDOWN_UTILITY_SERVICE:function(){if(this.ON_KEYDOWN_UTILITY_SERVICE.apply(this,arguments)===!1)return!1},ON_KEYDOWN_UTILITY_SERVICE:function(){return!0},_ON_KEYDOWN_OTHERS_SERVICE:function(){if(this.ON_KEYDOWN_OTHERS_SERVICE.apply(this,arguments)===!1)return!1},ON_KEYDOWN_OTHERS_SERVICE:function(){return!0},_ON_KEYDOWN_F7_SERVICE:function(){if(this.ON_KEYDOWN_F7_SERVICE.apply(this,arguments)===!1)return!1},ON_KEYDOWN_F7_SERVICE:function(){return!0},_ON_KEYDOWN_F8_SERVICE:function(){if(this.ON_KEYDOWN_F8_SERVICE.apply(this,arguments)===!1)return!1},ON_KEYDOWN_F8_SERVICE:function(){return!0},_ON_KEYPRESS_OTHERS_SERVICE:function(){if(this.ON_KEYPRESS_OTHERS_SERVICE.apply(this,arguments)===!1)return!1},ON_KEYPRESS_OTHERS_SERVICE:function(){return!0}});ecount.layout.getFormData=function(n,t,i,r){var f,u=ecount.global.findViewBag(i);return u.CacheInfo&&(f=ecount.formset.getXFormViewModelSync(i,{companyType:u.DefaultOption.companyType,formType:n,formSeq:u.DefaultOption.formSeq,tabCd:r})),f||u&&u.FormInfos&&(f=u.FormInfos[n]),f};ecount.layout.TEMP_NEW_TAB_ID="__ecAddNewTab";ecount.layout.NEW_TAB_ID="newTab";ecount.layout.EXPAND_TAB_ID="__ecExpandTab";ecount.layout.template={formRowGrouping:'<tr id="row-{{id}}"><th>{{subTitle}}&nbsp;<div class="pull-right"><a href="javascript:;" data-show="{{groupId}}"><span class="fa fa-caret-down"><\/span><\/a><\/div><\/th><td colspan="{{colSize}}"><\/td><\/tr>',formRowGroupingSingle:'<tr id="row-{{id}}"><th>{{subTitle}}&nbsp;<div class="pull-right"><a href="javascript:;" data-show="{{groupId}}"><span class="fa fa-caret-down"><\/span><\/a><\/div><\/th><td><\/td><\/tr>',formRowDualGrouping:'<tr id="row-{{id}}"><th>{{subTitle}}&nbsp;<div class="pull-right"><div class="btn-group link-group" dual-arrow><a href="javascript:;" dual-show="{{groupId}}"><span class="fa fa-caret-right"><\/span><\/a><\/div><a href="javascript:;" data-show="{{groupId}}"><span class="fa fa-caret-down"><\/span><\/a><\/div><\/th><td colspan="{{colSize}}"><\/td><\/tr>',formRowDualGroupingSingle:'<tr id="row-{{id}}"><th>{{subTitle}}&nbsp;<div class="pull-right"><div class="btn-group link-group" dual-arrow><a href="javascript:;" dual-show="{{groupId}}"><span class="fa fa-caret-right"><\/span><\/a><\/div><a href="javascript:;" data-show="{{groupId}}"><span class="fa fa-caret-down"><\/span><\/a><\/div><\/th><td><\/td><\/tr>',"form-base":"<table class=\"table table-responsive table-form {{css}}\" data-service='{{serviceAttr}}' {{style}}><tbody><\/tbody><\/table>","form-board":'<table class="table table-form  table-border-no-a table-th-left {{css}}" {{style}}><tbody><\/tbody><\/table>',"form-register-1":'<table class="table table-border-no-a table-th-left table-basic-register table-responsive table-form {{css}}" {{style}}><colgroup><col  style="{{label_width}}"><\/col><col  {{input_width}}><\/col><\/colgroup><tbody ><\/tbody><\/table>',"form-list-1":'<table class="table table-border-no-a table-th-left table-responsive table-form {{css}}" {{style}}><colgroup><col  style="{{label_width}}"><\/col><col  {{input_width}}><\/col><\/colgroup><tbody ><\/tbody><\/table>',"form-input-1":'<table class="table table-border-no-a table-th-left table-easy-entry table-responsive table-form {{css}}" {{style}}><tbody ><\/tbody><\/table>',"form-input-2":'<table class="table table-border-no-a table-th-left table-inv-top table-responsive table-form {{css}}" {{style}}><tbody ><\/tbody><\/table>',"form-input-3":'<table class="table table-border-no-a table-responsive table-form {{css}}" {{style}}><tbody ><\/tbody><\/table>',"form-vertical-1":'<table class="table table-border-no-a table-layout-auto table-responsive table-form {{css}}" {{style}}><thead><\/thead><tbody ><\/tbody><\/table>',"form-customer":'<table class="table table-border-no-a table-th-left table-form table-customer-support-form {{css}}" {{style}}><tbody><\/tbody><\/table>',"form-table":'<table class="table table-bordered table-th-left table-responsive table-listform {{css}}" {{style}}><colgroup>{{colgroup}}<\/colgroup>{{thead}}<tbody ><\/tbody><\/table>',"form-setup":'<table class="table table-hover table-th-left table-layout-auto table-border-no-a table-function-setup table-data-manage {{css}}" {{style}}><colgroup>{{colgroup}}<\/colgroup><tbody><\/tbody><\/table>'};ecount.class("ecount.layout.layer","ecount.layout",{stopRemove:!1,isShow:function(){return this._isShow&&this.$el&&ecount.widget.isVisible(this.$el.get(0))},cancelShow:function(n){this._isCancelShow=n},setStopRemove:function(n){this.stopRemove=!!n}});ecount.class("ecount.layout.container","ecount.layout",{_loadedItemCount:0,init:function(){ecount.layout.prototype.init.apply(this,arguments);this.events=new ecount.events(this);this.events.on({"item.onload":this.onLoadItems,"tabContents.onload":this.onLoadTabContents,scope:this});this.ecIKey=ecount.global.registerEcInstance(this)},render:function(){ecount.layout.prototype.render.apply(this,arguments)},onLoadTabContents:function(n){this.delegator&&this.delegator.triggerEvent("tabContents.onload",n)},onLoadItems:function(n){var u=this.getItemCount(),t,i,f,r;if(this._loadedItemCount++,this._addGridCount==this._loadedItemCount&&n.__self&&n.__self._addGrid){if(t=n.isDynamic?[this.getGrid(n.gridId,n.tabId)]:this.getGrid(!1,!1),t.length>0)for(i=0,f=t.length;i<f;i++)r=t[i],r._hasRowData&&(r.getSettings().setCommonIsLazyInitializeOnLoad(!1),r.grid.render());this._addGridCount=0;return}(u===0||this._loadedItemCount==u)&&this.delegator&&this.delegator.triggerEvent("container.onload",{target:this.__type,self:this})},createItems:function(n,t){var i,r,u,f;if(n&&n.length!==0)for(u=0,f=n.length;u<f;u++)i=n[u],i.itemIndex=u,i.delegator=this.delegator,i.containerDelegator=this.events,i.ecPageID=this.ecPageID,i.inIncludePage=this.inIncludePage,i.__type===widget.generator.CONTROL?(r=ecount.common.createNamespace(i.controlType),this.initializer&&ecount.control.initializeByUserSetting(this.initializer,i),r=new r(i)):(i.__type===widget.generator.TABPANE?i.colSize=this.colSize:i.__type===widget.generator.TABCONTENTS&&(this.onSingleMode=i.onSingleMode),i.hasScroll===!0&&(i.scrollContainer=t),i.popupID=this.popupID,i.popupLevel=this.popupLevel,i.eventContainer=this.eventContainer,r=new ecount.layout[i.__type](i)),this.itemList.push(r),this.cItemRender(r,t||this.$el),r=null;else this.onLoadItems()},cItemRender:function(n,t){n.render(t)},getItemCount:function(){return this.items.length},getItem:function(n,t){var i=this.find(function(t){return t.__type==n});return i?i[t||0]:null},getStepProgress:function(){var n=this.find(function(n){return n.__type==widget.generator.STEPPROGRESS});return n.length>0?n[0]:null},getTree:function(n){var t;return t=$.isString(n)?this.find(function(t){return t.__type==widget.generator.TREE&&t.tid==n}):this.find(function(n){return n.__type==widget.generator.TREE}),t&&t.length>0?$.isNumber(n)&&n!=0?t[n]:t[0]:null},getValidateTarget:function(n){n=n===!0?!1:n||this.currentTabId;var t=this.find(function(t){return(t.__type==widget.generator.FORM||t.__type==widget.generator.SECTIONUNION)&&(!n||t.tabId==n)});return t&&t.reverse(),t},getForm:function(n){n=n===!0?!1:n||this.currentTabId;var t=this.find(function(t){return t.__type==widget.generator.FORM&&(!n||t.tabId==n)});return t&&t.reverse(),t},getMaxFormColsize:function(){var n=1;return this.traverse(function t(i){if(i.__type==widget.generator.TABCONTENTS)return i.tabItems&&Object.keys(i.tabItems).forEach(function(n){i.tabItems[n].forEach(t)}),!0;i.__type==widget.generator.FORM&&i.colSize>n&&(n=i.colSize)}),n},getFormById:function(n){var t=this.find(function(t){return t.__type==widget.generator.FORM&&t.id==n});return t.length>0?t[0]:null},getWidgetTree:function(n){n=n===!0?!1:n||this.currentTabId;var t=this.find(function(t){return t.__type==widget.generator.WIDGETTREE&&(!n||t.tabId==n)});return t&&t.reverse(),t},getOrgChart:function(){var n=this.find(function(n){return n.__type==widget.generator.ORGCHART});if(n)return n[0]},getSettingPanel:function(n){var t,i;return typeof n=="string"?t=n:n=n||0,i=this.find(function(n){return n.__type==widget.generator.SETTINGPANEL&&(!t||t==n.id)}),i.length>0?t?i[0]:i.reverse()[n]:null},getPageByKey:function(n,t,i){t=arguments.length===1||t===!0?!1:t||this.currentTabId;var r=this.find(function(i){return i.__type==widget.generator.PAGE&&i.includeParameter&&i.includeParameter.pageKey==n&&(!t||i.tabId==t)});return r.length>0?i?r[0]:r[0].instance:null},getPage:function(n,t,i){t=arguments.length===1||t===!0?!1:t||this.currentTabId;var r=this.find(function(i){return i.__type==widget.generator.PAGE&&i.pageID==n&&(!t||i.tabId==t)});return r.length>0?i?r[0]:r[0].instance:null},getEp:function(){var n=this.find(function(n){return n.__type==widget.generator.EP});return n.length>0?n[0]:null},getPanelTree:function(n){var t=this.find(function(n){return n.__type==widget.generator.PANELTREE});return t&&t.length>0?$.isNumber(n)?t[n]:t:null},getPanelGroup:function(){var n=this.find(function(n){return n.__type==widget.generator.PANELGROUP});return n.length>0?n[0]:null},getPanel:function(n){var t;return typeof n=="string"?(t=this.find(function(t){return t.__type==widget.generator.PANEL&&t.id==n}),t&&t.length==1?t[0]:null):(t=this.find(function(n){return n.__type==widget.generator.PANEL}),t.length>0&&t[n]?t[n]:null)},getPanelModal:function(n){var t=this.find(function(t){return t.__type==widget.generator.PANELMODAL&&(!n||t.id==n)});return t.length>0?t[0]:null},getExplainDiv:function(n){var t=this.find(function(t){return t.__type==widget.generator.EXPLAINDIV&&(!n||t.id==n)});return t.length>0?t[0]:null},getCalendar:function(){var n=this.find(function(n){return n.__type==widget.generator.CALENDAR});return n.length>0?n[0]:null},getScheduler:function(){var n=this.find(function(n){return n.__type==widget.generator.SCHEDULER});return n.length>0?n[0]:null},getSubTitle:function(n){return this.find(function(t){return t.__type==widget.generator.SUBTITLE&&(!n||t.id==n)})},setDebugLabel:function(n){var t=$('<span style="color:red">'+n+"<\/span>");this.$el.append(t)},setRenderCompleteElement:function(n){var t=n?n:"page-render-complete",i=$("<div id='"+t+'\' style="display: none"><\/div>');this.$el.find("#"+t).length>0||this.$el.append(i)},removeRenderCompleteElement:function(n){var t=n?n:"page-render-complete";this.$el.find("#"+t).remove()},repackageResult:function(n,t,i,r){var s,e,o,u,h,f;if(n.reverse(),s=i?function(n){var t=[];return n.forEach(function(n){t=t.concat(n)}),t}:function(n){var t={};return n.forEach(function(n){$.extend(t,n)}),t},e=this.getForm(t).length+this.getSectionUnion().length,e>1&&r)for(o=1;o<e;o++)if(u=n.splice(1,1),u[0]&&u[0].length>0)for(h=u[0].length,f=h-1;f>=0;f--)n[0].unshift(u[0][f]);return{result:n.length===1?n[0]:n,tabId:t||this.currentTabId,merge:function(){return s(n)}}},toggle:function(n){return this._invoke.call(this,function(t){return t.toggle(n)})},validate:function(n,t,i){var u=this.getValidateTarget(n),r;return u?(r=[],u.forEach(function(n){r.push(n.validate.call(n,t,i))}),this.repackageResult(r,n,!0,!0)):null},validateAll:function(){var n=this.getValidateTarget(!0),t={};return n&&n.forEach(function(n){t[n.tabId]=n.validate.call(n)}),{result:t}},serialize:function(n,t){var r=this.getForm(n),i;return r?(i=[],r.forEach(function(n){i.push(ecount.widget.serialize(n.itemList,t))}),this.repackageResult(i,n,n)):null},serializeWrap:function(n,t){var r=this.getForm(n),i;return r?(i=[],r.forEach(function(n){i.push(ecount.widget.serializeWrap(n.itemList,t))}),this.repackageResult(i,n,n)):null},serializeAdditionalData:function(n,t){var r=this.getForm(n),i;return r?(i=[],r.forEach(function(n){i.push(ecount.widget.serializeAdditionalData(n.itemList,t))}),this.repackageResult(i,n,n)):null},getFormSetGroupList:function(n,t){var u=[],r,i;for($.isNull(t)&&(t=0),r=this.itemList[t],i=0;i<r.itemList.length;i++)r.itemList[i]._FormGroupID==n&&u.push(r.itemList[i]);return u},extract:function(n){var i=this.getForm(n),t;return i?(t=[],i.forEach(function(n){t.push(ecount.widget.extract(n.itemList))}),this.repackageResult(t,n)):null},clone:function(n){var i=this.getForm(n),t;return i?(t=[],i.forEach(function(n){t.push(ecount.widget.clone(n.itemList))}),this.repackageResult(t,n)):null},serializeById:function(n){return this.serialize(n,!0)},save:function(n,t,i,r){var u=[],f=this.getForm(n);return f&&f.forEach(function(n){u.push({t:n.tabId,v:n.save(i,r),i:n.itemIndex})}),t?u:Object.toJSON(u)},restore:function(n,t,i){for(var r,u,n=t?n:JSON.parse(n),f=0,e=n.length;f<e;f++)r=n[f],u=this.find(function(n){return n.__type==widget.generator.FORM&&(!r.t||n.tabId==r.t)&&(r.i==undefined||n.itemIndex==r.i)}),u.length>0&&u[0].restore(r.v,i);this.clearInvalidStatusOfTabContents(n)},clearInvalidStatusOfTabContents:function(n){var t=this.getItem(widget.generator.TABCONTENTS),i,r;for($.isArray(t)||(t=t?[t]:[]),i=0,r=t.length;i<r;i++)t&&t[i].clearInvalidStatus(n.t)},restorePreset:function(n,t,i){for(var r,u,n=t?n:JSON.parse(n),f=0,e=n.length;f<e;f++)r=n[f],u=this.find(function(n){return n.__type==widget.generator.FORM&&(!r.t||n.tabId==r.t)&&(r.i==undefined||n.itemIndex==r.i)}),u.length>0&&u[0].restorePresetData(r.v,i);this.clearInvalidStatusOfTabContents(n)},lastReset:function(n,t){var i=this.getForm(!0),r=this.getTabContents()?this.getTabContents().nonSyncTabs||[]:[];if(t&&r.contains(t)){i=this.getForm(t);i[0].reset(n);return}i&&i.forEach(function(t){r.contains(t.tabId)||t.reset(n)}.bind(this))},callChangeEvent:function(n){var t=this.getForm(n?n:!0);t&&t.forEach(function(n){n.callChangeEvent()}.bind(this))},reset:function(n){var t=this.getForm(n);t&&t.forEach(function(n){n.reset()})},getGrid:function(n,t){var i,r,u;return t!==!1&&(t=this.onSingleMode?this.activeTabId:t||this.currentTabId),t instanceof Object?(r=t[0].parentTabId,u=t[1].childTabId,i=this.find(function(t){return t&&t.__type==widget.generator.GRID&&(!t.tabId||!r||t.tabId==r||!t.tabId||!u||t.tabId==u)&&(!n||t.id===n)}),t=!1):i=this.find(function(i){return i&&i.__type==widget.generator.GRID&&(!n||i.id===n)&&(!t||i.tabId===t)}),n===!1&&t===!1?i:i?i[0]:null},getDataView:function(){var n=this.find(function(n){return n&&n.__type==widget.generator.DATAVIEW});if(n.length)return n[0]},toggleRow:function(n,t){var i=this.getForm(t);i&&i.forEach(function(t){t.toggleRow(n)})},showRow:function(n,t){var i=this.getForm(t);i&&i.forEach(function(t){t.showRow(n)})},hideRow:function(n,t){var i=this.getForm(t);i&&i.forEach(function(t){t.hideRow(n)})},showGroupRow:function(n,t){var i=this.getForm(t);i&&i.forEach(function(t){t.showGroupRow(n)})},hideGroupRow:function(n,t){var i=this.getForm(t);i&&i.forEach(function(t){t.hideGroupRow(n)})},showCell:function(n,t){var i=this.getForm(t);i&&i.forEach(function(t){t.showCell(n)})},hideCell:function(n,t){var i=this.getForm(t);i&&i.forEach(function(t){t.hideCell(n)})},setTitle:function(n,t,i,r,u){var f=this.getForm(i);f&&f.forEach(function(i){i.setTitle(n,t,r,u)})},enable:function(n,t){var i=this.getForm(t);i&&i.forEach(function(t){t.enable(n)})},disable:function(n,t){var i=this.getForm(t);i&&i.forEach(function(t){t.disable(n)})},hideTab:function(n){var t=this.find(function(n){return n.__type==widget.generator.TABCONTENTS});t&&t[0].hideTab(n)},showTab:function(n){var t=this.find(function(n){return n.__type==widget.generator.TABCONTENTS});t&&t[0].showTab(n)},changePreset:function(n,t){var i=this.find(function(n){return n.__type==widget.generator.TABCONTENTS});i&&i.length>0&&(this.currentPresetId=n,this.$el.scrollTop(0),this.$el.trigger("scroll"),i[0].changePreset(n,t))},getTabs:function(){var n=this.find(function(n){return n.__type==widget.generator.TABCONTENTS});if(n)return n[0].getTabs()},changeTab:function(n,t,i,r){var f=this.find(function(n){return n.__type==widget.generator.TABCONTENTS}),s,o,u,e;if(f&&f.length>0){for(this.currentTabId=n,u=0,e=f.length;u<e;u++)if(s=f[u].getTabPane(n),s){this.$el.scrollTop(0);this.$el.trigger("scroll");f[u].changeTab(n,t,r);break}if(s)for(o=this.getToolbar(null,!0),u=0,e=o.length;u<e;u++)o[u].redrawControl&&o[u].redrawControl()}},checkPreset:function(n){var t=this.find(function(n){return n.__type==widget.generator.TABCONTENTS});if(t)return t[0].checkPreset(n)},renameTab:function(n,t){var i=this.find(function(n){return n.__type==widget.generator.TABCONTENTS});i&&i[0].renameTab(n,t)},showErrorTab:function(n){var t=this.find(function(n){return n.__type==widget.generator.TABCONTENTS});t&&t[0].showErrorTab(n)},hideErrorTab:function(n){var t=this.find(function(n){return n.__type==widget.generator.TABCONTENTS});t&&t[0].hideErrorTab(n)},getInvalidItemCount:function(n){var t=this.find(function(n){return n.__type==widget.generator.TABCONTENTS});if(t)return t[0].getInvalidItemCount(n)},isVisible:function(){return ecount.widget.isVisible(this.$el[0])},addTabContents:function(n,t){var r=this.find(function(n){return n.__type==widget.generator.TABCONTENTS}),i;r&&(i=t.end(),i.__type===widget.generator.PAGE&&$.extend(i.includeParameter,{includeTabId:n}),r[0].addTabContents(n,$.isArray(i)?i:[i]))},getTabContents:function(){var n=this.find(function(n){return n.__type==widget.generator.TABCONTENTS});return n?n[0]:null},getChildTabContents:function(n){var t,i;for($.isArray(n)||(n=[n]),t=this,i=0;i<n.length;i++)t.getTabPane(n[i])&&(t=t.getTabPane(n[i]).find(function(n){return n.__type==widget.generator.TABCONTENTS})[0]);return t},getTabPane:function(n){var t=this.find(function(n){return n.__type==widget.generator.TABCONTENTS});return t&&t.length>0?t[0].getTabPane(n):null},getTab:function(n){var t=this.find(function(n){return n.__type==widget.generator.TABCONTENTS}),i,r;if(t&&t.length>0)for(i=0;i<t.length;i++)if(r=t[i].tabs.items.filter(function(t){return t.id==n}),r&&r.length>0)return r[0];return null},setTabActiveClass:function(n,t){var i=this.find(function(n){return n.__type==widget.generator.TABCONTENTS});i.length>0&&i[0].tabs&&i[0].tabs.setTabActiveClass(n,t)},getToolbar:function(n,t){var i=this.find(function(i){return i.__type==widget.generator.TOOLBAR&&(t||!n||i.id==n)});return i?t?i:i[0]:null},getBoardView:function(n){return this.find(function(t){return t.__type==widget.generator.BOARDVIEW&&(!n||t.id==n)})},getSectionUnion:function(n){return this.find(function(t){return t.__type==widget.generator.SECTIONUNION&&(!n||t.id==n)})},getFormSettingPanel:function(n){return this.find(function(t){return t.__type==widget.generator.FORMSETTINGPANEL&&(!n||t.id==n)})},getReport:function(n,t){t!==!1&&(t=t?t:this.currentTabId);var i=this.find(function(i){return i&&i.__type==widget.generator.REPORT&&(!n||i.id===n)&&(!t||i.tabId===t)});return n===!1&&t===!1?i:i?i[0]:null},getReportContainer:function(n){var t=this.find(function(t){return t&&t.__type==widget.generator.REPORTCONTAINER&&(!n||t.id===n)});return n===!1&&tabId===!1?t:t?t[0]:null},getCanvaseEditorContainer:function(n){var t=this.find(function(t){return t&&t.__type==widget.generator.CANVASEDITORCONTAINER&&(!n||t.id===n)});return t?t[0]:null},getCloud:function(n){var t=this.find(function(t){return t.__type==widget.generator.CLOUD&&(!n||t.id==n)});return t?t[0]:null},getCrop:function(n){var t=this.find(function(t){return t.__type==widget.generator.CROP&&(!n||t.id==n)});return t?t[0]:null},removeItem:function(n){this.itemList[n]&&(this.itemList[n].destroy(),this.itemList.splice(n,1))},removeAll:function(){for(var n=0,t=this.itemList.length;n<t;n++)this.itemList[n].destroy(),this.itemList[n]=null,delete this.itemList[n];for(n=0,t=this.items.length;n<t;n++)this.items[n]=null,delete this.items[n];this.itemList.length=0;this.items.length=0},addGrid:function(n){var f=this.getItemCount(),i,r,t,u;for($.isArray(n)||(n=[n]),this._addGridCount=n.length+f,r=0;r<n.length;r++)t={},i=n[r],t.id=i.id,t.settings=i.grid,t.settings&&(t.settings.__ecGridHidden=i.isHide),t.settings&&(t.settings.__layoutSettings=i.layoutSettings),t.isDynamic=i.isDynamic,t.containerName=this.__type,t.__type=widget.generator.GRID,t.itemIndex=this.itemList.length,t.delegator=this.delegator,t.containerDelegator=this.events,t.ecPageID=this.ecPageID,t.inIncludePage=this.inIncludePage,t.popupID=this.popupID,t.popupLevel=this.popupLevel,t.eventContainer=this.eventContainer,t._addGrid=!0,u=new ecount.layout[t.__type](t),u.render(this.$el),this.itemList.push(u),this.items.push(u)},getFileList:function(n){n=n===!0?!1:n;var t=this.find(function(t){return t.__type==widget.generator.FILELIST&&(!n||t._fileLinkId==n)});return t[0]},getDiv:function(n){var t=this.find(function(t){return t.__type==widget.generator.DIV&&(!n||t.id==n)});return t?t[0]:null},getDivContainer:function(n){var t=this.find(function(t){return t.__type==widget.generator.DIVCONTAINER&&(!n||t.id==n)});return t?t[0]:null},getUl:function(n,t){var i=this.find(function(i){return i.__type==widget.generator.UL&&(!n||i.id==n)&&(!t||i.tabId==t)});return i?i[0]:null},getTimeline:function(n,t){var i=this.find(function(i){return i.__type==widget.generator.TIMELINE&&(!n||i.id==n)&&(!t||i.tabId==t)});return i?i[0]:null},getBookmark:function(n,t){var i=this.find(function(i){return i.__type==widget.generator.BOOKMARK&&(!n||i.id==n)&&(!t||i.tabId==t)});return i?i[0]:null},getDragContainer:function(n){var t=this.find(function(t){return t.__type==widget.generator.DRAGCONTAINER&&(!n||t.id==n)});return t?t[0]:null},addEnoteTabPane:function(n,t){var i;t.itemIndex=this.itemList.length-1;t.delegator=this.delegator;t.containerDelegator=this.events;t.ecPageID=this.ecPageID;t.inIncludePage=this.inIncludePage;t.__type===widget.generator.CONTROL?(i=ecount.common.createNamespace(t.controlType),this.initializer&&ecount.control.initializeByUserSetting(this.initializer,t),i=new i(t)):(t.__type===widget.generator.TABPANE?t.colSize=this.colSize:t.__type===widget.generator.TABCONTENTS&&(this.onSingleMode=t.onSingleMode),t.hasScroll===!0&&(t.scrollContainer=parent),t.popupID=this.popupID,t.popupLevel=this.popupLevel,t.eventContainer=this.eventContainer,i=new ecount.layout[t.__type](t));this.itemList.push(i);i.render(this.$el);i=null},reloadEnotePane:function(){this.removeAll()},getContentsWidth:function(){return this.$el.width()},getContentsHeight:function(){return this.$el.height()},getGraph:function(){var n=this.find(function(n){return n.__type==widget.generator.GRAPH});return n.length>0?n:null}});ecount.layout.dragContainer||(ecount.layout.dragContainer={});ecount.layout.dragContainer._export=function(){return{prop:{template:'<div class="wrapper-button-setup"><\/div>',enbledTemplate:'<div id="enabled" class="button-setup-enabled" data-draggable-place="{{draggablePlace}}"/><\/div>',disabledTemplate:'<div id="disabled" class="button-setup-disabled" data-draggable-place="{{draggablePlace}}"/><\/div>',arrowByParent:'<div id="parent-blank" class="control-set button-setting"><div class="control"><div class="draggable-holder"><div class="holder-top"><\/div><\/div><\/div><\/div>',arrowByChild:'<div id="child-blank" class="draggable-holder"><div class="holder-left"><\/div><\/div>',enabledItemsPosition:[],disabledItemsPosition:[],init:function(n){ecount.layout.prototype.init.apply(this,arguments);this.itemList=[];this.minNotificationCount=n.minNotificationCount||1;this.ecTransaction=new ecount.transaction({ecPageID:this.ecPageID});this.ecTransaction.complete(this.onLoadComplete.bind(this));this.initializer=ecount.global.findCallback(this.ecPageID,ecount.widget.initializer);this.events=new ecount.events(this);this.events.on({"item.onload":this.onLoadItem,scope:this})},render:function(n){ecount.layout.prototype.render.apply(this,arguments);this.createEnbled();this.createDisabled();this.ecTransaction.start();n.append(this.$el)},createEnbled:function(){var n=this.itemEnabled;this.enbledTemplate=this.enbledTemplate.replace("{{draggablePlace}}",this.draggablePlace?"enabled"+ecount.delimiter+this.id:"");this.$elEnbled=$(this.enbledTemplate);this.createContents(n,this.$elEnbled)},createDisabled:function(){var n=this.itemDisabled;this.disabledTemplate=this.disabledTemplate.replace("{{draggablePlace}}",this.draggablePlace?"disabled"+ecount.delimiter+this.id:"");this.$elDisabled=$(this.disabledTemplate);this.createContents(n,this.$elDisabled)},createContents:function(n,t){this.createItems(n,t);this.$el.append(t)},createItems:function(n,t){var r,u,i;if(n||n.length>0)for(r=0,u=n.length;r<u;r++)i=n[r],i.itemIndex=r,i.ecPageID=this.ecPageID,i.tabId=this.tabId,i.onSync=this.onSync,i.containerName=this.containerName,i.delegator=this.delegator,this.events&&(i.containerDelegator=this.events),i=new ecount.layout[i.__type](i),i.render(t||this.$el),i.$el.after(" "),i=null},createControl:function(n,t){var u="enabled",e=this.getToolbar(u),i=this.getControl(t),r={},f;i&&(f={position:"insertAfter",selectedContainerID:u,targetID:i.id,target:i.getContainerElement()},r.dragButtons=n,r.dropdownOptions=i.dropdownOptions,e.addItemList(r,f))},getControl:function(n){for(var r,u=this.itemList,t=null,i=0,f=u.length;i<f;i++)if(r=u[i],r.__type===widget.generator.TOOLBAR&&(t=r.getControl(n),!_.isNull(t)))return t;return t},getControlPosition:function(n){var o=[],l=this.getToolbar(n),u=l.getItemList(),f,e,i,s,t,h,r,c;if(u.length>0)for(r=0,c=u.length;r<c;r++)f=u[r],e=f.getContainerElement(),i=e.find("button").innerWidth(),s=e.offset(),t=s.left,h={id:f.id,left:t,right:t+i,width:i,center:(t+i-t)/2+t},o.push(h);return o},getDragPosition:function(n){var f=$(n.oEvent.target),e="",i="",c="",t="insertBefore",l,r,u,o,h,s;if(this.moveType=="none")return null;if(this.moveType=="parent")if(l=n.oEvent.clientX,r=this.getControlPosition(n.containerID),r.length>0&&n.containerID!=="disabled"){for(u=0;u<r.length;u++){if(o=r[u],l<o.center){i=o.id;t="insertBefore";break}u==r.length-1&&(i=o.id,t="insertAfter")}c=this.getControl(i);e=c.getContainerElement()}else t=r.length>0?"onlyAfter":"noParent";else h=f.height(),s=f.offset(),i=f.attr("data-cid"),e=f,i=="buttonAddArea"?(t="insertBefore",this.emptyTarget=e.closest(".control-set")):Math.floor(s.top)<=n.oEvent.clientY&&n.oEvent.clientY<s.top+h/2?t="insertBefore":s.top+h/2<n.oEvent.clientY&&(t="insertAfter");return{position:t,targetID:i,target:e,moveLevel:this.moveLevel,moveType:this.moveType,startTargetID:this.dragTargetID,startContainerID:this.startContainerID,selectedContainerID:n.containerID,notSelectedContainerID:n.containerID==="enabled"?"disabled":"enabled"}},setDragEvent:function(){this.dragInstance||(this.dragInstance=new ecount.draggable);this.dragInstance.setDragData({id:this.id,target:this.$el,helper:this.makeDragHelper.bind(this),helperDistance:{x:20,y:10},droppable:this.$el,otherBlank:{isUsed:!0,parentArrowBlank:this.arrowByParent,childArrowBlank:this.arrowByChild,callback:this.setArrowDisplay.bind(this)},drag_start:this.dragStartEvent.bind(this),drag_move:this.dragMoveEvent.bind(this),drag_stop:this.dragStopEvent.bind(this),drag_clear:this.dragClear.bind(this)})},dragStartEvent:function(n){var u=n.originalEvent.target,t=u.getAttribute("data-cid");if(this.dragTargetID=t,this.emptyTarget=null,this.moveLevel=null,this._$dragTarget=$(n.originalEvent.target),t&&t!=="buttonAddArea"){var f=$(u).parents("[class^='button-setup-']").attr("id"),i=this.getControl(t),r=this._$dragTarget.attr("data-index"),e=i.getComponent(r),o=i.getComponents(),s=o.filter(function(n){return n.id!=="buttonAddArea"});this.startContainerID=f;this.moveLevel=i.isSingle||s.length!=1&&r=="0"||e.isOnlyParent===!0?f==="disabled"&&i.isSingle!=="only"&&e.isOnlyParent!==!0?"allRound":"parent":"allRound";r==="0"?this._$dragTarget.parent().css("opacity","0.4"):this._$dragTarget.css("opacity","0.4")}else return!1;return},makeDragHelper:function(n,t){var r="left: "+t.clientX+"px; top: "+t.clientY+"px;",u=this.getControl(this.dragTargetID),i=u.getComponents().head(function(n){return n.cid==this.dragTargetID}.bind(this)),f=i["style.css"];return i?"<button class='"+f+"' style='position: absolute; "+r+"z-index: 99999; transition: none'>"+i.label+"<\/button>":t.originalEvent.target},dragMoveEvent:function(n){var t=$(n.originalEvent.target),r=n.helper,i=null,u;if(r.hasClass("not-droppable")&&n.isDroppable?r.removeClass("not-droppable"):r.hasClass("not-droppable")||n.isDroppable||r.addClass("not-droppable"),i=t.hasClass("button-setup-enabled")||t.hasClass("button-setup-disabled")?t.attr("id"):t.parents("[class^='button-setup-']").attr("id"),!i)return!1;if(t.length>0)if(u=t.attr("data-role"),u==="parent"||u==="child"||u==="buttonAddArea"){var e=t.attr("data-cid"),s=t.attr("data-ecpath"),f=this.getControl(e),h=e==="buttonAddArea"?s.split(ecount.separator.ecPath)[5]:f.id,c=t.attr("data-index"),o=f.getComponent(c);this.moveType=h===this.dragTargetID?"none":this.moveLevel==="parent"||f.isSingle===!0||i==="disabled"||o&&o.isOnlyParent?"parent":"child"}else this.moveType="parent";return this.dragPosition=this.getDragPosition({containerID:i,oEvent:n.originalEvent}),this.startContainerID==="disabled"&&i==="disabled"?!1:!0},setArrowDisplay:function(n,t,i){var u,r,f,e,o,s;if(n&&n.remove(),t&&t.remove(),!this.dragPosition||i===!1||_.isNull(this.dragPosition)){this._$dragTarget.parents().find(".button-setting").removeClass("button-setting");return}if(u=this.getToolbar(this.dragPosition.selectedContainerID),this.dragPosition.position==="noParent")n.insertAfter(u.$el[0]);else if(this.dragPosition.position==="onlyAfter")r=u.getItemList(),n.insertAfter(r[r.length-1].getContainerElement()[0]);else{if(this.dragPosition.selectedContainerID==="enabled")for(r=u.getItemList(),f=0,e=r.length;f<e;f++)o=r[f],s=o.getContainerElement(),s.removeClass("button-setting");this.dragPosition.moveType==="parent"?n[this.dragPosition.position](this.dragPosition.target[0]):(t[this.dragPosition.position](this.dragPosition.target[0]),this.dragPosition.targetID==="buttonAddArea"?this.emptyTarget.addClass("button-setting"):this.getControl(this.dragPosition.targetID).getContainerElement().addClass("button-setting"))}},dragStopEvent:function(n){var t=this.dragPosition,o;if(!_.isNull(t)&&!_.isUndefined(t)){var s=t.moveType,h=t.moveLevel,c=t.startTargetID,l=t.targetID,i=t.startContainerID,r=t.selectedContainerID,e=t.notSelectedContainerID,u=this.getToolbar(r),a=this.getToolbar(e),v=this.getToolbar("enabled"),y=v.getItemList().length,f;if(y<=this.minNotificationCount&&e==="enabled"&&i==="enabled"&&(o=this._$dragTarget.attr("data-role"),o==="parent")){ecount.alert(String.format("버튼은 최소 {0}개 이상 사용되어야 합니다.",this.minNotificationCount));return}c!==l&&n.isDroppable&&(i!=="disabled"||r!=="disabled")&&(h==="parent"&&i==="enabled"&&r==="enabled"?u.setChangePosition(t):(f=i==="enabled"&&r==="enabled"?u.removeControl(t):a.removeControl(t),s==="parent"?u.addItemList(f,t):u.addControl(f,t)))}},dragClear:function(){return this._$dragTarget&&(this._$dragTarget.css("opacity",""),this._$dragTarget.parent().css("opacity","")),this.dragPosition=null,ecview.util.showTimeOverCheck(),!1},serialize:function(){var n=this.getToolbar("","all"),r=[],t,u,i;if(n.length>0){for(n.reverse(),t=0,u=n.length;t<u;t++)i=n[t],r.push({key:i.id,value:i.serialize()});return r}},onLoadItem:function(n){var t=n.__self;t.$el&&t.$el.after(" ");this.itemList.push(t)},onLoadComplete:function(){var n={target:this.containerName,type:this.__type,__self:this};this.containerDelegator?this.containerDelegator.triggerEvent("item.onload",n):this.delegator&&this.delegator.triggerEvent("item.onload",n);this.setDragEvent()},ON_CLICK:function(n,t,i){i||this.$el.prevAll("#titleContents").focus()}},create:function(){var n=$.extend({},this.prop);ecount.layout.dragContainer=$.Class(ecount.layout.container,n)}}};ecount.layout.dragIconbarContainer||(ecount.layout.dragIconbarContainer={});ecount.layout.dragIconbarContainer._export=function(){return{prop:{template:'<div class="wrapper-apps-setup"><\/div>',enabledTemplate:'<div id="enabled" class="apps-setup-enabled" data-draggable-place="enabled"/><\/div>',disabledTemplate:'<div id="disabled" class="apps-setup-disabled" data-draggable-place="disabled"/><\/div>',arrowByParent:'<li id="parent-blank" class="draggable-holder"><\/div>',enabledItemsPosition:[],disabledItemsPosition:[],init:function(){ecount.layout.prototype.init.apply(this,arguments);this.itemList=[];this.ecTransaction=new ecount.transaction({ecPageID:this.ecPageID});this.ecTransaction.complete(this.onLoadComplete.bind(this));this.initializer=ecount.global.findCallback(this.ecPageID,ecount.widget.initializer);this.events=new ecount.events(this);this.events.on({"item.onload":this.onLoadItem,scope:this})},render:function(n){ecount.layout.prototype.render.apply(this,arguments);this.createEnabled();this.createDisabled();this.ecTransaction.start();n.append(this.$el)},createEnabled:function(){var n=$(this.enabledTemplate);this.createContents(this.itemEnabled,n);this.createIconList("enabled",this.enabledList,n)},createDisabled:function(){var n=$(this.disabledTemplate);this.createContents(this.itemDisabled,n);this.createIconList("disabled",this.disabledList,n)},createContents:function(n,t){this.createItems(n,t);this.$el.append(t)},createItems:function(n,t){var r,u,i;if(n||n.length>0)for(r=0,u=n.length;r<u;r++)i=n[r],i.itemIndex=r,i.ecPageID=this.ecPageID,i.tabId=this.tabId,i.onSync=this.onSync,i.containerName=this.containerName,i.delegator=this.delegator,this.events&&(i.containerDelegator=this.events),i=new ecount.layout[i.__type](i),i.render(t||this.$el),i.$el.after(" "),i=null},createIconList:function(n,t,i){var u="<li class={{className}} data-cid={{id}} data-index={{index}} data-type={{type}}><div class='apps-title'>{{title}}<\/div><\/li>",r=$("<ul class='apps'><\/ul>");t.forEach(function(t){var i=u.replace("{{className}}",t.className).replace("{{id}}",t.id).replace("{{title}}",t.ICON_NM).replace("{{type}}",n).replace("{{index}}",t.ICON_SORT_SNO);r.append(i)});i.append(r);this.$el.append(i)},setChangePosition:function(n){var e=n.startContainerID=="enabled"?this.enabledList:this.disabledList,u=e.find(function(t){return t.id==n.startTargetID}),o=n.selectedContainerID=="enabled"?this.enabledList:this.disabledList,h=o.find(function(t){return t.id==n.targetID}),s=n.position.split("insert").join("").toLowerCase(),r=this.getTargetIndex(n.startContainerID,u.id),t=-1,f,i;if(h&&(t=this.getTargetIndex(n.selectedContainerID,h.id)),s=="noparent"&&r>-1){f=e.splice(r,1);o.push(f[0]);i=this.$el.find('[data-cid="'+u.id+'"]');this.$el.find('div[data-draggable-place="'+n.selectedContainerID+'"]').find("ul").append(i);i.attr("data-type",n.selectedContainerID);return}r>-1&&t>-1&&(n.startContainerID==n.selectedContainerID&&r<t&&t--,s=="after"&&t++,f=e.splice(r,1),o.splice(t,0,f[0]));_.isNull(u)||(i=this.$el.find('[data-cid="'+u.id+'"]'),this.$el.find(n.target)[s](i),i.attr("data-type",n.selectedContainerID))},getTargetIndex:function(n,t){var i=n=="enabled"?this.enabledList:this.disabledList;return i.findIndex(function(n){return n.id==t})},setDragEvent:function(){this.dragInstance||(this.dragInstance=new ecount.draggable);this.dragInstance.setDragData({id:this.id,target:this.$el.find("ul.apps"),helper:this.makeDragHelper.bind(this),helperDistance:{x:10,y:10},droppable:this.$el,axis:"horizontal",drag_start:function(n){var t=n.originalEvent.target,i=t.getAttribute("data-cid");if(this.dragTargetID=i,this._$dragTarget=$(t).closest("li"),this.startContainerID=$(t).attr("data-type"),!i)return!1;this._$dragTarget.addClass("draggable-item")}.bind(this),drag_move:function(n){var t=$(n.originalEvent.target),u=t.closest("li"),r=n.helper,i=null;if(r.hasClass("not-droppable")&&n.isDroppable?r.removeClass("not-droppable"):r.hasClass("not-droppable")||n.isDroppable||r.addClass("not-droppable"),u.attr("data-type")?i=u.attr("data-type"):t.attr("data-draggable-place")?i=t.attr("data-draggable-place"):t.parents("[class^='apps-setup-']")&&(i=t.parents("[class^='apps-setup-']").attr("id")),!i)return!1;this.dragPosition=this.getDragPosition({containerID:i,oEvent:n.originalEvent})}.bind(this),drag_stop:function(n){var t=this.dragPosition,i,r;_.isNull(t)||_.isUndefined(t)||(i=t.startTargetID,r=t.targetID,i!==r&&n.isDroppable)&&this.setChangePosition(t)}.bind(this),otherBlank:{isUsed:!0,parentArrowBlank:this.arrowByParent,callback:this.setArrowDisplay.bind(this)},drag_clear:this.dragClear.bind(this)})},makeDragHelper:function(n,t){var u="left: "+t.clientX+"px; top: "+t.clientY+"px;",i=t.originalEvent.target,r="";return i.classList.forEach(function(n){n!="draggable-item"&&(r+=n+" ")}),"<div class='wrapper-apps-setup' style='position: absolute; "+u+"z-index: 99999;'><ul class='apps apps-helper'><li class='"+r+"'>"+i.innerHTML+"<\/li><\/ul><\/div>"},getDragPosition:function(n){var e="",i="",r="insertBefore",o=n.oEvent.clientX,u=this.getControlPosition(n.containerID),t,f;if(u.length>0){for(t=0;t<u.length;t++){if(f=u[t],o<f.center){i=f.id;r="insertBefore";break}t==u.length-1&&(i=f.id,r="insertAfter")}e=this.$el.find("[data-cid="+i+"]")}else r="noParent";return{position:r,targetID:i,target:e,startTargetID:this.dragTargetID,startContainerID:this.startContainerID,selectedContainerID:n.containerID,notSelectedContainerID:n.containerID==="enabled"?"disabled":"enabled"}},getControlPosition:function(n){var o=[],u=n=="enabled"?this.enabledList:this.disabledList,f,e,i,s,t,h,r,c;if(u.length>0)for(r=0,c=u.length;r<c;r++)f=u[r],e=this.$el.find("[data-cid="+f.id+"]"),i=e.outerWidth(),s=e.offset(),t=s.left,h={id:f.id,left:t,right:t+i,width:i,center:(t+i-t)/2+t},o.push(h);return o},setArrowDisplay:function(n,t,i){if(n&&n.remove(),this.dragPosition&&i!==!1&&!_.isNull(this.dragPosition)){var r=this.$el.find("[data-draggable-place="+this.dragPosition.selectedContainerID+"]").find("ul");this.dragPosition.position==="noParent"?r.append(n):n[this.dragPosition.position](this.dragPosition.target[0])}},dragClear:function(){return this._$dragTarget&&this._$dragTarget.removeClass("draggable-item"),this.dragPosition=null,!1},serialize:function(){var n=[];return this.enabledList.length>0&&(n=n.concat(this.enabledList.map(function(n,t){return n.ICON_SORT_SNO=t+1,n.EXPOSURE_TF=!0,n}.bind(this)))),this.disabledList.length>0&&(n=n.concat(this.disabledList.map(function(n,t){return n.ICON_SORT_SNO=t+1,n.EXPOSURE_TF=!1,n}.bind(this)))),ecount.testLog&&console.log("serialize result :",n),n},onLoadItem:function(n){var t=n.__self;t.$el&&t.$el.after(" ");this.itemList.push(t)},onLoadComplete:function(){var n={target:this.containerName,type:this.__type,__self:this};this.containerDelegator?this.containerDelegator.triggerEvent("item.onload",n):this.delegator&&this.delegator.triggerEvent("item.onload",n);this.setDragEvent()},ON_CLICK:function(n,t,i){i||this.$el.prevAll("#titleContents").focus()}},create:function(){var n=$.extend({},this.prop);ecount.layout.dragIconbarContainer=$.Class(ecount.layout.container,n)}}};ecount.class("ecount.layout.contents","ecount.layout.container",{template:null,type:null,itemList:null,colSize:1,init:function(){ecount.layout.container.prototype.init.apply(this,arguments);this.itemList=[]},render:function(n){var i,r,t,e,o,u,f;if(this.$el=n,this.useBgSection&&(i=this[this.bgSectionType],!i||this.$el.append($(i))),this.hidden&&this.$el.addClass("hidden"),this.colGroup){for(r=$('<div class="row" {{parentAttr}}><\/div>'.replace("{{parentAttr}}",this.colGroupParentAttr||"")),this.items=[],t=0,e=this.colGroup.length;t<e;t++)o=this.colGroup[t].item,o&&(u=$('<div class="col-xs-'+this.colGroup[t].size+'"/>'),this.createItems([this.colGroup[t].item],u),r.append(u));this.$el.append(r)}else this.useContract?(f=$('<div class="wrapper-report"/>'),this.createItems(this.items,f),this.$el.append(f)):this.createItems(this.items);_.isFunction(this.scrollCallback)&&this.bindScrollEvent(this.ecPageID,this.scrollCallback);_.get(this._options,"isDefaultStyle")&&ecount.stylist.setStyleReset(this.$el)},setStyleReset:function(){this.$el&&(ecount.stylist.setStyleReset(this.$el),_.isPlainObject(this._options)?this._options.isDefaultStyle=!0:this._options={isDefaultStyle:!0})},get:function(n){return this.itemList[n]},getHtml:function(n){var t="",i,r;return n&&_.isObject(n)&&n.deleteLink===!0?(i=$("<div><\/div>").html(this.$el.html()),i.find("a").each(function(){$(this).replaceWith($(this).html())}),t=i.html().replace(/text-primary-inverse/g,"bsy").replace(/url\("([^)"]+).gif"\)/g,"url($1.gif)")):(r=this.$el.html(),t=r.replace(/text-primary-inverse/g,"bsy").replace(/url\("([^)"]+).gif"\)/g,"url($1.gif)")),t},scrollTop:function(n){this.$el.scrollTop($.isEmpty(n)?this.$el.height():n)},hideBgSection:function(){if(!!this[this.bgSectionType]){var n=$("<div>").append($(this[this.bgSectionType])),t=n.find("div")[0].classList[0],i=this.$el.find("."+t);i.hide()}},search:'<div class="wrapper-page-inform-centered"><div class="wrapper-page-inform"><div class="page-inform-icon"><span class="font-icon-search text-muted"/><\/div><div class="page-inform-contents">'+ecount.resource.MSG10490+"<\/div><\/div><\/div>"});ecount.class("ecount.layout.dropdown","ecount.layout",{template:'<ul class="dropdown-menu "/>',items:null,isShow:!1,prefix:"dropdown",itemList:null,baseType:!1,canHoldItemState:!1,hasMultiItemState:!1,withRemoveBtn:!1,init:function(){ecount.layout.prototype.init.apply(this,arguments);this.bodyClickHandler=function(n){var t=n.target;t&&$(t).parent().hasClass("dropdown-menu-item-group")||t&&t.getAttribute&&t.getAttribute("data-trigger")=="click"||this.hide.call(this,n)}.bind(this);this.keydownHandler=function(n){if(n.keyCode===13)return this.hide(),this.clickHandler(n),!1}.bind(this);this.itemList=[]},render:function(){if(this.setTemplate(),ecount.layout.prototype.render.apply(this,arguments),this.items&&this._addItems(this.items.toArray(),this.$el),this.isSetDropdownSize&&this.$el.addClass("dropdown-menu-fixed-height"),this.$el.hasClass("position-fixed")||this.$el.addClass("position-fixed"),!ecount.isMobile)this.$el.on("click","a[data-trigger=click]",this.clickHandler.bind(this));this.$el.find("a > span.close").bind("click",function(n){this.removeItem(n.currentTarget.getAttribute("list-id"));n.preventDefault();n.stopPropagation()}.bind(this));this.$el&&this.$el[0]&&this.$el[0].setAttribute("data-ulecpageid",this.ecPageID)},setTemplate:function(){function i(n,t,i){return n.substr(0,t-i-3)+"..."+n.substr(i*-1)}if(this.css&&(this.template='<ul class="dropdown-menu '+this.css+'"/>'),!$.isNull(this.minimalize))for(var n,t=0,r=this.items.length;t<r;t++)n=this.items[t],n.reducedLabel=n.label.length>this.minimalize.maxLen?i(n.label,this.minimalize.maxLen,this.minimalize.suffixLen):n.label},destroy:function(){this.hide();this.removeItems();this.$el&&this.$el.length>0&&(ecount.widget.removeChild(this.$el[0]),this.$el=null,delete this.$el)},addItems:function(n,t){this.items=this.items.concat(n);n&&this._addItems(n,t)},_addItems:function(n,t){var f,u,h,l,e,r,o,a,w=$(this.eventContainer||document),i,v,s,y,p,c;for(t||(t=this.$el),i=0,v=n.length;i<v;i++)if(e=this.ppcid?this.ppcid:this.pcid||"",n[i].__type===widget.generator.CONTROL){if(u=$('<li class="dropdown-menu-form"/>'),n[i].delegator=this.delegator,n[i].data)for(s=0;s<n[i].data.length;s++)n[i].data[s].pcid=e;f=ecount.common.createNamespace(n[i].controlType);f=new f(n[i]);f.render(u);f.$el.bind("click",function(n){n.stopPropagation()});t.append(u);this.itemList.push(f)}else h=n[i].css?' class="'+n[i].css+'"':"",y=n[i].aCss?n[i].isShowChecked?'class="checked-item '+n[i].aCss+'"':'class="'+n[i].aCss+'"':n[i].isShowChecked?'class="checked-item"':"",l=n[i].spanCSS!=undefined?' class="'+n[i].spanCSS+'"':"",a=n[i].isUseSpanInside===!0?"<span {{anchorSpanCSS}}><\/span>".replace("{{anchorSpanCSS}}",l):"",n[i].isDropdownTabItem===!0?(o=String.format("data-isDropdownTabItem='true' data-parentTabID='{0}'",n[i].parentTabID),r=String.format("<li id={0} data-isDropdownTabItem='true' {{css}} {{childItem}}>",n[i].id)):(o="",r="<li {{css}} {{childItem}}>"),r=n[i].childItems?r.replace(/{{childItem}}/g,'data-childItem="childItem_'+i+'"'):r.replace(/{{childItem}}/g,""),this.baseType?(r=n[i].liCss?r.replace(/{{css}}/g,'class="'+n[i].liCss+'"'):r.replace(/{{css}}/g,""),u=$(r+"<a "+h+'href="javascript:;" '+o+' data-trigger="click" data-cid="'+e+'" data-function="fnLayerClick" data-function-index="'+i+'"  id="list-'+this.prefix+"-"+n[i].id+'" data-value="'+(n[i].value||"")+'" originid="'+n[i].id+'">'+(n[i].isShowChecked?'<span class="fa fa-check text-primary"><\/span> ':"")+n[i].label+"<\/a><\/li>")):(r=n[i].liCss?r.replace(/{{css}}/g,'class="'+n[i].liCss+'"'):r.replace(/{{css}}/g,""),c="",this.dualMode&&(p=" data-dualStep="+n[i].dualStep+" data-dualControlId="+n[i].dualControlId),c=["{{liTemplate}}",'<a href="javascript:;" {{attrDropdownTabItem}}',' data-trigger="click" data-cid="{{cid}}" data-toggle="tooltip" {{aCss}}',' data-placement="left"  id="list-{{prefix}}-{{id}}"','data-function="fnLayerClick" data-function-index="'+i+'"','{{dualStepInfo}} data-value="{{value}}" data-originLabel="{{originLabel}}">',"{{anchorSpanInside}}","{{label}}","{{removeBtn}}","<\/a>","<\/li>"].join(""),u=$(c.replace("{{liTemplate}}",r).replace("{{attrDropdownTabItem}}",o).replace("{{cid}}",e).replace("{{css}}",h).replace("{{aCss}}",y).replace("{{prefix}}",this.prefix).replace("{{id}}",n[i].id).replace("{{dualStepInfo}}",p).replace("{{value}}",n[i].value).replace("{{anchorSpanInside}}",a).replace("{{originLabel}}",n[i].label).replace("{{label}}",(n[i].isShowChecked?'<span class="fa fa-check text-primary"><\/span> ':"")+($.isNull(this.minimalize)?n[i].label:n[i].reducedLabel)).replace("{{removeBtn}}",this.withRemoveBtn?'<span class="close" list-id="'+n[i].id+'"><\/span>':""))),n[i].isChildDepth==!0&&(this.isChildDepth=!0,this.addChildItems(u,n[i].childItems,i)),t.append(u)},addChildItems:function(n,t,i){for(var r,u=$(this.eventContainer||document),e=!1,o=2-ecount.common.getZoomRatio(),f=0;f<t.length;f++)t[f].isShowChecked&&(e=!0);r=$('<ul class="dropdown-menu'+(t.length>8?" dropdown-menu-fixed-height":"")+(e?" dropdown-menu-checked-list":"")+'"data-childItem="childItem_'+(i||0).toString()+'"><\/ul>');n.addClass("dropdown-menu-item-group");n.append(r);this.$el.parent().hasClass("dropup")&&n.addClass("dropup");this._addItems(t,r);this.$el.hasClass("context-menu")||this.$el.addClass("context-menu");$(n.find("a")[0]).bind("mouseenter",function(n){var t,i;n.target&&$(n.target).parent().find("ul").length>0&&(t=$($(n.target).parent().find("ul")[0]),t.show(),t.parent().removeClass("dropdown-menu-item-group-left"),$(n.target).closest("li").addClass("open"),i=u.outerWidth()/o,u&&u[0]!=document||(i=$(window).width()/o+$(document).scrollLeft()),t.offset().left+t.width()>i&&(t.parent().hasClass("dropdown-menu-item-group-left")||t.parent().addClass("dropdown-menu-item-group-left")),ecount.__isEventCaptureMode()&&window.setTimeout(function(){ecount.eventLog("mouseover",{type:"mouseover",action:"showDropdownSubItem",actionTarget:this.id,desc:$(this).text(),value:this.getAttribute("data-value"),item:t})}.bind(this)))});$(n).bind("mouseleave",function(n){ecount.__isTRevokeEventMode()||$(n.target).closest("li").removeClass("open")});r.bind("mouseenter",function(n){this.toggleParentDropdown(n,!0)}.bind(this));r.bind("mouseleave",function(n){ecount.__isTRevokeEventMode()||this.toggleParentDropdown(n,!1)}.bind(this))},toggleParentDropdown:function(n,t){var r=n.currentTarget.getAttribute("data-childitem"),i=$(n.currentTarget).parent(),u=i.data("childitem");r===u&&(t?i.hasClass("open")||i.addClass("open"):i.hasClass("open")&&i.removeClass("open"))},removeChildItems:function(n){for(var t,i=this.$el.find("a[id='list-"+this.prefix+"-"+n+"']").parent(),r=i.find("ul"),f=r.find("li.dropdown-menu-form"),u=0;u<f.length;u++)for(t=0;t<this.itemList.length;t++)if(f.find(this.itemList[t].$el).length>0){this.itemList[t].destroy();this.itemList.splice(u,1);break}i.removeClass("dropdown-menu-item-group");i.removeClass("dropdown-menu-item-group-left");r.off();r.remove()},insertChildItems:function(n,t){var i=this.$el.find("a[id='list-"+this.prefix+"-"+n+"']").parent();this.addChildItems(i,t)},removeItem:function(n){var u=this.$el?this.$el.find("a"):[],f,i,r,t;for($.isArray(n)||(n=[n]),r=0;r<n.length;r++)if(i=this.findItem(n[r]),!$.isNull(i)&&!$.isEmpty(i)){if(!_.isEmpty(i.attr("id"))&&this.onClickPriority){f={targetID:i.attr("id"),controlID:this.pcid,pcontrolID:this.ppcid,gridID:this.gridID,label:i.text(),value:i.data("value"),isRemoved:!0,type:"dropdown.click"};this.onClickPriority(f)}for(i.parent().remove(),u.splice(r,1),t=0;t<this.items.length;t++)this.items[t].id==n[r]&&this.items.splice(t,1);for(t=0;t<this.itemList.length;t++)this.itemList[t].__type===widget.generator.CONTROL&&this.itemList[t].id==n[r]&&this.itemList.splice(t,1)}u.length==0&&(this.onBeforeHide&&this.onBeforeHide(),this.hide())},showItem:function(n){$.isArray(n)||(n=[n]);$.each(n,function(n,t){var i=this.findItem(t);i&&i.hasClass("hidden")&&i.removeClass("hidden")}.bind(this))},hideItem:function(n){$.isArray(n)||(n=[n]);$.each(n,function(n,t){var i=this.findItem(t);i&&!i.hasClass("hidden")&&i.addClass("hidden")}.bind(this))},showItemList:function(){for(var t=this.$el.find("a")||[],i=[],n=0;n<t.length;n++)t.eq(n)&&!t.eq(n).hasClass("hidden")&&i.push(t.eq(n));return i},hideItemList:function(){for(var t=this.$el.find("a")||[],i=[],n=0;n<t.length;n++)t.eq(n)&&t.eq(n).hasClass("hidden")&&i.push(t.eq(n));return i},changeItemText:function(n,t){var i=this.findItem(n);i&&i.text(t)},changeItemClass:function(n,t){var i=this.findItem(n);i&&(t==null?i.removeAttr("class"):i.attr("class",t))},changeItemValue:function(n,t){var i=this.findItem(n);i&&i.attr("data-value",t)},findItem:function(n){for(var i,e="list-"+this.prefix+"-"+n,u=this.$el?this.$el.find("a"):[],f=this.$el?this.$el.find("li").children():[],t=0,r=u.length;t<r;t++)if(i=u.eq(t),i.attr("id")===e)return i;for(t=0,r=f.length;t<r;t++)if(i=f.eq(t),i.attr("data-cid")===n)return i;return null},removeItems:function(){this.itemList.forEach(function(n,t){t.destroy();t=null;delete t});this.itemList=[];this.$el&&(this.$el.find("a").off(),this.$el.find("li").remove())},clickHandler:function(n){var t=$(n.target),r={targetID:n.target.id,controlID:this.pcid,pcontrolID:this.ppcid,gridID:this.gridID,value:t.attr("data-value"),dualstep:t.data("dualstep"),dualcontrolid:t.data("dualcontrolid"),originId:t.attr("originid"),originEvent:n},o=Boolean(t.attr("data-isDropdownTabItem")),i,u;if(n.target.tagName.toUpperCase()=="A"||n.currentTarget.tagName=="A"){if(i=this,u=$(t).parentsUntil(".context-menu","ul").length,this.canHoldItemState==!0&&this.stateLevels.contains(u)){var f='<span class="fa fa-check text-primary"><\/span>',s=t.closest("ul"),e=t.find("span.fa-check");this.hasMultiItemState==!1?(s.find("span.fa-check").remove(),t.prepend(f)):e.length>0?(e.remove(),r.isRemoved=!0):t.prepend(f)}if(t&&$(t).parent().hasClass("dropdown-menu-item-group")||this.hide(),i.onClickPriority){r.type="dropdown.click";i.onClickPriority(r)}if(i.delegator)i.delegator.triggerEvent("dropdown.click",r);else if(i.onClick)if(o===!0)i.onClick(n);else{r.type="dropdown.click";i.onClick(r)}}return n.preventDefault(),!1},reset:function(){this.itemList.forEach(function(n){n.reset()})},toggle:function(n){this.isShow?this.hide(n):this.show(n)},show:function(){if(!this.isShow){if(["function","button","dropdown"].contains(this.prefix)&&ecount.__isTRevokeAutoOpenMode())return;this.isShow=!0;this.onBeforeShow&&this.onBeforeShow(this);this._show();ecount.__isEventCaptureMode()&&ecount.eventLog("layout.showDropdown",{type:"layout.showDropdown",__self:this});$(document).on("mousedown.ecDropdown"+(this.pcid||this._tabId||""),this.bodyClickHandler);this.$el.bind("keydown",this.keydownHandler)}},hide:function(n){if((!n||!this.pcid||!(this.$el.find($(n.target)).length>0||this.$el[0]==n.target))&&(!n||!n.type||n.type!="scroll"||!this.isChildDepth||this.__target!=widget.generator.HEADER||!this.pnode||!this.pnode.parents("div.header")||!this.pnode.parents("div.header").hasClass("header-fixed"))&&!ecount.__isTRevokeEventMode()&&this.isShow){this.isShow=!1;this.onBeforeHide&&this.onBeforeHide(n);this._hide();$(document).unbind("mousedown.ecDropdown"+(this.pcid||this._tabId||""),this.bodyClickHandler);this.$el.unbind("keydown",this.keydownHandler);var t=this.$el.find("ul");t.length>0&&t.hide();ecount.__isEventCaptureMode()&&ecount.eventLog("layout.hideDropdown",{type:"layout.hideDropdown",_self:this})}},getList:function(n){return this.itemList[n]},getOptionLength:function(){return this.items?this.items.length:0},getListById:function(n){for(var t=0,i=this.itemList.length;t<i;t++)if(this.itemList[t].id==n)return this.itemList[t]},getNodeList:function(n){return this.$el.find("li")[n]},removeClass:function(n){this.$el.removeClass(n)}});ecount.layout.ep||(ecount.layout.ep={});ecount.layout.ep._export=function(){return{prop:{template:'<div class="wrapper-widget-list"><\/div><div class="grid-stack" data-gs-animate="true"><\/div>',menuTemplate:['<div class="widget-toggle-btn" data-value="toggleMenu" data-function="click">','<span class="fa fa-exchange" data-value="toggleMenu"><\/span>',"<\/div>",'<div class="widget-list-header">','<div class="widget-setup-title">','<span class="title">'+ecount.resource.LBL14183+"<\/span>",'<div class="pull-right">','<button class="btn btn-default btn-sm" data-value="reset" data-function="click">'+ecount.resource.LBL02928+"<\/button>","<\/div>","<\/div>",'<div class="widget-setup-description">',ecount.resource.MSG06982,"<\/div>","<\/div>",'<div class="widget-list-body">','<div class="grid-stack-item">','<div class="grid-stack-item-content ui-draggable-handle"><\/div>',"<\/div>","<ul>","{{menuTitle}}","<\/ul>","<\/div>"].join(""),$body:null,$menu:null,css:"",_redrawControlType:null,_redrawTargetID:null,init:function(){ecount.layout.prototype.init.apply(this,arguments);this.itemList=[];this.events=new ecount.events(this);this.events.on({"dropdown.click":this._ON_DROPDOWN_CLICK,"reload.ep":this.reloadEpControl,"epType.save":this.setRedrawControlType,"progressbar.show":this.transferEvent,"progressbar.hide":this.transferEvent});this.ecTransaction=new ecount.transaction({ecPageID:this.ecPageID});this.ecTransaction.complete(this.onLoadComplete.bind(this));this.initializer=ecount.global.findCallback(this.ecPageID,ecount.widget.initializer);$(ecount.popup.parent).bind("resize.ep",function(){this.$body.data("gridstack")&&this.$body.data("gridstack")._updateContainerHeight()}.bind(this));this.callbackID=ecount.global.registerCallback(this.ecPageID,this.onMessageHandler,this)},destroy:function(){ecount.layout.prototype.destroy.apply(this,arguments);$(ecount.popup.parent).unbind("resize.ep")},render:function(){this.setInitData();this.template=ecount.widget.replaceAttr(this.template,{css:this.css});ecount.layout.prototype.render.apply(this,arguments);this.$menu=this.$el.filter("div.wrapper-widget-list");this.$body=this.$el.filter("div.grid-stack");this.menuTitles&&this.createMenuTitle(this.menuTitles);this.menuLists&&this.createMenuList(this.menuLists);!$.isNull(this.items)&&this.items.length>0&&this.createBody(this.items);this._bindEvent();this.ecTransaction.start();this._width&&this.$el.css("width",this._width)},_ON_DROPDOWN_CLICK:function(n){var u=this.$body.data("gridstack"),t=this.getEpControl(n.targetID),i=t.$el.data("_gridstack_node"),r,f;switch(n.type){case"epDelete":for(r=0,f=this.itemList.length;r<f;r++)if(t=this.itemList[r],t.id==n.targetID){this.callAPI("/Service/EP/DeleteCowgEpUserset",{WIDGET_SEQ:t.id});this.itemList.splice(r,1);u.removeWidget(t.$el);this.epMaxCount[t.controlType]--;this.epMaxCount.TOTAL--;break}break;case"epFold":t.epData.collapsed==!0?(t.epData.originHeight=t.epData.height,u.grid.moveNode(i,i.x,i.y,i.width,1),t.$el.find(".panel-body").addClass("hidden")):(t.$el.find(".panel-body").removeClass("hidden"),u.grid.moveNode(i,i.x,i.y,i.width,Number(t.epData.originHeight)));this.callAPI("/Service/EP/UpdateCowgEpUserset",{WIDGET_SEQ:t.id,EXPANDED:!t.getData().collapsed})}},setInitData:function(){var t=ecount.global.findViewBag(this.ecPageID),r=t.InitDatas["epData.widgetData"],i,u,n;for(this.epMaxCount={TOTAL:0},this.allowedObj={},this.menuTitles=t.InitDatas["epData.menuTitles"],this.menuLists=t.InitDatas["epData.menuLists"],this.isLocked=t.InitDatas["epData.isLocked"],this.masterInfo=t.InitDatas["epData.memoSign"]||{},this.userID=t.InitDatas.USERID||"",i=0,u=r.length;i<u;i++)n=r[i],$.extend(n.options,{originHeight:r[i].options.height}),this.items.push(widget.generator.control().define(n.controltype,n.seq,n.seq).setOptions({epData:n.options}).end()),this.epMaxCount[n.controltype]++},initGridstack:function(){var n={handleClass:"panel-heading",cancelClass:"btn-group, .next, .previous",vertical_margin:10,cell_blockSize:50,width:50,resizable:{handles:"e, se, s, sw, w"},acceptWidgets:".widget-list-body ul li ul li",beforeMoveCallback:this.ON_START_MOVING.bind(this),afterMoveCallback:this.ON_END_MOVING.bind(this),afterListDropCallback:this.ON_LIST_DROP.bind(this),disableDrag:this.isLocked,disableResize:this.isLocked,getFrameHeight:function(){return $(ecount.runtime.root.document).find("div.wrapper-frame-body").outerHeight()}};this.$body.gridstack(n)},createMenuTitle:function(n){for(var t,r=[],i=0,u=n.length;i<u;i++)t=n[i],r.push(["<li>",'<span class="widget-list-title" data-value="collapseTitle" data-function="click">',t.label,"<\/span>",'<ul title-id="'+t.id+'"><\/ul>',"<\/li>"].join(""));this.menuTemplate=ecount.widget.replaceAttr(this.menuTemplate,{menuTitle:r.join("")});this.$menu.append($(this.menuTemplate))},createMenuList:function(n){for(var r=0,u=n.length;r<u;r++){var t=n[r],f=this.$menu.find("ul[title-id="+t.titleID+"]"),i=$('<li class="ui-draggable ui-draggable-handle" control-type="'+($.isNull(t.controlType)?"":t.controlType.split(".").pop())+'" ep-type="'+t.id+'" allowed="'+t.allowed+'" term-type="'+t.termType+'" prg-id = "'+t.prgId+'">'+t.label+"<\/li>");t.allowed===!1&&(i.addClass("disabled"),i.attr("data-value","notAllowed"),i.attr("data-function","click"),bootstrapFunc.tooltip.call(i,{container:"body",placement:"top",html:!0,trigger:"hover",title:ecount.resource.MSG10837,delay:{show:ecount.common.mouseHoverInTime,hide:ecount.common.mouseHoverOutTime}}));f.append(i)}},createBody:function(n,t){for(var r,f,i=0,u=n.length;i<u;i++)ecount.control.initializeByUserSetting(this.initializer,n[i]),ecount.widget.createDisplayID(n[i],"btn",this.__target),n[i].controlType=="widget.ep.schedule"&&(n[i]._container=this.$el.parent().parent()),f=ecount.common.createNamespace(n[i].controlType),r=new f(n[i]),this._setControlOptions(r),this.itemList.push(r),r.render(t?t:this.$body)},_setControlOptions:function(n){n.__pnode=this.__type;n.controlType==="widget.custom"&&(n.__target=this.__target);n.ecPageID=this.ecPageID;n.__type=widget.generator.CONTROL;n.pId=this.tabId;n.gridID="";n.tabID=this.tabId;n.ecTransaction=this.ecTransaction;n.delegator=this.delegator;n.containerDelegator=this.events},_bindEvent:function(){function n(n){return"ON_CLICK_"+n.toUpperCase()}this.$el.on("mousedown",function(n){this.$el.find(".show")[0]!==n.target.parentElement.parentElement&&this.$el.find(".show").hasClass("dropdown-menu")&&this.$el.find(".show").removeClass("show");var r=window.__EC_SCROLL_SIZE,t=n.target||n.srcElement,i=$(t).find("table").length==1?$(t).find("table"):$(t).find("div").first(),u=Number($(t).css("width").replace("px","")),f=Number($(t).css("height").replace("px","")),e=n.offsetX,o=i.length>0&&Number(i.css("height").replace("px","")),s=n.offsetY,h=i.length>0&&Number(i.css("width").replace("px",""));if($(t).hasClass("panel-body")&&o>f&&u-e<r||h>u&&f-s<r){$(t).parents(".grid-stack-item").trigger("mouseup");n.preventDefault();n.stopPropagation();return}}.bind(this));this.$el.on("click",'[data-function="click"]',function(t){var i=t.target||t.srcElement,r,u;$.isNull(i.getAttribute("data-function"))&&(i=t.currentTarget);r=$(i).parents("div.grid-stack-item.ui-draggable").attr("ep-id");u=this.getEpControl(r)||this;this.isLocked===!0&&i.getAttribute("data-value").toUpperCase()=="OPTION"||(u[n(i.getAttribute("data-value"))](i,t),t.preventDefault());t.stopPropagation()}.bind(this));this.$el.on("mouseover","[data-over]",function(n){var t=n.target||n.srcElement,i=$(t).parents("div.grid-stack-item.ui-draggable").attr("ep-id"),r=this.getEpControl(i)||this;i&&(r.ON_MOUSEOVER&&r.ON_MOUSEOVER(t,n),n.preventDefault());n.stopPropagation()}.bind(this));this.$menu.find("div.widget-list-body > ul > li > ul > li").draggable({helper:"clone",scroll:!0,appendTo:"body",start:function(){this.$menu.removeClass("show")}.bind(this),stop:function(){this.$menu.addClass("show")}.bind(this)});this.isLocked===!0&&this.$menu.hide()},ON_CLICK_RESET:function(){this.delegator&&this.delegator.triggerEvent("button.click",{targetID:"btn-widget-reset"})},ON_CLICK_TOGGLEMENU:function(){this.$menu.toggleClass("show")},ON_CLICK_COLLAPSETITLE:function(n){$(n).parent().toggleClass("widget-list-collapsed")},ON_CLICK_NOTALLOWED:function(n){var t=this;ecount.confirm(ecount.resource.MSG05158,function(i){if(i==!0){var r={width:"450",height:"400",Request:{Data:{RQST_TYPCD:"M",InsertData:[{RQST_TGT_ID:$(n).attr("prg-id"),MenuName:$(n).text(),PermitAction:ecount.resource.LBL21020,ATHT_CD:"AC001"}]}},responseID:t.callbackID,__ecPageID:t.ecPageID,WIDGET_ID:$(n).attr("ep-type"),masterInfo_ID:t.masterInfo.ID||"",masterInfo_Name:t.masterInfo.UNAME||"",epMenu:$(n).text()},u={url:"/ECERP/SVC/EMM/EMM016P_02",name:ecount.resource.LBL40237,param:r,alreadyIncludedLayout:!0,isOnlyCloseBtn:!0,additional:!0};t.openPopup(u,function(){for(var r=null,u="widget.ep."+$(n).attr("control-type"),i=0,f=t.itemList.length;i<f;i++)item=t.itemList[i],u==item.controlType&&(r=item,r.$el.find("div.panel-body").empty().append(ecount.resource.LBL12940))})}else return!1})},onMessageHandler:function(n,t){switch(n.pageID){case"EMM016P_02":t.callback&&t.callback()}},ON_START_MOVING:function(n){if(n&&n[0]){var t=this.getEpControl(n[0].getAttribute("ep-id")||"");if(t)switch(t.controlType){case"widget.ep.schedule":t.clearPopover()}}},ON_END_MOVING:function(n){var t=$(n),i=null,u,e,f,s,o,r,h;for(this.itemList.forEach(function(n,r){n.name===t.attr("ep-id")&&(i=r)}),!t.find(".panel").hasClass("panel-collapsed")&&t.attr("data-gs-height")<=2&&(t.attr("data-gs-height",1),t.find(".calendar-date").length>0?t.attr("data-gs-originheight",7):t.attr("data-gs-originheight",4),i!==null&&this.itemList[i].ON_CLICK_TITLEFOLDING(n)),t.find(".panel").hasClass("panel-collapsed")&&t.attr("data-gs-height")>=2&&(u=t.attr("data-gs-height"),u<=2?t.find(".calendar-date").length>0?(this.itemList[i].epData.originHeight=7,u=7):(this.itemList[i].epData.originHeight=4,u=4):this.itemList[i].epData.originHeight=u,t.attr("data-gs-originheight",u),i!==null&&this.itemList[i].ON_CLICK_TITLEFOLDING(n)),t.find(".panel").hasClass("panel-collapsed")&&t.attr("data-gs-height")==1&&t.attr("data-gs-originheight",this.itemList[i].epData.originHeight),e=[],f=0,s=this.itemList.length;f<s;f++)o=this.itemList[f],r=o.getData(),e.push({WIDGET_SEQ:o.id,WIDGET_ID:r.epType,EditFlag:r.EditFlag||"M",WIDTH:r.width,HEIGHT:r.originHeight,X:r.left,Y:r.top,TITLE:r.header.title,TERM_TYPE:r.termType});h={Request:{Data:{dataList:e}}};this.callAPI("/SVC/Service/EP/SaveBatchCowgEpUserset",h,function(n){var t=this.getEpControl("-1");$.isNull(t)||t.callBodyApi(n.toString())}.bind(this))},ON_LIST_DROP:function(n,t){return new Promise(function(i){function r(r){var u=[],f=n.attr("control-type"),e=n.attr("ep-type"),s={header:{title:n.text()||""},collapsed:!1,allowed:r,epType:e,termType:n.attr("term-type"),width:t.width,height:t.height,left:t.x,top:t.y,EditFlag:"I"},o=!1,h={Request:{Data:{WIDGET_ID:e}}};this.callAPI("/SVC/Service/EP/CheckMaxCountCowgEpUserset",h,function(n){n.TOTAL>=15?ecount.alert(ecount.resource.MSG07380):n.WIDGET_ID>=this.getEpMaxCount(f)?ecount.alert(this.maxCountMsg):(u.push(widget.generator.control().define("widget.ep."+f,"-1","-1").setOptions({epData:s}).end()),this.createBody(u),this.ON_END_MOVING(),o=this.itemList[this.itemList.length-1].$el);i(o)}.bind(this))}this.getAllowPermit(n.attr("prg-id"),r.bind(this))}.bind(this))},callAPI:function(n,t,i,r){var u;$.isArray(t)||typeof t!="object"||(u=this.getEpControl(t.WIDGET_SEQ));ecount.common.api({ecPageID:this.ecPageID,isGMC:r,url:n,data:Object.toJSON(t),success:function(n){i&&i(n.Data)},error:function(){$.isNull(this.controlType)||this.hideLoadingbar()}.bind(u)})},openPopup:function(n,t){n.controlCallBack=t.bind(this);ecount.popup.openWindow(n)},reloadEpControl:function(n){for(var i,t,u=$.isNull(n)?this._redrawControlType:$.isString(n)?n:n.controlType,f=$.isNull(n)?this._redrawTargetID:$.isString(n)?n:n.targetID,r=0,e=this.itemList.length;r<e;r++)t=this.itemList[r],u==t.controlType&&t.id==f&&(i=$.extend({WIDGET_SEQ:t.id,IsIncludeEPInfo:!0},t.epData.param,t._searchApiParam),t._searchApiURL.toLowerCase().indexOf("/svc/")!=-1&&(i={Request:{Data:i}}),ecount.common.api({ecPageID:this.ecPageID,url:t._searchApiURL,data:Object.toJSON(i),success:function(n){n.Status!="200"?ecount.alert(n.fullErrorMsg):n.Data?this.setBodyByApi&&this.setBodyByApi.call(this,n.Data,!0):(this.hideLoadingbar(),this.showErrorNotice(!0,"noEpWidget"))}.bind(t),error:function(n,t,i){this.hideLoadingbar();this.showErrorNotice(!0,t,i)}.bind(t),timeout:t.getTimeoutOption(t.controlType).time}))},setRedrawControlType:function(n){n.popupType==!1&&(this._redrawControlType=n.controlType,this._redrawTargetID=n.targetID)},getEpControl:function(n){for(var r=null,t,i=0,u=this.itemList.length;i<u;i++)if(t=this.itemList[i],n==t.id){r=t;break}return r},getEpMaxCount:function(n){var t;return n==="ecTaxError"?(t=1,this.maxCountMsg=ecount.resource.MSG07402):["tutorial","messageBox","upgradeDetails","training","flowChart"].contains(n)?(t=1,this.maxCountMsg=ecount.resource.MSG10831):(t=4,this.maxCountMsg=ecount.resource.MSG07379),t},onLoadComplete:function(){var n={target:this.__target,type:this.__type,__self:this};this.containerDelegator?this.containerDelegator.triggerEvent("item.onload",n):this.delegator&&this.delegator.triggerEvent("item.onload",n);this.initGridstack()},getAllowPermit:function(n,t){var i=this;$.isEmpty(n)?t&&t(!0):ecount.common.api({url:"/ECAPI/SVC/SelfCustomize/Permit/AuthorityCheckByType",ecPageID:i.ecPageID,data:{Request:{PRG_ID:n}},success:function(n){if($.isEmpty(n.Data))t&&t(!0);else{var i=n.Data.where(function(n){return n.AUTH_TF==!1}).select(function(n){return n.PRG_ID});$.isEmpty(i)?t&&t(!0):t&&t(!1)}}})}},create:function(){var n=$.extend({},this.prop);ecount.layout.ep=$.Class(ecount.layout,n)}}};ecount.class("ecount.control","ecount.widget",{initOptions:null,_IT_SELF:ecount.constValue.CONTROL_UPDATE_IT_SELF,_ALL_COMP:ecount.constValue.CONTROL_UPDATE_ALL_COMPONENT,_INIT_VALUE:ecount.delimiter,_during_input_event:!1,__viewOptions:null,onTransaction:!1,__state:null,_setDefaultPlaceholder:!1,_serializeCustomizer:null,_savedValue:null,__originData:null,_defaultCss:null,_clickDelayTime:700,_isCombinedControl:!1,_allowToggleLayer:!0,_useNumericRequired:!1,_isPositiveInteger:!1,_showZeroInPoint:!1,_delegatorQueue:null,_preventDelegatorExecution:!1,_preventSync:!1,_preventObservingStateChange:!1,_preventLayerOpenByHover:!1,_gridDelegatorOption:null,_usingIMEComosingInput:!1,useAsyncFocusChange:!1,_useResetData:!1,hasCarretButton:!1,hasFn:undefined,_timeoutNo:null,init:function(n){var t=this.getInitData(n);this._initializeClearOptions(n);this._initializeOptions(n,t);this._initializeAdditionalOption(n);this._initializeState(n,t);this._onInitState(t,this.__state,n);this.onInitComponents(t,this.__state,n);this.onInitFunctions(t,this.__state,n);this._clearViewOptions();this.extractData&&this._onInitExtractData(t,this.__state,n);this._onInitFilters(t,this.__state,n);this.isInGrid()&&this.initializeGridOptions(n,t);this._initializeViewOptions(n,t);this._onAfterInitialize();ecount.runtime.notify(ECountEvent.Type.INITIALIZED_WIDGET,null,{ecPageID:this.ecPageID,controlType:n.controlType})},render:function(n){!this.__HEADLESS&&this.onBeforeRender()?this.attachView(n):this._$parent=n;this.onLoadItems()},_onLazyRender:function(){this.onLazyRender();this.setBorderRadius()},setBorderRadius:function(){this.ecview&&this.ecview.$el&&this.ecview.setBorderRadius&&this.ecview.setBorderRadius()},onLazyRender:function(){},attachView:function(n){this.ecview||this.createView();this.renderView(n||this._$parent);this.__HEADLESS=!1;this._onAfterRender()},getComposedDomString:function(){return this.ecview||this.createView(),this.ecview.getComposedDomString(_.merge({},this.__state,this.__viewOptions))},destroyView:function(){this.ecview&&this.ecview.destroyView()},destroy:function(){this.unregister();this.ecview&&(this.ecview.destroy(),this.ecview=null)},unregister:function(){this.__viewOptions=null;ecount.layer.removeLayer(this.getLayerServiceKey(this));this.ecIKey&&ecount.global.removeEcInstance(this.ecIKey,this.containerName);this.ecIKey=null},getInitData:function(n){var t=ecount.control.getInitData(n.baseControlType||n.controlType,n.inIncludePage,n.ecPageID);return n.customInitData&&(n.customInitData.config&&(t.config=n.customInitData.config),n.customInitData.result&&(t.result=n.customInitData.result)),t},_initializeClearOptions:function(){this.hasFn===!0&&(this.hasFn=undefined,this.isFnbuttonDisable=undefined,this.dropdownOptions=[],this._caretDropdownList=[],this.onClickCaret=undefined,this.onClickCaretDropdownList=undefined,this.hasCarretButton=!1,this.fnOptions={});this.maxLength=null;this.__filter=null;this.__prettyFilter=null},_initializeOptions:function(n,t){var i=n.id||ecount.common.uuid(n.controlType||widget.generator.CONTROL);if(_.merge(this,{__originData:{},data:n.data||[],extractData:n.extractData,cid:i,id:i,isFromCS:!!n.isFromCS,useFavoriteCode:!!n.isFromFavoriteCode,isFromFavoriteCode:!!n.isFromFavoriteCode,useRecommendOption:!!n.useRecommendOption,originControlID:n.originControlID,pcid:n.pcid,ccIndex:n.ccIndex,ppcid:n.ppcid,findex:n.findex,subTitle:n.subTitle,groupId:n.groupId,pSubTitle:n.pSubTitle,formGroupId:n.formGroupId,formGroupName:n.formGroupName,name:n.name,controlType:n.controlType,ecPageID:n.ecPageID,initOptions:n.initOptions,containerDelegator:n.containerDelegator,delegator:n.delegator,executeParentChangeDelegator:n.executeParentChangeDelegator,responseID:n.responseID,containerName:n.containerName,panelID:n.panelID,tabId:n.tabId||"",tabID:n.tabID||n.tabId||"",pId:n.tabID||n.tabId||"",__pnode:n.__pnode,rowKey:n.rowKey,controlEvent:n.controlEvent,wType:n.__type,__type:n.__type,_callback:n._callback,OBSERVE_CHANGE_STATE:n.OBSERVE_CHANGE_STATE,inlineIndex:n.inlineIndex,changeStateFuncName:n.changeStateFuncName,useWrapperSet:n.useWrapperSet,__HEADLESS:n.__HEADLESS,strCase:n.strCase,_errPlacement:n.gridID?"auto":n._errPlacement,_focusPopover:n._focusPopover,_focusPopoverMsg:n._focusPopoverMsg,_tooltip:n._tooltip,alignRight:n.alignRight,maxLength:n.maxLength,_executeValidateIfVisible:n._executeValidateIfVisible,_useUnloadEventCallback:n._useUnloadEventCallback,formset:n.formset,searchItemCode:n.searchItemCode,__eventTargetInstanceEcIKey:n.__eventTargetInstanceEcIKey,suffixIndex:n.suffixIndex,_isController:n._isController,_controllerOption:n._controllerOption,mappingPath:n.mappingPath,searchDateName:n.searchDateName,_delegatorQueue:[],transaction:[],popupID:n.popupID,popupLevel:n.popupLevel,popupType:n.popupType,modal:n._modal,_inline:n._inline,_multiLine:n._multiLine,_userCss:n.css,inlineStyle:n.inlineStyle,isWholeRow:n.isWholeRow,_defaultOptions:n._defaultOptions,hasFn:n.hasFn,dropdownOptions:this._setDropdownControls(n.dropdownOptions),isSetDropdownSize:n.isSetDropdownSize,_caretDropdownList:this._setDropdownControls(n._caretDropdownList),onClickCaret:n.onClickCaret,onClickCaretDropdownList:n.onClickCaretDropdownList,hasCarretButton:n.hasCarretButton===undefined?this.hasCarretButton:n.hasCarretButton,fnOptions:n.fnOptions||{},extendFnOptions:n.extendFnOptions||{},isNotFixedLayer:n.isNotFixedLayer||!1,prgId:n.prgId,wigt_dv_cd:n.wigt_dv_cd,subLabel:n.subLabel||this.subLabel,dualMode:n.dualMode,dualStep:n.dualStep,dualModeMaster:n.dualModeMaster,dualPageType:n.dualPageType,dualStepButtonInfo:n.dualStepButtonInfo,serializeDualStep:n.serializeDualStep,isCustomDualControl:n.isCustomDualControl,isCustomDualAddedControl:n.isCustomDualAddedControl,useIndividual:n.useIndividual,dualControls:n.dualControls,dualLabel:n.dualLabel,enableSerialzeOnVisible:n.enableSerialzeOnVisible,noSerialize:n.noSerialize,activeInlineMode:n.fixedMode?n.fixedMode:n.activeInlineMode,inlineModeList:n.inlineModeList,fixedMode:n.fixedMode,addPopupOpenParam:n.addPopupOpenParam||this.addPopupOpenParam,numericOnly:n.numericOnly,_numericOptions:{type:"numericOnly",options:{numericMsg:n.numericMsg,numericRange:n.numericRange,numericPattern:n.numericPattern,useNumericRequired:$.isNull(n._useNumericRequired)?this._useNumericRequired:n._useNumericRequired,isPositiveInteger:$.isNull(n._isPositiveInteger)?this._isPositiveInteger:n._isPositiveInteger,showZeroInPoint:$.isNull(n._showZeroInPoint)?this._showZeroInPoint:n._showZeroInPoint,showValueZero:n._showValueZero,DEC_SEPARATOR:n.DEC_SEPARATOR,THOU_SEPARATOR:n.THOU_SEPARATOR,numericViewType:n.numericViewType||"round",numericViewKeepOrigin:_.isBoolean(n.numericViewKeepOrigin)?n.numericViewKeepOrigin:n.gridID?!1:!0}},_noReplacement:n._noReplacement,dataRules:n.dataRules,dataRulesMsg:n.dataRulesMsg,__filter:n.__filter||[],__prettyFilter:_.isArray(n.__prettyFilter)&&n.__prettyFilter.length>0?n.__prettyFilter:null,isRequired:n.isRequired==undefined?this.isRequired:n.isRequired,gridID:n.gridID||"",gridDataKey:n.gridDataKey,gridColumnID:n.gridColumnID,gridDetailTableID:n.gridDetailTableID,gridSectionType:n.gridSectionType,gridControlArea:n.gridControlArea,isGridV3:n.isGridV3,rowIdx:n.rowIdx,_ontarget:n.gridID&&!n.pcid?"grid":undefined,isHideCell:n.isHideCell,isMultiCell:n.isMultiCell,cellSize:n.cellSize,hideCellTitle:n.hideCellTitle,_hideRow:n._hideRow,_useCommonSerialize:n._useCommonSerialize,_serializeByCustomKey:n._serializeByCustomKey,_serializeByAll:n._serializeByAll,_extractFormat:n._extractFormat,_serializeCustomizer:n._serializeCustomizer,_serializeAdditionalDataCustomizer:n._serializeAdditionalDataCustomizer,absoluteIdxTable:n.absoluteIdxTable,rowIdxTable:n.rowIdxTable,columnIdxTable:n.columnIdxTable,_useTableRowIndex:n._useTableRowIndex,_makeCommand:n._makeCommand,isChangeEventPostpone:n.isChangeEventPostpone,simpleSearchConfig:n.simpleSearchConfig,customInitData:n.customInitData,__handler:n.__handler,fnDynamicView:n.fnDynamicView===undefined?!0:n.fnDynamicView,fnAlwaysShow:n.fnAlwaysShow||!1,setGridViewEmpty:n.setGridViewEmpty||!1,_preventSync:n._preventSync||this._preventSync,useFocusHandler:n.useFocusHandler,_afterViewChange:n._afterViewChange,isNotUseItemFold:!!n.isNotUseItemFold,_getCustomFoldLayerValue:n._getCustomFoldLayerValue}),(n._treeAll||n._treeParent||n._treeType||n._treeChildren||n._treeOpen||n._treeIndent)&&_.merge(this,{_treeAll:n._treeAll,_treeParent:n._treeParent,_treeType:n._treeType,_treeChildren:n._treeChildren,_treeOpen:n._treeOpen,_treeIndent:n._treeIndent}),n.__direction&&(this.__direction=n.__direction),this.callbackID=n.callbackID||ecount.global.registerCallback(this.ecPageID,this.onMessage,this),this.setEcPath(),this.setEcIKey(),n.initOptions){ecount.runtime.notify(ECountEvent.Type.WRITE_LOG,null,{type:"options.initOptions",ecPageID:this.ecPageID,popupLevel:this.popupLevel,controlType:this.controlType,cid:this.id,initOptions:n.initOptions});this.onInitControlOptions(n.initOptions,t)}this.initializeOptions(n,t);this.formset&&this.setControlByFormset(this.formset);this.setNumberSeparator(n,t);this.numericOnly&&this.__filter.some(function(n){return n.type===this._numericOptions.type}.bind(this))!=!0&&this.__filter.push(this._numericOptions)},onInitControlOptions:function(){},getEcPath:function(){return this.ecPath},setEcPath:function(){this.ecPath=[this.ecPageID,this.containerName,this.tabID,"",this.gridID,this.id,this.pcid].join(ecount.separator.ecPath)},getEcIKey:function(){return this.ecIKey},setEcIKey:function(){this.ecIKey=ecount.global.registerEcInstance(this)},getFormset:function(){return _.cloneDeep(this.formset)},setNumberSeparator:function(n){var t=this._numericOptions.options;if(n._customSeparator||$.isNull(ecount.config.company))return!1;this.gridID&&(t.DEC_SEPARATOR=this.DEC_SEPARATOR||ecount.config.company.DEC_SEPARATOR,t.THOU_SEPARATOR=this.THOU_SEPARATOR||ecount.config.company.THOU_SEPARATOR);this.formset?(t.DEC_SEPARATOR=this.formset.decimalSeparator||ecount.config.company.DEC_SEPARATOR,t.THOU_SEPARATOR=this.formset.thousandSeparator||ecount.config.company.THOU_SEPARATOR):(t.DEC_SEPARATOR=ecount.config.company.DEC_SEPARATOR,t.THOU_SEPARATOR=ecount.config.company.THOU_SEPARATOR)},setControlByFormset:function(n){function r(n){var i=n.dataType.toString(),e=n.defaultVal||"",f={Q:ecount.config.inventory.DEC_Q||0,U:ecount.config.inventory.ETC_DEC_UQ||0,P:ecount.config.inventory.DEC_P||0,PV:ecount.config.inventory.DEF_PRICE_VAT_DECIMAL_PLACE||0,R:ecount.config.inventory.DEC_RATE||0,D:ecount.config.inventory.DEC_DEFAULT||0,A:ecount.config.company.DEC_AMT||0},r,u;(i[0]==="8"||i[0]==="9")&&(r=Number(i.slice(1,i.length)),u=u||r+ecount.common.number.defaultLength,r==="00"&&(r=f[n.decimalType]),this.numericOnly||(this.numericOnly=!0,t.numericRange=t.numericRange||[u-r,r],t.numericMsg=t.numericMsg||ecount.resource.MSG01396),$.isNull(t.showValueZero)&&(i[0]==="9"?t.showValueZero=!0:i[0]==="8"&&(t.showValueZero=!1)))}function u(n){t.showZeroInPoint=n.isCheckZero}var t=this._numericOptions.options,i;["Q","U","P","PV","R","D","A"].contains(n.decimalType)&&(i=n.dataType,u.call(this,n),r.call(this,n))},_initializeAdditionalOption:function(n){this._setControlOptions(n);this._setDropdownOptions()},_setControlOptions:function(n){if(n&&n.controlOption){ecount.runtime.notify(ECountEvent.Type.WRITE_LOG,null,{type:"options.controlOption",ecPageID:this.ecPageID,popupLevel:this.popupLevel,controlType:this.controlType,cid:this.id,initOptions:n.controlOption});var t=n.controlOption;t=typeof t=="string"?$.parseJSON(t):t;this.addControlOptions(t.addControl)}},addControlOptions:function(){},_setDropdownOptions:function(){if(_.isEmpty(this.extendFnOptions)||_.extend(this.fnOptions,this.extendFnOptions),this.fnOptions.useSimpleSearch&&(this.dropdownOptions=this.getSimpleSearchList().concat(this.dropdownOptions)),_.isArray(this.dropdownOptions)&&$.isEmpty(this.fnOptions.activedId)){var n=this.dropdownOptions.find(function(n){return n.active===!0});n&&(this.fnOptions.activedId=n.id)}},initializeOptions:function(){},initializeGridOptions:function(n){var t=this._getDefaultGridOptions(n),i=this.id;this.callbackID=ecount.global.registerCallback(this.ecPageID,function(n,i){this.onMessage(n,_.extend(i,t))}.bind(this));this.getGridActiveInfo=n.getGridActiveInfo;this.getGridValidateInfo=n.getGridValidateInfo;this.getGridInputMode=n.getGridInputMode;this._getGridCellInfo=function(n,i){_.extend(n,t);i(n)}},_clearViewOptions:function(){this.__viewOptions=null},_getDefaultGridOptions:function(){return{gridID:this.gridID,gridDataKey:this.gridDataKey,gridColumnID:this.gridColumnID,gridSectionType:this.gridSectionType}},_initializeViewOptions:function(n,t){this.__viewOptions=this.__viewOptions||{ecPageID:this.ecPageID,ecPath:this.ecPath,ecIKey:this.ecIKey,id:this.id,cid:this.id,pcid:this.pcid,hasFn:n.hasFn||this.hasFn,subLabel:n.subLabel||this.subLabel,isLayerPopup:this.popupType==="layer",useWrapperSet:this.useWrapperSet,noneFlex:n.noneFlex,wrapperCss:n.wrapperCss,wrapperSetCss:n.wrapperSetCss,inlineStyle:n.inlineStyle,isDummyControl:n.isDummyControl,gridID:this.gridID,isGridV3:n.isGridV3,setGridViewEmpty:n.setGridViewEmpty,_inline:this._inline,isWholeRow:n.isWholeRow,activeInlineMode:this.isInlineMode()};this.initializeViewOptions(n,t)},initializeViewOptions:function(){},_onAfterInitialize:function(){this.onAfterInitialize()},onAfterInitialize:function(){},_initializeState:function(n){function t(n){$.isNull(n)&&(n=!1);$.isArray(n)||(n=[n]);for(var t=0,i=n.length;t<i;t++)if(n[t]!==!0)return!1;return!0}this.__state={id:this.id,cid:this.id,dualModeData:{dualMode:this.dualMode,dualStep:this.dualStep,dualModeMaster:this.dualModeMaster,dualPageType:this.dualPageType,dualStepButtonInfo:this.dualStepButtonInfo,serializeDualStep:this.serializeDualStep,isCustomDualControl:n.isCustomDualControl,isCustomDualAddedControl:n.isCustomDualAddedControl,useIndividual:n.useIndividual,dualControls:n.dualControls,dualLabel:n.dualLabel},"style.inline":n.inlineStyle||this._INIT_VALUE,"style.display":!n.hidden,"style.invisible":n.invisible,"style.addoncss":n._addonOptions?n._addonOptions.css:this._addonOptions?this._addonOptions.css:"","attr.disabled":t(n._readOnly),"wrapper.isFlex":!n.noneFlex,"validate.needvalidate":n.needvalidate||!1,"validate.containstype":n.containsType,"validate.errpreventhide":n.errpreventhide||!1,"validate.datafilter":n._dataFilter,"validate.datarules":n.dataRules,"validate.filters":this.__filter,"validate.datarulesmsg":n.dataRulesMsg,"validate.filterResult":"","popover.type":"popover","popover.message":"","popover.placement":"","popover.directShow":!1,"popover.trigger":"","popover.toggle":!1,"popover.isClearOnBodyClick":!1,"popover.title":"","popover.template":"","popover.unusedbodyclickhandler":!1,"inlineMode.activeInlineMode":n.activeInlineMode,"inlineMode.showLayerFocusIn":n.showLayerFocusIn===!0?!0:!1,"opt.addontitle":$.isNull(n._addonTitle)?this._addonTitle:n._addonTitle,"opt.addontitleOption":n._addonTitleOption,"opt.addontext":n._addonText,"opt.reflowflag":0,"opt.dualStep":n.dualStep,"opt.oldvalue":this._INIT_VALUE,"opt.triggerChange":!1,"opt.lockErrorStatus":!1,"opt.toggledByToolbar":!1}},_onInitState:function(n,t,i){this.__state.components=i.data&&i.data.length>0?this.getInitDataComponents(n,t,i):this.getInitComponents(n,t,i);this.onInitState(n,t,i)},getInitDataComponents:function(n,t,i){return Object.clone(i.data||[],!0)},getInitComponents:function(){return[{}]},getComponentSize:function(){return this.__state.components.length},onInitState:function(){},onInitComponents:function(n,t,i){function o(n,t,i,u,f){var e=f||i[n];r[n]=$.isNull(e)?u:$.isArray(e)?e[t]:e}function s(n,t,i,r){return $.isNull(t[n])?i&&!$.isNull(i[n])?i[n]:r:t[n]}var f,u,e,r;if(!t.components||t.components.length==0)throw ecount.logger.error(String.format("[{1}] of {0} must be overridden.",this.controlType,"onInitComponents"));for(f=t.components,u=0,e=f.length;u<e;u++){r=f[u];r.ecPath=this.ecPath;r.index=u;r.originID=r.id;r.id=r.id||this.id;r.cid=r.cid||this.id;r.name=r.name||this.name||this.id;r["style.inline"]=r["style.inline"]||t["style.inline"]||this.inlineStyle||"";r["style.css"]=[r["style.css"]||"",r.css||this._userCss||this._defaultCss||""].join(" ").trim();r["style.display"]=s("style.display",r,null,!0);r["style.width"]="";o("attr.disabled",u,t,!1,i._readOnly);r["attr.readonly"]=!1;r["css.disabled"]=!1;r["attr.placeholder"]="";r["attr.maxlength"]=$.isArray(this.maxLength)?this.maxLength[u]:this.maxLength;r["opt.selectRange"]=!1;r["opt.notVisible"]=r["opt.notVisible"]||!1;r.ecLazyService=i.isFromFavoriteCode||i.useRecommendOption?"layer.recommenddropdown":"";r.ecServiceAttr=i.isFromFavoriteCode||i.useRecommendOption?ecount.layer.constValue.FOCUSABLE:"";r["attr.inputmode"]=ecount.isMobile?i._inputmode||"text":"";this._pcid&&(r.pcid=this._pcid);u==0&&(r["attr.placeholder"]=$.isEmpty(this.gridID)?$.isEmpty(this.pcid)?i._placeHolder||i.placeHolder||i._addonTitle||i.subTitle||"":i._placeHolder||i.placeHolder||i._addonTitle||"":i._placeHolder||"");this.onInitComponent(n,u,t,r,i)}this.__originData=_.cloneDeep(t)},onInitComponent:function(){},onInitFunctions:function(n,t,i){var r,u,f;t.functions={};i.nationalFlagOptions&&(r=this.getInitNationalFlagProp(i.nationalFlagOptions),r&&(t.functions.nationalFlag=_.merge({cid:this.id},r),r.isFnOption&&(this.hasFn=!0,this.dropdownOptions=_.concat([{id:"_nationalFn",label:ecount.resource.LBL40117||"국가선택"}],this.dropdownOptions))));this.hasFn&&(i._readOnly?(u=!0,f=!1):(u=i.displayFnButton==undefined?!this.fnDynamicView:i.displayFnButton,f=!!this.fnDynamicView),t.functions.fn={cid:this.id,ecFunction:"fn",activedId:this.fnOptions.activedId||"","style.css":i.fnCss||"","style.inline":i.inlineStyle||"","style.display":u,fnDynamicView:f,"attr.disabled":!1});this.subLabel&&(t.functions.sublabel={ecFunction:"label",ecRole:"label.sublabel",label:this.subLabel});this.hasCarretButton&&(t.functions.codeCaretDropdown={cid:this.id,ecFunction:"fn",ecFunctionId:"code.carret",ecService:"layer.caretdropdown","style.display":!0,_caretDropdown:i._caretDropdown,_caretDropdownList:i._caretDropdownList,_caretDropdownOptions:i._caretDropdownOptions});i.addonPopoverOptions&&(t.functions.addonPopover={cid:this.id,ecFunction:"addonPopover",isLeftView:i.addonPopoverOptions.isLeftView||!1,content:i.addonPopoverOptions.content||"",placement:i.addonPopoverOptions.placement||"right",trigger:i.addonPopoverOptions.trigger||"hover click",otherPopoverContainer:i.otherPopoverContainer||null,"style.css":"user-help-mark","function":"addonPopover"});this.isInlineMode()&&_.isEmpty(this.fixedMode)&&(t.functions.selector={cid:this.id,ecFunction:"selector",ecPath:this.ecPath,ecService:"layer.selector",insertWrapper:!0,"style.display":t["inlineMode.showLayerFocusIn"]});!i.itemExcepted||(t.functions.excepted={cid:this.id,isLeftView:!0,"style.css":"excepted-mark","style.display":this.fnOptions.activedId==="NotContain"?!0:!1,"function":"excepted"});this.onInitFunction(n,t,i);this.__originData.functions=_.cloneDeep(t.functions)},getInitNationalFlagProp:function(n){if(!_.isPlainObject(n)||_.isNil(n))return null;var i=_.lowerCase(n.nationalCode)||_.lowerCase(ecount.company.STATE_CODE),t=_.get(n,"isDisplay",!0),r=_.get(n,"isIconHide",!1),u=_.get(n,"isMyCountryHidden",!0),e=_.get(n,"isLeftView",!0),f=_.get(n,"isFnOption",!1),o=f?!0:_.get(n,"isClickPopup",!1),s=_.get(n,"isFnUseOnReadOnly",!1);return u&&t&&(t=_.lowerCase(_.get(ecount,"company.STATE_CODE"))===i?!1:t),r&&(t=!1),{"style.css":"country-flag","style.display":t,isIconHide:r,isMyCountryHidden:u,isLeftView:e,isFnOption:f,isClickPopup:o,isFnUseOnReadOnly:s,nationalFlagBaseUrl:"/static/contents/images/country-flag/",nationalCode:i,ecFunction:"nationalFlag","function":"nationalFlag"}},onInitFunction:function(){},_onInitExtractData:function(n,t,i){this.__state=_.cloneDeep(this.extractData.__state);this.__viewOptions=_.extend({},this.extractData.__viewOptions,{ecPageID:this.ecPageID,ecPath:this.ecPath,ecIKey:this.ecIKey});this._onInitExtractComponent(n,this.__state,i)},_onInitExtractComponent:function(n,t,i){var f,r,u;i.data&&i.data.length>0&&(f=this.__originData.components,t.components.forEach(function(n,t){r=f[t];n.value=$.isNull(r.value)?n.value:r.value;n["attr.checked"]=$.isNull(r["attr.checked"])?n["attr.checked"]:r["attr.checked"]}.bind(this)));for(u in t.dualModeData)this[u]=t.dualModeData[u];t.components.forEach(function(n,t){n.ecPath=this.ecPath;t===0&&(n["attr.placeholder"]=i._placeHolder||i.placeHolder||i._addonTitle||i.subTitle||"")}.bind(this));this.onInitExtractComponent(n,t,i);delete this.extractData;this.__originData=_.cloneDeep(t)},onInitExtractComponent:function(){},_onInitFilters:function(n,t,i){var r=this.getState(this._IT_SELF,"validate.datafilter"),u=this.getState(this._IT_SELF,"validate.datarules"),f=this.getState(this._IT_SELF,"validate.filters")||this.__filter||[];this.clearAllFilters();r&&this.registerDataFilter(r);u&&this.registerValidateFilter(u);f.length>0&&this.registerKeyInputFilter(f);this.onInitFilters(n,this.__state,i)},onInitFilters:function(){},clearAllFilters:function(){["ecDataFilters","ecValidateFilters","ecKeyInputFilters"].forEach(function(n){this[n]=null}.bind(this))},registerDataFilter:function(n){this._registerFilter("ecDataFilters",n)},registerValidateFilter:function(n){this._registerFilter("ecValidateFilters",n)},registerKeyInputFilter:function(n){this._registerFilter("ecKeyInputFilters",n)},_registerFilter:function(n,t){t!=undefined&&t!=null&&($.isArray(t)||(t=[t]),this[n]=this[n]?this[n].filter(function(n){return n.type!=t[0].type}).concat(t):t)},setPrettyFilter:function(n){var t=[];n=_.isArray(n)?n:[n];this.__prettyFilter===null?this.__prettyFilter=n:(n.forEach(function(n){var i=this.__prettyFilter.find(function(t){return t.type==n.type},this);t.push(_.merge({},i,n))},this),this.__prettyFilter=_.uniqBy(_.concat(t,this.__prettyFilter),"type"));this.setConvertPrettyValue()},getPrettyFilter:function(n){if(this.__prettyFilter===null)return null;var t=n?this.__prettyFilter.find(function(t){return t.type===n}):null;return t?[t]:this.__prettyFilter},setConvertPrettyValue:function(){},setConvertUnPrettyValue:function(){},onBeforeRender:function(){return!0},_onAfterRender:function(){this.__renderCompleted=!0;ecount.control.registerLazyRender(this,function(){this._onLazyRender()});this.onAfterRender()},onAfterRender:function(){},onAfterViewChange:function(){_.isFunction(this._afterViewChange)&&this._afterViewChange()},onLoadItems:function(){this.__loadCompleted=!0;this.containerDelegator&&this.containerDelegator.triggerEvent("item.onload",{target:this.containerName,type:this.__type,__self:this})},createView:function(){if(!this.ecPackage)throw ecount.logger.error(String.format("'{0} of {1}' must be defined","ecPackage",this.controlType));var n=this.ecPackage.split(".");return n.splice(2,0,"view"),n=n.join("."),this.ecview=new(ecount.common.createNamespace(n))},renderView:function(n,t){this.ecview.render(_.merge({},t||this.__state,this.__viewOptions),n)},updateViewOptions:function(n){_.extend(this.__viewOptions,n)},updateEcViewWithTransaction:function(n){this.ecview&&(this.putBatchTransaction(_.merge({},n||this.__state)),this.executeTransaction())},notify:function(n,t,i){i=this.getExposableState(i);this.ecview&&(window.__ec_logging_state&&["validate.needvalidate","style.css","style.display","attr.disabled","attr.readonly","css.disabled","opt.selectRange","value","label","selectedValue","selectedLabel"].contains(t)&&ecount.runtime.notify(ECountEvent.Type.WRITE_LOG,null,{type:"change.state",ecPageID:this.ecPageID,popupLevel:this.popupLevel,controlType:this.controlType,cid:this.id,key:n,path:t,state:i}),this.ecview.update.apply(this.ecview,arguments))},notifyToStateObserver:function(n,t,i){this.OBSERVE_CHANGE_STATE&&(this._preventObservingStateChange||this.OBSERVE_CHANGE_STATE({self:this,targetID:this.id,key:n,path:t,state:i}))},_beforeSetState:function(n,t,i,r){t=="value"&&this.setOldValue(r[t])},_setState:function(n,t,i,r){function e(n){return n==this._IT_SELF?this.__state:isNaN(parseInt(n))?this.__state.functions[n]:this.__state.components[n]}var u=!1,f=e.call(this,n);return f&&!$.isNull(f[t])&&(f[t]!==i?(this._beforeSetState(n,t,i,f),f[t]=i,u=r!==!1):u=r===!0),u&&(u=!!(this.isViewUpdateable()&&u),this.OBSERVE_CHANGE_STATE&&($.isEmpty(this.gridID)||t!=="popover.toggle"||(t="popover.alloptions",i=this._getPopoverOptions()),this._preventObservingStateChange||this.OBSERVE_CHANGE_STATE({self:this,targetID:this.id,key:n,path:t,state:i}))),u&&(~t.indexOf("style.")||~t.indexOf("selectedItem"))&&ecount.runtime.notify(ECountEvent.Type.CHANGE_CONTROL_STYLE,null,{handler:ECountEvent.Type.CHANGE_CONTROL_STYLE,cid:this.cid,pcid:this.pcid,key:n,path:t,state:i}),u},getExposableState:function(n){return _.isArray(n)?n=n.map(_.cloneDeep):_.isObject(n)&&(n=_.cloneDeep(n)),n},setState:function(n,t,i,r){if(n==this._ALL_COMP){this.pendingViewUpdate(!0);this.getComponents().forEach(function(n,u){this._setState(u,t,i,r);this.putTransaction(u,t,i)}.bind(this));this.pendingViewUpdate(!1);this.batchUpdateView();return}this.isViewUpdateable()||this.putTransaction(n,t,i);var u=this._setState(n,t,i,r);u&&(this.batchUpdateView(),this.notify(n,t,i))},getState:function(n,t){return n===this._IT_SELF?this.__state[t]:n===this._ALL_COMP?this.__state.components:isNaN(+n)?this.__state.functions[n]?this.__state.functions[n][t]:undefined:this.__state.components[n]?this.__state.components[n][t]:undefined},hasState:function(n,t){var i=null;if(this.__state)if(n===this._IT_SELF)i=this.__state;else{if(n===this._ALL_COMP)return i=this.__state.components,i.some(function(n){return _.hasIn(n,t)});i=isNaN(+n)?this.__state.functions[n]:this.__state.components[n]}else return!1;return _.hasIn(i,t)},putBatchTransaction:function(n,t){var h=Object.keys(n),r,u,o,s,f,c,i,e;for(t===undefined&&(t=this._IT_SELF),f=0,c=h.length;f<c;f++){if(r=h[f],u=n[r],r=="components"){for(i=0,e=u.length;i<e;i++)this.putBatchTransaction(u[i],i);continue}if(r=="functions"){for(o=Object.keys(u),i=0,e=o.length;i<e;i++)s=o[i],this.putBatchTransaction(u[s],s);continue}["ecFunction","cid"].contains(r)||this.putTransaction(t,r,u)}},putTransaction:function(n,t,i){if(this.ecview){var r;this.transaction||(this.transaction=[]);r=_.findIndex(this.transaction,function(i){return i[0]==n&&i[1]==t});~r?this.transaction[r]=[n,t,this.getExposableState(i)]:this.transaction.push([n,t,this.getExposableState(i)])}},executeTransaction:function(){this.transaction&&(this.ecview&&this.ecview.executeTransaction(this.transaction),this.transaction=null)},getAddonTitle:function(){return this.getState(this._IT_SELF,"opt.addontitle")},changeAddonTitle:function(n){this.setState(this._IT_SELF,"opt.addontitle",n)},setNationalFlag:function(n,t){var r,i,u=this.getNationalFlag();u&&(_.isPlainObject(n)?(_.has(n,"nationalCode")&&(r=_.lowerCase(_.get(n,"nationalCode"))),_.has(n,"isDisplay")&&(i=!!n.isDisplay)):_.isString(n)?r=_.lowerCase(n):_.isBoolean(n)&&(i=n),_.isNil(r)||(this.setState("nationalFlag","nationalCode",r),t&&this.executeChangeDelegator(),i!==!0&&this.getState("nationalFlag","isMyCountryHidden")&&(i=_.lowerCase(_.get(ecount,"company.STATE_CODE"))===r?!1:!0)),_.isNil(i)||this.getState("nationalFlag","isIconHide")||this.setState("nationalFlag","style.display",i))},getNationalFlag:function(){return this.getState("nationalFlag","nationalCode")},setExcepted:function(n){this.setState("excepted","style.display",n)},enable:function(){this.show()},disable:function(){this.hide()},readOnly:function(n){_.isUndefined(n)&&(n=!0);this.setReadOnly(n)},_setStateByType:function(n,t,i){if(arguments.length==1)this._setCurrentState(n,_.times(this.getComponents().length),!0),this.setState(this._IT_SELF,n,!0);else if(arguments.length==2)i=arguments[1],this._setCurrentState(n,_.times(this.getComponents().length),i),this.setState(this._IT_SELF,n,i);else{$.isArray(t)||(t=[t]);for(var r=0,u=t.length;r<u;r++)this.getComponent(t[r])&&this.setState(t[r],n,i)}},_setCurrentState:function(n,t,i){for(var r=0,u=t.length;r<u;r++){if(n=="style.display"&&i==!0){this.getState(r,"opt.notVisible")||this.setState(t[r],n,i);continue}this.setState(t[r],n,i)}},_getStateByType:function(n,t){var i;return n===undefined||n===this._ALL_COMP?(i=this.getComponents(),i.filter(t.bind(this)).length==i.length):(i=n===this._IT_SELF?this.__state:this.__state.components[n],!i)?!1:t.call(i,i,n)},_setDisplayState:function(n){var t=this.getComponents().any(function(t){return t["style.display"]!==n});n==!1&&this.getState(this._IT_SELF,"style.display")==!1&&t&&this.setState(this._IT_SELF,"style.display",!0);this.getState(this._IT_SELF,"style.display")===n||t||this.setState(this._IT_SELF,"style.display",n)},_setReadonlyState:function(n){var t=this.getComponents().any(function(t){return t["attr.disabled"]!==n});n!=!0||t?n==!1&&this.getState(this._IT_SELF,"attr.disabled")&&this.setState(this._IT_SELF,"attr.disabled",!1):this.setState(this._IT_SELF,"attr.disabled",!0)},setReadOnly:function(){var n=Array.prototype.slice.call(arguments,0),t;n.unshift("attr.disabled");this._setStateByType.apply(this,n);n.length>2&&(t=n[2],this._setReadonlyState(t))},getComponents:function(){return this.__state?this.__state.components:{}},getFunctions:function(){return this.__state?_.toArray(this.__state.functions):[]},getFunction:function(n){return this.__state.functions[n]},getComponent:function(n){return this.__state.components[n]},getComponentsByAttr:function(n,t){var n=$.isArray(n)?n:[n],t=$.isArray(t)?t:[t];return this.getComponents().filter(function(i){for(var r=0;r<n.length;r++)if(i[n[r]]!==t[r])return!1;return!0})},getComponentByAttr:function(n,t){var n=$.isArray(n)?n:[n],t=$.isArray(t)?t:[t];return this.getComponents().head(function(i){for(var r=0;r<n.length;r++)if(i[n[r]]!==t[r])return!1;return!0})},getVisibleComponents:function(){return this.getComponents().filter(function(n){return n["style.display"]&&!this.isReadOnly(n.index)}.bind(this))},getVisibleComponent:function(n){return this.getVisibleComponents().find(function(t){return t.index==n})},isVisible:function(n){return n===undefined?this.getState(this._IT_SELF,"style.display")&&(this.getComponents().any(function(n){return n["style.display"]})||this.getFunctions().any(function(n){return _.isUndefined(n["style.display"])?!0:n["style.display"]})):this.getState(this._IT_SELF,"style.display")&&this._getStateByType(n,function(n){return n["style.display"]})},isVisibleElement:function(n){return this.ecview&&this.ecview.isVisibleElement(n)},isReadOnly:function(n){return this._getStateByType(n,function(n){return n["attr.disabled"]===!0||n["attr.readonly"]===!0})},hasReadOnlyState:function(n){return this.__state&&(this.isReadOnly(this._IT_SELF)||this.isReadOnly(n))},_isExceptionOfReadOnly:function(){return!1},isCombinedControl:function(){return this._isCombinedControl},isGridCellControl:function(){return!1},setValue:function(){var i,n,r,f=this.getComponents(),t,u;if(arguments.length===1?(i=0,n=$.isNull(arguments[0])?"":arguments[0]):(i=arguments[0],n=$.isNull(arguments[1])?"":arguments[1],r=$.isNull(arguments[2])?!1:arguments[2]),$.isArray(n))for(t=0,u=f.length;t<u;t++)this.setFilteredValueToComponent(n[t],t);else this.setFilteredValueToComponent(n,i);r&&this.executeChangeDelegator()},setStandardValue:function(){this.setValue.apply(this,arguments)},setOldValue:function(n){var t=$.isNull(n)?this.getValue():n;this.setState(this._IT_SELF,"opt.oldvalue",t,!1)},setFilteredValueToComponent:function(n,t){var o=this.getComponent(t),s=this._getContainsType(t),i=this.filteredNumericSeparator(n,o.value),u,f,r,e;if(this._checkContainsType(i,s).length>0)return this.setStateValue(t,i),!1;i=this._applyFilters(i,t);this._during_input_event!=!0&&this.numericOnly&&(this.id=="vat_amt"&&(this.ecPageID.indexOf("EBD010M_30")>=0||this.ecPageID.indexOf("EBD010M_31")>=0)&&(u={showValueZero:!0}),f=/^[-]$/,i=this._numericRTrim(f.test(i)?"":i,u),r=this.isUseOriginVal(t)?this.getState(t,"viewValue"):null,_.isEmpty(r)||(e=this._numericRTrim(f.test(r)?"":r,u),this.setState(t,"viewValue",e,!1)));this.setStateValue(t,i);ecount.constValue.isIE&&n!=i&&this._during_input_event==!0&&this.isSetFilteredValueChangeBlur()&&this.ecview&&this.setEventChangeByBlur(0)},setStateValue:function(n,t){this.setState(n,"value",t)},isUseOriginVal:function(){return!1},setNumericViewType:function(n,t){var u,r,i;if(this.numericOnly&&_.hasIn(this,"_numericOptions.options")&&this.hasState(this._ALL_COMP,"originValue")&&(n=!~_.indexOf(["round","ceil","floor"],n)?"none":n,t=_.isBoolean(t)?t:!1,u=this.ecKeyInputFilters.find(function(n){return n.type==="numericOnly"}),u))for(u.options.numericViewType=n,u.options.numericViewKeepOrigin=t,r=this.getComponents(),i=0;i<r.length;i++)this.setState(r[i].index,"originValue",""),this.setState(r[i].index,"viewValue","",!1),this.setState(r[i].index,"value","")},isSetFilteredValueChangeBlur:function(){return!1},_setNumericFilterdValueToComponent:function(n,t,i,r){if(this.numericOnly){var u=this._numericRTrim(t,{showZeroInPoint:i});(t!=u||r)&&this.setState(n,"value",u,r);this._focusInValue=this._numericRTrim(t)}},_getContainsType:function(){return this.getState(this._IT_SELF,"validate.containstype")},_setContainsType:function(n,t){this.setState(n,"validate.containstype",t)},filteredNumericSeparator:function(n){var t=_.isString(n)?n:n.toString(),i,r;return this.numericOnly&&this._during_input_event!=!0&&(i=this._numericOptions.options,r=i.DEC_SEPARATOR||".",t.length>0&&(t=Number.removeSeparator(t.decimalRTrim()).replaceAll(".",r))),t},isNumericOnlyChangeEventExcute:function(n){return($.browser.msie||navigator.userAgent.toLowerCase().indexOf("wow64")>-1||navigator.userAgent.toLowerCase().test(/windows\s?nt\s?5.1/)&&$.browser.chrome||ecount.isMobile&&ecount.common.isIOS)&&n.indexOf(this._numericOptions.options.THOU_SEPARATOR)>-1},setPlaceHolder:function(n,t){this.setState(t||0,"attr.placeholder",n)},getPlaceHolder:function(n){return this.getState(n||0,"attr.placeholder")},getNumericValue:function(n,t){var r,i;if(!this.numericOnly)return n;if($.isEmpty(n))return"";_.isArray(this.ecKeyInputFilters)&&this.ecKeyInputFilters.length>0&&(i=this.ecKeyInputFilters.find(function(n){return n.type=="numericOnly"}),i&&i.options&&(r={numericViewType:i.options.numericViewType,numericViewKeepOrigin:i.options.numericViewKeepOrigin}));var f=this.getComponent(t||0),e=this.filteredNumericSeparator(n,f.value),o=ecount.convertor.executeFilter(this._numericOptions,e,r),s=o.str,u;return this.id=="vat_amt"&&(this.ecPageID.indexOf("EBD010M_30")>=0||this.ecPageID.indexOf("EBD010M_31")>=0)&&(u={showValueZero:!0}),this._numericRTrim(s,u)},getStandardValue:function(){var n=this.getValue();return $.isArray(n)||(n=[n]),n},getComponentValue:function(n){return this.getValue(n)},getValue:function(){throw String.format("getValue of [{0}] must be overriden.",this.controlType);},getOldValue:function(){return this.getState(this._IT_SELF,"opt.oldvalue")},getResetData:function(){return this.getValue()},getContainerElement:function(){return this.ecview.getElements(null)},getParentContainerBoundary:function(){return this.ecview.getParentContainerBoundary()},getContainerBoundary:function(){return this.ecview.getContainerBoundary()},getComponentBoundary:function(n){return this.ecview.getComponentBoundary(n)},getFunctionBoundary:function(n,t,i){return this.ecview.getFunctionBoundary(n,t,i)},getRoleHolderBoundary:function(n,t,i){return this.ecview.getRoleHolderBoundary(n,t,i)},getCaretBoundary:function(n,t,i){return this.ecview.getCaretBoundary(n,t,i)},getEventTargetInstanceEcIKey:function(){return this.__eventTargetInstanceEcIKey},getAncestorID:function(){return this.ppcid||this.pcid||this.id},set$El:function(n){this.ecview&&this.ecview.set$El(n,this.getEcIKey())},addClass:function(n,t){$.isNull(t)&&(t=n,n=0);var i=this._getAllClass(n,t);this.setState(n,"style.css",i)},addClassAllComponents:function(n){this.getComponents().forEach(function(t){this.addClass(t.index,n)}.bind(this))},removeClass:function(n,t){$.isNull(t)&&(t=n,n=0);var i=this._getAllClass(n);this.setState(n,"style.css",ecount.convertor.removeClass(i,t))},removeClassAllComponents:function(n){this.getComponents().forEach(function(t){this.removeClass(t.index,n)}.bind(this))},changeInlineStyle:function(n,t){$.isNull(t)&&(t=n,n=0);this.setState(n,"style.inline",t)},changeWidth:function(n,t){$.isNull(t)&&(t=n,n=0);this.setState(n,"style.width",t)},changeWrapperFlex:function(n){this.setState(this._IT_SELF,"wrapper.isFlex",!!n)},changeSubLabel:function(n){if(arguments.length==1){var t=arguments;n=t[0];cindex=0}this.setState("sublabel","label",n)},isDualMode:function(){return this.dualMode},checkCustomDualAddedControl:function(){return!!this.isCustomDualAddedControl},getDualStep:function(){return this.getState(this._IT_SELF,"opt.dualStep")},getDualModeStep:function(){return this.getDualStep()},getDualMode:function(){return this.getDualStep()},setDualStep:function(n,t,i){(i==!0||this.getDualStep()!==n)&&(this.setState(this._IT_SELF,"opt.dualStep",n),this.dualStep=n,this.delegator&&t!==!0&&this.delegator.triggerEvent("dualMode.changeDualMode",{cid:this.id,dualStep:n}))},changeSubTitleByDualStep:function(n){this.delegator&&this.delegator.triggerEvent("dualMode.changeSubTitle",{cid:this.id,dualStep:n})},isInlineMode:function(){return!this.isCombinedControl()&&!!this.getActiveInlineMode()},isSingleInlineMode:function(n){return this.isInlineMode()&&(n||this.getActiveInlineMode())==this.inlineModeList[0].mode},getActiveInlineMode:function(){return this.__state&&this.getState(this._IT_SELF,"inlineMode.activeInlineMode")},setActiveInlineMode:function(n,t){if(_.isEmpty(this.fixedMode)){var i=this.inlineModeList.find(function(t){return t.mode==n});this.setState(this._IT_SELF,"inlineMode.activeInlineMode",n);i&&this.changeSubTitle(i.layerLabel);t!=!1&&this.delegator&&this.delegator.triggerEvent("form.sync",{cid:this.id,syncHandler:this.setActiveInlineMode,__self:this,preventTriggerEvent:!0,args:[n,!1]})}},changeSubTitle:function(n){this.delegator&&this.delegator.triggerEvent("form.changeSubTitle",{cid:this.getAncestorID(),title:n})},hide:function(){if(arguments.length==0)this.setState(this._IT_SELF,"style.display",!1);else{var n=Array.prototype.slice.call(arguments,0);n.unshift("style.display");n.push(!1);this._setStateByType.apply(this,n);this._setDisplayState(!1)}},show:function(){if(arguments.length==0)this.setState(this._IT_SELF,"style.display",!0);else{var n=Array.prototype.slice.call(arguments,0);n.unshift("style.display");n.push(!0);this._setStateByType.apply(this,n);this._setDisplayState(!0)}},setNotUseItemFold:function(n){this.isNotUseItemFold=n===!1?!1:!0},disabled:function(n){this.setState(this._ALL_COMP,"attr.disabled",n);this.setState(this._ALL_COMP,"css.disabled",n)},setDisabled:function(n){this.setState(this._ALL_COMP,"attr.disabled",n)},toggle:function(n){_.isBoolean(n)||(n=!this.isVisible());n==!0?this.show():this.hide()},isViewUpdateable:function(){return!this.onTransaction},pendingViewUpdate:function(n){this.onTransaction=n},batchUpdateView:function(){this.isViewUpdateable()&&this.ecview&&this.executeTransaction()},disableDelegatorExecution:function(){this._preventDelegatorExecution=!0},enableDelegatorExecution:function(){this._preventDelegatorExecution=!1},executeDelegatorQueue:function(){for(var t=this.getGridDelegatorOption(),n;this._delegatorQueue.length;)n=this._delegatorQueue.shift(),this.gridID&&t?this.executeChangeDelegator(_.extend(n,t)):this.executeChangeDelegator(n)},executeTabSync:function(){this.delegator&&this.delegator.triggerEvent("form.sync",this._getDefaultDelegatorInfo())},setGridDelegatorOption:function(n){this._gridDelegatorOption=n},getGridDelegatorOption:function(){return _.cloneDeep(this._gridDelegatorOption)},removeGridDelegatorOption:function(){this._gridDelegatorOption=null},isAbleToExecuteDelegator:function(){return!this._preventDelegatorExecution},disableTabSync:function(){this._preventSync=!0},enableTabSync:function(){this._preventSync=!1},isAbleTabSync:function(){return!this._preventSync},disableStateObserving:function(){this._preventObservingStateChange=!0},enableStateObserving:function(){this._preventObservingStateChange=!1},isAbleToStateObserving:function(){return!!this._preventObservingStateChange},isContainsLimitedSpecial:function(){return{result:!1,message:""}},resetData:function(){return!1},save:function(){var n=this.useFnActivedItem()?this.getFnActivedId():null,t;return t=$.isNull(n)?this.getValue():{value:this.getValue(),fn:n},{key:this.id,value:t}},saveWithoutEmpty:function(){return this.save()},restore:function(n){var i,t;_.isPlainObject(n)?(i=n.value,t=n.fn):i=n;this.setValue(0,i,!1);this.getNationalFlag()&&_.get(n,"nationalCode")&&this.setNationalFlag(_.get(n,"nationalCode"));this.useFnActivedItem()&&!$.isNull(t)&&(this.setFnActivedId(t),this.useFnExcepted()&&this.setExcepted(t==="NotContain"?!0:!1))},reset:function(n,t){var r=this.hasError(),i;n&&n.__state?this.resetAllState(n.__state):(i=n?n.data:this.getResetState(),this.resetStateByData(i));t&&this.executeChangeDelegator();this.isInlineMode()&&this.setActiveInlineMode(this.getActiveInlineMode(),!1);r&&this.hideError(this._IT_SELF,!1,!0)},callChangeEvent:function(){this.executeChangeDelegator()},_setResetValue:function(n,t,i){this.setState(n,t,i)},resetAllState:function(n){var i,r,u,t,f,o,s,h,c,l,e;this.pendingViewUpdate(!0);for(i in n)if(o=this._IT_SELF,i==="components")for(t=0,f=this.getComponents().length;t<f;t++){o=t;u=n[i][t];for(r in u)this._isComponentResetExceptionPath(r,u)||this.setState(o,r,u[r])}else if(i=="functions")for(s=n[i],h=Object.getOwnPropertyNames(s),t=0,f=h.length,e;t<f;t++){l=h[t];e=s[l];for(c in e)this.setState(l,c,e[c])}else this._isControlResetExceptionPath(i)||this.setState(this._IT_SELF,i,n[i]);this.pendingViewUpdate(!1);this.batchUpdateView()},resetStateByData:function(n){var t,i,r;for(this.pendingViewUpdate(!0),i=0,r=n.length;i<r;i++)t=n[i],t[1]=="value"?this._setResetValue(t[0],t[1],t[2]):this.setState(t[0],t[1],t[2]);this.pendingViewUpdate(!1);this.batchUpdateView()},getResetState:function(){return[]},_isComponentResetExceptionPath:function(n,t){return n.indexOf("css")>-1||["ecPath","cid","attr.name"].contains(n)||n=="viewValue"&&(!this.isUseOriginVal(t.index)||t.originValue==""||_.isNil(t.originValue))||this.isComponentResetExceptionPath(n,t)},isComponentResetExceptionPath:function(){return!1},_isControlResetExceptionPath:function(n){return n.indexOf("css")>-1||this.isControlResetExceptionPath(n)},isControlResetExceptionPath:function(){return!1},resetExceptionalState:function(){},extract:function(){return{__state:_.cloneDeep(this.__state),__viewOptions:_.cloneDeep(this.__viewOptions)}},clone:function(){return this.extract()},getSyncData:function(){return{data:[]}},getExtractState:function(n,t){var e=[],f,o,r,s,u,i;for($.isArray(n)||(n=[n]),f=0,o=n.length;f<o;f++)if(u=n[f],t===!0)i=this.getState(this._IT_SELF,u),$.isNull(i)||e.push([this._IT_SELF,u,i]);else for(r=0,s=this.getComponents().length;r<s;r++)i=this.getState(r,u),$.isNull(i)||e.push([r,u,i]);return e},getExtractFunctionState:function(n,t){var f=this.getState(this._IT_SELF,"functions"),r,i,u=[];for($.isArray(n)||(n=[n]),$.isNull(t)||$.isArray(t)||(t=[t]),index=0,length=n.length;index<length;index++)(r=n[index],i=f[r],i)&&(t?t.reduce(function(n,t){return $.isNull(i[t])?n:(n.push([r,t,i[t]]),n)}.bind(this),u):Object.getOwnPropertyNames(i).reduce(function(n,t){return n.push([r,t,i[t]]),n}.bind(this),u));return u},getOriginState:function(n,t){for(var n=$.isNull(n)?[]:$.isArray(n)?n:[n],t=$.isNull(t)?[]:$.isArray(t)?t:[t],u=[],f=_.cloneDeep(this.__originData),a=f.functions,r,s,e,l,h,c,i=0,o=n.length;i<o;i++)for(r=n[i],$.isNull(f[r])||u.push([this._IT_SELF,r,f[r]]),e=0,l=f.components.length;e<l;e++)h=f.components[e],$.isNull(h[r])||u.push([e,r,h[r]]);for(i=0,o=t.length;i<o;i++)s=t[i],c=a[s],u=u.concat(Object.getOwnPropertyNames(c).map(function(n){return[s,n,c[n]]}.bind(this)));return u},serialize:function(n){var t=this._serializeCustomizer(this);return(t&&(n=t),this.noSerialize==!0)?!1:(this.getNationalFlag()&&!_.isNil(n)&&_.isPlainObject(n)&&(n.nationalCode=this.getNationalFlag()),n===undefined?!1:n)},getFoldLayerValue:function(){var n=_.isFunction(this._getCustomFoldLayerValue)?this._getCustomFoldLayerValue(this):this.getText?this.getText():this.getValue();return _.isArray(n)?n.join(" "):n},_serializeCustomizer:function(){},serializeAdditionalData:function(n){var t=this._serializeAdditionalDataCustomizer(this);return t&&(n=t),n===undefined?!1:n},_serializeAdditionalDataCustomizer:function(){},isSerializeEnabled:function(){return _.isBoolean(this.enableSerialzeOnVisible)&&this.enableSerialzeOnVisible===!0&&!this.isVisible()?!1:this.noSerialize==!0?!1:!0},serializeById:function(){return this.serialize(null,this.id)},setValueBySerialized:function(){},dualModeShowButtonDisplay:function(){return!0},getGridViewHTML:function(){var t=this.getGridComposedTitleLabel(),n=[];return n.push(t),this.ecview.getGridViewTemplate(n)},getGridComposedTitleLabel:function(n){var t={},i=this.getGridControlContext(n);return t.title=i.getAddonTitle()||"",t.label=i._getGridSelectedLabel(),i.getNationalFlag()&&(t.nationalCode=i.getNationalFlag()),t},getGridControlContext:function(n){return n===undefined?this:n},_getGridSelectedLabel:function(){var n=this.getGridSelectedLabel&&this.getGridSelectedLabel();return n===undefined?"":n},getInitFocusIndex:function(){return 0},getCurrentFocusedIndex:function(){var n=this.getVisibleComponents(),t;return!n||!n.length?-1:(t=n.find(function(n){return this._hasFocus(n.index)?!0:!1}.bind(this)),t?t.index:-1)},getFocusableIndex:function(){return this._getFocusableIndex()},getReversedFocusableIndex:function(){return this._getFocusableIndex(!0)},_getFocusableIndex:function(n){var t=this.getVisibleComponents(),r,i;return!t||!t.length?-1:(r=t.find(function(t,r){return this._hasFocus(t.index)?(i=r+(n?-1:1),!0):!1}.bind(this)),r)?t[i]?t[i].index:-1:t[n?t.length-1:0].index},hasFocusableComponent:function(){return!!this.getVisibleComponents().length},hasFocus:function(){var n=this.getVisibleComponents();return!this.ecview||!n?!1:n.any(function(n){return this._hasFocus(n.index)}.bind(this))},_hasFocus:function(n){return this.ecview&&this.ecview.hasFocus(n)},onFocus:function(n){this.setFocusOnComponent(n,!0)},onFocusOut:function(n){this.getState(this._IT_SELF,"opt.lockErrorStatus")||this.validateIf(this.getState(this._IT_SELF,"validate.needvalidate")&&!this.doPreventAction());this.setState(this._IT_SELF,"opt.lockErrorStatus",!1);n===!0&&this.ecview&&this.ecview.onBlur()},setFocus:function(n,t){var f=this.__state,i=this.getComponent(n),r=!!(this.isVisibleElement(n)&&!this.isReadOnly(n)),u=t&&t.readonly===!0&&this.getState(this._IT_SELF,"validate.needvalidate");if(u&&this.isReadOnly(n)&&this.setState(this._IT_SELF,"opt.lockErrorStatus",!0),i&&r)this.setFocusOnComponent(n,!0);else this.onNextFocus(n)},setFocusOnComponent:function(n,t){this.notify(n,"focus.index",t)},onNextFocus:function(n){var t=n+1,i=this.getComponent(t);i?this.setFocus(t):this.setFocusOutTrigger()},setFocusOutTrigger:function(){this.delegator&&this.delegator.triggerEvent("control.focusout",{__self:this,cid:this.pcid||this.id,origin_id:this.id})},setRequestParameter:function(n,t){t.PARAM=n;this.addPopupOpenParam(t)},addPopupOpenParam:function(){},executeChangeDelegator:function(n){var t=n&&n.ecEvent?n.ecEvent:undefined,i=n&&n.event?n.event:undefined,r=this._getDefaultDelegatorInfo(t,i);if(n&&n.oldValue!=undefined&&(n.oldVlaue=n.oldValue),!this.isAbleToExecuteDelegator()){this._delegatorQueue.push(n);return}this._getGridCellInfo(n,function(){this.delegator&&this.delegator.triggerEvent("control.change",_.merge(r,{type:"control.change",value:this._getValueForDelegate(n),preventTriggerEvent:n?n.preventTriggerEvent:undefined},n))}.bind(this))},setEventChangeByBlur:function(n,t){this.notify(n,"blur.change",t)},hasValidateNeededComponent:function(){return this.getState(this._IT_SELF,"validate.needvalidate")||this.getComponents().any(function(n){return!!n["validate.needvalidate"]})},validateIf:function(n){n&&this.hideError(undefined,!1,!0)},validate:function(n,t){var i=[],r=this._getValidateValue(),e=this.getState(this._IT_SELF,"validate.containstype"),n=n||this.getState(this._IT_SELF,"validate.datarules")||[],t=t||this.getState(this._IT_SELF,"validate.datarulesmsg"),u,f,o;if(r=_.isNumber(r)?r+"":r,this._executeValidateIfVisible&&!this.isVisibleElement(0))return[];if(e&&r!==!1&&(i=this._checkContainsType(r,e),i.length>0))return i;for(this.ecDataFilters&&this.checkDataFilter(r),u=this.checkValidate(n,t)||[],f=0,o=u.length;f<o;f++)u[f].control=this;return i=this.checkEqualMsg(i,u),this.setDataRuleMessage(this._IT_SELF,i),i},_getValidateValue:function(n){return this.getValue(n)},_getGridCellInfo:function(n,t){t(n)},_checkContainsType:function(n,t){var r=[],i;return $.isNull(t)||this.isPreventCheckContainsType()==!0||(i=(n||"").toString().isContainsLimitedSpecial(t),i.result?(errMessage=i.message,r.push({message:errMessage,control:this,method:"limitedSpecial"}),this.setPreventHideError(!0),this.hasError()?this.setPopover(this._IT_SELF,{message:errMessage,placement:this._errPlacement,directShow:!0}):this.showError(this._IT_SELF,errMessage,!0),this._toggleValidate(this._IT_SELF,!0,!0)):this.setPreventHideError(!1)),r},isInGrid:function(){return!!(this.gridID&&this.gridColumnID&&this.gridDataKey&&this.gridSectionType)},isInGridWithoutCombineParent:function(){return this.isInGrid()&&!this.pcid},isPreventCheckContainsType:function(){var n=!!this._preventCheckContainsType;return(this.ecKeyInputFilters||[]).forEach(function(t){if(t.type=="numberOnlyAndSign"){n=!0;return}}),n},checkDataFilter:function(n){for(var u,i,t=0,r=this.ecDataFilters.length;t<r;t++)u=this.ecDataFilters[t],i=u(n),i.result===!1||i.data&&this.setFilteredValue(i.data)},setFilteredValue:function(n){this.setValue(n)},changeDataFilter:function(n){this.ecDataFilters=null;this._registerFilter("ecDataFilters",n)},checkValidate:function(){return[]},replacesSeparatorOrigin:function(n,t){var r=this._numericOptions.options,u,f,e,o,i;return $.isNull(n)?"":(t||(t={}),u=t.split_separator||r.DEC_SEPARATOR||".",f=t.reg_separator||r.THOU_SEPARATOR||",",e=t.replace_separator||",",o=t.join_separator||".",i=n.split(u),$.isNull(i[0])||(i[0]=i[0].replace(new RegExp("\\"+f,"g"),e)),i.join(o))},checkEqualMsg:function(n,t){var u=t.length,i,r;if(u==1)n.push(t[0]);else for(i=0;i<u;i++)for(r=i+1;r<=u;r++)if(n.push(t[i]),t[i].message==t[r].message)return n;return n},setDataRules:function(n,t){arguments.length==1&&n==null&&(this.setState(this._IT_SELF,"validate.datarules",null),this.setState(this._IT_SELF,"validate.datarulesmsg",null));n&&this.setState(this._IT_SELF,"validate.datarules",n);t&&this.setState(this._IT_SELF,"validate.datarulesmsg",t)},setDataRuleMessage:function(n,t){var r,i,u;if(this.hasError()&&this.hideError(n,undefined,!0),t.length>0){for(r=[],i=0,u=t.length;i<u;i++)t[i].method!="required"&&r.push(t[i].message);this.showError(n,r.length==0?null:r.join("<br/>"))}},hasError:function(n){return this.getState($.isNull(n)?this._IT_SELF:n,"validate.needvalidate")},showError:function(n,t,i,r,u){var f=Array.prototype.slice.apply(arguments),s=!1,e,h,c,o;f.length===1&&_.isPlainObject(f[0])?(n=f[0].key,t=f[0].message,i=f[0].directShow,r=f[0].preventTrigger,u=f[0].forceUpdateView,s=f[0].useDefaultOptions):f.length===0?n=this._IT_SELF:f.length===1&&(t=n,n=this._IT_SELF,c="focus hover");$.isEmpty(n)&&(n=this._IT_SELF);o=(t&&typeof t=="string"?t:"").cr2br();s==!0?(e=this._getPopoverOptions(),e.message=$.isEmpty(t)?this._getPopoverOptions().message:o,e.directShow=$.isNull(i)?!!this._getPopoverOptions().directShow:i):e={message:o,placement:this._errPlacement,directShow:!!i,trigger:c};this.setPopover(n,e);h=this.isViewUpdateable()&&!this.getState(n,"validate.needvalidate")||u;this._toggleValidate(n,!0,u);h&&!r&&this.delegator&&this.delegator.triggerEvent("control.showError",{instance:this,cid:this.id})},hideError:function(n,t,i){if(n=$.isEmpty(n)?this._IT_SELF:n,!this.isPreventHideError()){var r=this.isViewUpdateable()&&this.getState(n,"validate.needvalidate")||i;this._toggleValidate(n,!1,i);this._togglePopover(n,!1);r&&!t&&this.delegator&&this.delegator.triggerEvent("control.hideError",{instance:this,cid:this.id})}},setErrorMessage:function(n){this.setState(this._IT_SELF,"popover.message",n)},getErrorMessage:function(){return this.getState(this._IT_SELF,"popover.message")},setPreventHideError:function(n){this.setState(this._IT_SELF,"validate.errpreventhide",n)},isPreventHideError:function(){return this.getState(this._IT_SELF,"validate.errpreventhide")},setPopover:function(n,t){t=t||{};for(var i in t)$.isNull(this.getState(n,"popover."+i))||this.setState(n,"popover."+i,t[i],!0);this._togglePopover(n,!0,t.doNotNotifyGrid)},_togglePopover:function(n,t,i){this._getGridCellInfo({},function(r){var u=[this.ecPageID,this.tabID,this.gridID].join(ecount.delimiter),f=this.getState(n,"popover.toggle")!==t;this.setState(n,"popover.toggle",t);f&&!i&&ecount.runtime.notify("control.togglePopover",u,{flag:t,control:this,gridInfo:r,popoverInfo:this._getPopoverOptions()})}.bind(this))},_toggleValidate:function(n,t,i){this._getGridCellInfo({},function(r){var u=[this.ecPageID,this.tabID,this.gridID].join(ecount.delimiter);this.setState(n,"validate.needvalidate",t,i);ecount.runtime.notify("control.toggleValidate",u,{flag:t,control:this,gridInfo:r,validateInfo:this._getSpecificStateGroup(this._IT_SELF,"validate")})}.bind(this))},resetPopover:function(n,t){t=t||{};this._togglePopover(n,!1,t.doNotNotifyGrid);this.setPopover(n,t)},destroyPopover:function(n){this._togglePopover(n,!1)},_getPopoverOptions:function(n){for(var i=["type","message","placement","directShow","trigger","title","template","unusedbodyclickhandler","toggle"],n=$.isNull(n)?this._IT_SELF:n,r,f={},t=0,u=i.length;t<u;t++)r="popover."+i[t],f[i[t]]=this.getState(n,r);return f},_getSpecificStateGroup:function(n,t){var i;return n=$.isNull(n)?this._IT_SELF:n,t.indexOf(".")==-1&&(t=t+"."),i=n===this._IT_SELF?this.__state:this.__state[n],Object.getOwnPropertyNames(i).reduce(function(n,r){return r.indexOf(t)===0&&(n[r.replace(t,"")]=i[r]),n},{})},_doSelectAction:function(){return!1},appendSpace:function(){this.ecview&&this.ecview.appendSpace()},addFilterOptions:function(n){this.registerKeyInputFilter(n)},removeFilterOptions:function(n){_.isArray(n)||(n=[n]);_.isArray(this.ecKeyInputFilters)&&(this.ecKeyInputFilters=this.ecKeyInputFilters.filter(function(t){return n.contains(t.type)===!1}))},roundAllLayerItem:function(n,t){for(var i,r=0,u=(n||[]).length;r<u;r++){if(i=n[r],t.call(this,i,r,n)==!1)return null;i.isChildDepth===!0&&this.roundAllLayerItem(i.childItems,t)}return null},addDropdownItem:function(n){_.isArray(n)||(n=[n]);this.dropdownOptions=this.dropdownOptions&&this.dropdownOptions.length>0?this.dropdownOptions.concat(n):n},setDropdownSize:function(n){n===undefined&&(this.isSetDropdownSize=this.dropdownOptions&&this.dropdownOptions.length>8);this.isSetDropdownSize=n},addCaretDropdownItem:function(n){_.isArray(n)||(n=[n]);this._caretDropdownList=this._caretDropdownList&&this._caretDropdownList.length>0?this._caretDropdownList.concat(n):n},addFnItem:function(){this.addDropdownItem.apply(this,arguments)},removeDropdownItem:function(n,t){var i,r,f,u,e;if(t===!0)return this.dropdownOptions=[],!1;for(_.isArray(n)||(n=[n]),r=0,f=this.dropdownOptions.length;r<f;r++){if(i=this.dropdownOptions[r],n.contains(i.id)===!0){this.dropdownOptions.splice(r,1);r--;f--;continue}if(i.isChildDepth===!0)for(u=0,e=i.childItems.length;u<e;u++)n.contains(i.childItems[u].id)===!0&&(i.childItems.splice(u,1),u--,e--)}},removeCaretDropdownItem:function(n,t){if($.isEmpty(n)||t===!0)return this._caretDropdownList=[],!1;_.isArray(n)||(n=[n]);for(var r,i=0,u=this._caretDropdownList.length;i<u;i++)if(r=this._caretDropdownList[i],n.contains(r.EMAIL)===!0){this._caretDropdownList.splice(i,1);i--;u--;continue}},removeFnItem:function(){this.removeDropdownItem.apply(this,arguments)},addDropdownChildItem:function(n,t){var i=this.getDropdownItem(n);i&&(i.isChildDepth=!0,i.childItems=t)},addFnChildItem:function(){this.addDropdownChildItem.apply(this,arguments)},removeDropdownChildItem:function(n){var t=this.getDropdownItem(n);t&&t.childItems&&(t.childItems=null,t.isChildDepth=null,delete t.childItems,delete t.isChildDepth)},removeFnChildItem:function(){this.removeDropdownChildItem.apply(this,arguments)},hideDropdownItem:function(n){_.isArray(n)||(n=[n]);for(var t,i=0,r=n.length;i<r;i++)t=this.getDropdownItem(n[i]),t&&(t.hide=!0)},hideFnItem:function(){this.hideDropdownItem.apply(this,arguments)},showDropdownItem:function(n){_.isArray(n)||(n=[n]);for(var t,i=0,r=n.length;i<r;i++)t=this.getDropdownItem(n[i]),t&&(t.hide=!1)},showFnItem:function(){this.showDropdownItem.apply(this,arguments)},getDropdownItem:function(n){var t;return $.isNull(n)?this.dropdownOptions:(this.roundAllLayerItem(this.dropdownOptions,function(i){if(i.id===n)return t=i,!1}),t)},getFnItem:function(){return this.getDropdownItem.apply(this,arguments)},getFnItemById:function(){return this.getDropdownItem.apply(this,arguments)},getDropdownControl:function(n){var t;return this.roundAllLayerItem(this.dropdownOptions,function(i){if(i.id===n)return t=i,!1}),t},getDropdownVisibleItems:function(){var n=[];return this.roundAllLayerItem(this.dropdownOptions,function(t){t.hide!==!0&&n.push(t)}),n},getFnVisibleItems:function(){return this.getDropdownVisibleItems.apply(this,arguments)},getDropdownItemLength:function(){return this.dropdownOptions.length},getFnItemLength:function(){return this.getDropdownItemLength.apply(this,arguments)},changeFnClass:function(n,t){var i=this.getDropdownItem(n);$.isNull(i)||(i.aCss=t)},isVisibleFn:function(){return this.getState("fn","style.display")},changeFnText:function(n,t){var i=this.getDropdownItem(n);$.isNull(i)||(i.label=t)},changeFnClass:function(n,t){var i=this.getDropdownItem(n);$.isNull(i)||(i.aCss=t)},getFnActivedId:function(){return this.getState("fn","activedId")},setFnActivedId:function(n,t,i){var r=this.getFnItem(n);r&&!$.isNull(n)&&(i==!0||r.preventActive!=!0)&&this.setState("fn","activedId",n);t!=!1&&this.delegator&&this.delegator.triggerEvent("form.sync",{cid:this.id,syncHandler:this.setFnActivedId,__self:this,preventTriggerEvent:!0,args:[n,!1,i]})},useFnActivedItem:function(){return this.hasFn&&!$.isNull(this.fnOptions)&&!$.isNull(this.fnOptions.keepLastActivedItem)},useFnExcepted:function(){var n=this.__state.functions;return this.hasFn&&n&&n.excepted},getLayerServiceKey:function(n){var i=ecount.layer.constValue,r=n.ecPath,t;switch(n.ecService){case i.FN:t="fn";break;case i.TABLE:t="table";break;case i.DROPDOWN:t=n.cindex;break;case i.SELECTBOX:t=n.ecRoleIndex||n.ecFunctionId;break;case i.SPECTRUM:t="spectrum";break;case i.AUTOCOMPLETE:t=n.cindex;break;case i.CARETDROPDOWN:t="caret";break;case i.RECOMMENDDROPDOWN:t="recommend";break;case i.SELECTOR:t="selector"}return ecount.common.makeServiceKey(r,t)},getLazyLayerServiceKey:function(n){var r=ecount.layer.constValue,t=n&&n.ecPath||this.ecPath,u=n&&n.ecServiceAttr||this.getState(0,"ecServiceAttr"),i;return u==r.FOCUSABLE&&(i="recommend"),this.gridID&&(t=[t,this.rowKey].join(ecount.separator.ecPath)),ecount.common.makeServiceKey(t,i)},getLayerDefaultOption:function(n,t){if(this.ecview){var i=this.ecview.getGridElementInfo();return{type:n.ecService.split(".").pop(),ownerKey:this.ecIKey,serviceKey:this.getLayerServiceKey(n,t),ecPageID:this.ecPageID,containerName:this.containerName,tabID:this.tabID,gridID:this.gridID,isGridV3:this.isGridV3,tableId:i.gridTableID,rowId:i.dataKey,columnId:i.columnID,sectionType:i.sectionType}}},getLayerFnOption:function(n,t){var r=this.dropdownOptions,i=this.getFnActivedId();return this.useFnActivedItem()&&i&&!$.isEmpty(this.getFnItem(i))&&r.forEach(function(n){n.active=n.id==i?!0:!1}),_.extend(this.getLayerDefaultOption(n,t),this.fnOptions,{_commandPrefix:"function",items:r||[],boundary:this.getFunctionBoundary("fn")})},getLayerDropdownOption:function(n,t){return _.extend(this.getLayerDefaultOption(n,t),{boundary:this.getContainerBoundary()})},getLayerSelectorOption:function(n,t){var i=this.inlineModeList.map(function(n){return{id:n.layerId||[this.id,n.mode].join("_"),label:ecount.resource[n.layerLabel]||n.layerLabel,inlineMode:n.mode}}.bind(this));return _.extend(this.getLayerDefaultOption(n,t),{items:i||[],type:"dropdown",boundary:this.getFunctionBoundary("selector")})},getLayerSelectboxOption:function(n,t){var i=this.getLayerDefaultOption(n,t),r=this.getComponent(n.ecRoleIndex);return _.extend(i,r,{showingUpDelay:0,boundary:this.getRoleHolderBoundary(n.ecRole,n.ecRoleIndex)})},getLayerDatepickerOption:function(n,t){return _.extend(this.getLayerDefaultOption(n,t),{showingUpDelay:0,boundary:this.getContainerBoundary()})},getLayerSpectrumOption:function(n,t){var i=ecount.resource;return _.extend(this.getLayerDefaultOption(n,t),{boundary:this.getRoleHolderBoundary(n.ecRole),showingUpDelay:0,togglePaletteMoreText:i.BTN00108,togglePaletteLessText:i.LBL10378,cancelText:i.BTN00133,chooseText:i.BTN00357})},getLayerAutocompleteOption:function(n,t){return _.extend(this.getLayerDefaultOption(n,t),{type:"autocomplete",boundary:this.getComponentBoundary(n.cindex),minLength:1,searchURL:this.autocompleteSearchUrl||this.searchURL,searchSourceList:null,index:n.cindex,defaultParam:this.defaultParam,multiSelect:this.isCheckBoxDisplayFlag,showingUpDelay:300})},getLayerTableOption:function(n,t){var i=this.getLayerDefaultOption(n,t),r=this.getComponent(n.cindex||0);return _.extend(i,r,{boundary:this.getComponentBoundary(n.cindex||0),showingUpDelay:0,css:"dropdown-menu generate-other-slips"})},getLayerCaretdropdownOption:function(n,t){return _.extend(this.getLayerDefaultOption(n,t),{items:this._caretDropdownList||[],boundary:this.getCaretBoundary(),baseType:!1,withRemoveBtn:!0,cid:n.cid,cindex:n.cindex,pcid:this.id,ppcid:this.pcid,onClickCaretDropdownList:this._onClickCaretDropdownList.bind(this)})},getLazyLayerDefaultOption:function(n,t,i){var r=n.ecLazyService?n.ecLazyService:i.ecLazyService,u=this.getState(0,"ecServiceAttr")==ecount.layer.constValue.FOCUSABLE?!0:!1;return{type:r.split(".").pop(),ownerKey:this.ecIKey,serviceKey:this.getLazyLayerServiceKey(n,t),isFocusable:u,ecPageID:this.ecPageID,containerName:this.containerName,tabID:this.tabID,gridID:this.gridID}},getLazyLayerRecommenddropdownOption:function(n,t,i,r){var u=this.delegator;return new Promise(function(t,i){u&&u.triggerEvent("control.openLayer",{targetID:this.id,control:this,parameter:{event:n,isReload:r&&r.btnType=="Reload"||!1,responseID:responseID=ecount.global.registerCallback(this.ecPageID,this.onRecommendMessage,this)},handler:function(n){n.status==="success"?t(n):(n.status==="fail"||n.status===undefined)&&i()}})}.bind(this))},onRecommendMessage:function(){},dropdownLayerClick:function(n,t){var i=_.cloneDeep(this.defaultParam),r=_.extend({},i,t);this.delegator&&this.delegator.triggerEvent("control.openPopup",{targetID:this.id,control:this,parameter:r,handler:function(i,r,u,f){var e=this._getFavoriteCodePopupOption(i,n);e.popupLevel=f;e.parentPageID=i.parentPageID||u;this.openFavoriteCodeTreePopup(_.extend(e,t),u,f)}.bind(this)})},_getFavoriteCodePopupOption:function(n,t){var i={Request:{defaultParam:_.extend(this.defaultParam||{},n),PopupUrl:this.popupURL||"",PrgId:this.prgId,WigtCd:this.controlType,Wigt_dv_cd:t.wigt_dv_cd||this.cid,RowIdx:this.rowIdx,GridId:t.gridID},width:300||t.width,height:600||t.width,isOpenPopup:!0,responseID:ecount.global.registerCallback(this.ecPageID,this.onMessage,this),__ecPageID:this.ecPageID};return{url:n.url||t.url,name:n.name||"",param:i,popupID:this.id,popupType:n.popupType||!1,alreadyIncludedLayout:!n.popupType||!0}},openFavoriteCodeTreePopup:function(n){this._getGridCellInfo({},function(t){t.gridDataKey&&n.param&&n.param.Request&&(n.param.Request.RowIdx=t.gridDataKey);ecount.popup.openWindow(n)})},openPopup:function(n,t){t.responseID=this.callbackID;t.__ecPageID=this.ecPageID;this.delegator&&this.delegator.triggerEvent("control.openPopup",{targetID:n.targetID,control:n.control,parameter:t,handler:function(n,t,i,r){this.responseID=t;var u={url:n.url,name:n.name||"",param:n,popupType:n.popupType,popupID:this.id,popupLevel:r,parentPageID:n.parentPageID||i,isChangePopupType:n.isChangePopupType,alreadyIncludedLayout:!n.popupType};ecount.popup.openWindow(u)}.bind(this)})},setStyle:function(n,t){arguments.length===1?(t=n,n=this._IT_SELF):arguments.length===2&&$.isNull(n)&&(n=this._IT_SELF);for(var i in t)this.setState(n,"style."+i.toLowerCase(),t[i])},_setInputValue:function(n){this._during_input_event=!0;this.setValue(n.cindex,n.value);this._during_input_event=!1},onMessage:function(){},isCheckboxControl:function(){},_isLayerShow:function(n){var t;if(n)return(t=ecount.layer.getLayer(n),t&&t.isShow)?!0:!1},isDateControl:function(){},setImeModeKeydownHandler:function(n,t,i){var r={cindex:n,type:"imeMode",options:{mode:i}};this._registerFilter("ecKeyInputFilters",r)},doPreventAction:function(){return this.isPreventHideError()},_setPreventClick:function(n){var t=this;t[n]=!0;ecount.global.setTimeout(this.ecPageID,function(){t[n]=!1},t._clickDelayTime)},_getAllClass:function(n,t){return ecount.convertor.uniqSumClass(this._defaultCss,(this.getState(n,"style.css")||"").replaceAll("hidden",""),this.getState(n,"style.display")===!1?"hidden":"",n===this._IT_SELF&&this.hasError()?"has-error":"",t||"")},_setDropdownControls:function(n){if(n&&$.isArray(n)){for(var t,i=0;i<n.length;i++){t=n[i];switch(t.controlType){case"widget.checkbox":t.getValue=function(){return this.data[0].selected}}}return n}return[]},_setValueOnServiceControl:function(n,t){var i=this.getFnItem(n.id),t=n.getValue();if($.isNull(i))return!1;switch(n.controlType){case"widget.checkbox":i.data[0].selected=t;i.value=t}},_numericRTrim:function(n,t){var i=_.extend(_.clone(this._numericOptions.options),t||{});return ecount.convertor._numericRTrim(_.isNil(n)?"":n,i)},_applyFilters:function(n,t){for(var h=this.ecKeyInputFilters||[],o=!1,f=n,s="",u={},i,r,l,e=0,c=h.length;e<c;e++)if((i=h[e],!$.isNumber(i.cindex)||i.cindex===t)&&i.type!=="prettyFilter"){if(i.type=="password"&&_.isFunction(this.passwordValidate)&&(u.passwordValidate=this.passwordValidate),i.type==="numericOnly"&&(u.duringInputEvent=this._during_input_event,_.hasIn(i,"options.numericViewType")&&(u.numericViewType=i.options.numericViewType,u.numericViewKeepOrigin=i.options.numericViewKeepOrigin)),r=ecount.convertor.executeFilter(i,n,u),f=r.str,s=r.message,l=r.isErr,this.setState(this._IT_SELF,"validate.filterResult",r),i.type==="numericOnly"&&this.isUseOriginVal(t)&&(this.setState(t,"originValue",r.orgVal),this.setState(t,"viewValue",r.viewVal,!1)),this._useNumericRequired&&f==""){s="";o=!0;break}if(f!=n){o=l!=!1;break}}return o&&this._during_input_event==!0?this.hasError()||this.showError(this._IT_SELF,s,!0):this.hasError()&&this.hideError(this._IT_SELF),f},getConvertPrettyFilter:function(n,t,i){var f={value:t,isChange:!1},u,r,e;for(n=n||this.__prettyFilter||[],r=0;r<n.length;r++)e=n[r],u=ecount.convertor.executePrettyFilter(e,t,i),u.isChange&&_.merge(f,u);return f},_getDefaultDelegatorInfo:function(n,t){var i=n||{},r={cid:this.id,event:t,__self:this,gridID:i.gridID||this.gridID,gridDataKey:i.gridDataKey||this.gridDataKey,gridColumnID:i.gridColumnID||this.gridColumnID,gridSectionType:i.gridSectionType||this.gridSectionType};return this.getNationalFlag()&&(r.nationalCode=this.getNationalFlag()),$.isNull(i.cid)?_.extend(r,{syncData:this.getSyncData()}):_.extend(r,{type:n.handler.split(".").reverse().join("."),cid:n.cid,cindex:n.cindex||0,value:this.getValue?this.getValue(n.cindex):"",syncData:this.getSyncData(n.cindex)}),r},_getValueForDelegate:function(n){return this.getStandardValue(n&&n.cindex?n.cindex:0)},setDetailSearchLayoutStatus:function(n){this.detailSearchLayoutStatus=n},getDetailSearchLayoutStatus:function(){return this.detailSearchLayoutStatus==undefined?!1:this.detailSearchLayoutStatus},_showLayer:function(n,t,i){var o;if(this.getDetailSearchLayoutStatus())return!1;var e=n.handler.toLowerCase().split(".").slice(1).join("."),f=("get_"+e.replace(/\./g,"_")+"_option").ecCamelize(!0),r,u=ecount.layer.constValue;switch(e){case u.SELECTBOX:o=this.getState(this._IT_SELF,"useRecommendOption");r=ec$.safeCall(this,f,n,t);o&&r!==!1&&r.executeToggle!=!0&&ecount.layer.show(_.extend(r,i||{}));break;case u.FN:case u.DROPDOWN:case u.RECOMMENDDROPDOWN:case u.SELECTOR:case u.SELECTITEM:r=ec$.safeCall(this,f,n,t);r!==!1&&r.executeToggle!=!0&&ecount.layer.show(_.extend(r,i||{}));break;case u.TABLE:r=ec$.safeCall(this,f,n,t);ecount.layer.update(_.extend(r,i||{}))}},_showLayerRecommendDropdown:function(n,t,i,r){var f=this.getOptionsFunctionName(n,t,i,r,"get_"),u=ec$.safeCall(this,f,n,t,r);u!==!1&&u.executeToggle!=!0&&ecount.layer.show(_.extend(u,{}))},_hideLayer:function(n,t){var r=n.handler.toLowerCase().split(".").slice(1).join("."),u=this.getLayerServiceKey(n,t),i=ecount.layer.constValue;switch(r){case i.FN:case i.TABLE:case i.DROPDOWN:case i.RECOMMENDDROPDOWN:case i.SELECTOR:case i.SELECTITEM:ecount.layer.hide(u)}},_getUserHandlerParam:function(n,t){return t},_onBeforeEventExecute:function(n,t,i,r){var u="_ON_BEFORE_"+n.handler.toUpperCase().split(".").shift();return ec$.safeCall(this,u,n,t,i,r)},validatorOfShowRecommendLayer:function(n,t){var r=this.getLazyLayerServiceKey(n,t),f=ecount.layer.getTimer(r),i,u;return $.isEmpty(f)?(i=ecount.layer.getLayer(r),u=i&&i.isShow(),!u):!1},validatorOfDeleteRecommendLayer:function(){var n=this.getComponent(0),t=n.value;return!$.isEmpty(t)},getOptionsFunctionName:function(n,t,i,r,u){var e=r.handler?r.handler:n.handler,f=e.toLowerCase().split("."),o=f.slice(f.length>3?2:1).join(".");return(u+o.replace(/\./g,"_")+"_option").ecCamelize(!0)},_lazyLoadDropdown:function(n,t,i,r){return new Promise(function(u,f){var o=this.getOptionsFunctionName(n,t,i,r,"get_lazy_"),e=ec$.safeCall(this,o,n,t,i,r);if(e)e.then(function(n){return u(n.data)},function(){return u([])});else return f()}.bind(this)).then(function(u){if(this.hasFocus())this.onBeforeShowRecommendLayer(n,t,i,r,u)}.bind(this)).catch(function(n){console.log(n)}.bind(this))},hideLazyLayer:function(n,t){ecount.layer.hide(this.getLazyLayerServiceKey(n,t))},onClickCaret:function(){},_onClickCaretDropdownList:function(n){n.controlID=this.id;n.pcontrolID=this.pcid;this.onClickCaretDropdownList(n)},onClickCaretDropdownList:function(){},onBeforeShowRecommendLayer:function(n,t,i,r,u){var f=this.getState(this._IT_SELF,"useRecommendOption");this.useFavoriteCode=$.isArray(u)&&u.some(function(n){return n.USE_TF});(f||this.useFavoriteCode)&&(this.recommendDropdownOptions=u,this._showLayerRecommendDropdown(n,t,i,r))},setFunctionAttr:function(n,t,i){!this.isInGridWithoutCombineParent()||t.indexOf("style")<0||this.getState(n,t,i)&&this.setState(n,t,i)},setValueFromLayer:function(n,t,i,r){var f,u;if(r.type==ecount.layer.constValue.RECOMMENDDROPDOWN){if(!r.value)return!1;f=$.isArray(r.value)?r.value[0]:r.value;this.setValue(n.cindex||0,f||"",!0);this.isInGridWithoutCombineParent()&&(u=_.cloneDeep(n),u.value=r.value,u.serviceName=r.serviceName,this.executeChangeDelegator(u));this.removeDropdownLayer.apply(this,arguments);this.onNextFocus(0)}},removeDropdownLayer:function(n){!this.hasFnDynamicView()||this.isReadOnly(this._IT_SELF)||n.eventTriggerFromInternalTarget||n.eventTriggerFromInternalLayerTarget||(this.displayFnDynamicView(!1),this.hideLayerByEcServiceSuffix("fn"))},getLayerRecommenddropdownOption:function(n,t,i){return _.extend(this.getLazyLayerDefaultOption(n,t,i),this.fnOptions,{_commandPrefix:this.controlType.split(".")[1],_forcedDisplayPosition:this.containerName=="footer"?"top":"",cindex:n.cindex,items:this.recommendDropdownOptions||[],baseType:!0,boundary:this.getContainerBoundary(),afterShow:i.afterShow||{},isFromCS:this.isFromCS,useFavoriteCode:this.useFavoriteCode,useRecommendOption:this.useRecommendOption})},_onBeforeServiceEventExecute:function(n,t,i,r){var u="_ON_BEFORE_"+n.handler.toUpperCase().split(".").shift()+"_SERVICE";return ec$.safeCall(this,u,n,t,i,r)},_onValueDeleteShowRecommendLayer:function(n,t,i,r){n.ecLazyService&&this.validatorOfShowRecommendLayer(n,t)&&this._lazyLoadDropdown(n,t,i,r)},_ON_BEFORE_CHANGE:function(){return!0},_ON_CHANGE:function(n,t,i){if(this.triggerUserHandler("change",this._getUserHandlerParam(n,t,i)),this.__silence_change_event===!0||this._onBeforeEventExecute(n,t)===!1)return!1;this.ON_CHANGE(n,t,i)},ON_CHANGE:function(){},_ON_BEFORE_CLICK:function(n,t,i,r){if(n.handler==="click.controlExternal")return!1;if(n.ecService==ecount.layer.constValue.FN){if(!this.isToggleFnLayer())return!1}else if(this.isReadOnly(this._IT_SELF)&&!this._isExceptionOfReadOnly(n,t,i,r)||this.isReadOnly(n.cindex))return!1;return!0},_ON_CLICK:function(n,t,i,r){if(this.triggerUserHandler("click",this._getUserHandlerParam(n,t,i,r)),n.ecFunction=="nationalFlag"&&this.getState("nationalFlag","isClickPopup"))return this.openPopupNationalFlag(),!1;if(this._onBeforeEventExecute(n,t,i,r)===!1)return!1;if(n.ecPath==this.ecPath)if(n.ecService){var e=n.handler.toLowerCase().split(".").slice(1).join("."),o=("get_"+e.replace(/\./g,"_")+"_option").ecCamelize(!0),f=ec$.safeCall(this,o,n,t,i,r),u=ecount.layer.constValue;if(f&&f.executeToggle==!0&&(f.showingUpDelay=0,ecount.layer.toggle(f),!f.continuePropagation))return!1;switch(e){case u.AUTOCOMPLETE:if(!r.showLayerInputMode)return!1;case u.DATEPICKER:case u.SELECTBOX:case u.CREATETABLE:case u.IMAGEFILE:case u.BOXSIZESETTING:case u.PALETTE:case u.REPORT:case u.FILEGROUP:case u.REPORTALIGN:ecount.layer.toggle(f);break;case u.SPECTRUM:ecount.layer.show(f);break;case u.FN:case u.DROPDOWN:case u.SELECTITEM:case u.TABLE:case u.NOTIFICATIONDROPDOWN:case u.SELECTOR:this._fixClickedLayer(n,t,f);break;case u.CARETDROPDOWN:this.onClickCaret({layerShow:function(){f.items=this._caretDropdownList;f.items=$.isArray(this._caretDropdownList)&&this._caretDropdownList.length>0?this._caretDropdownList:[{id:ecount.resource.MSG00729,label:ecount.resource.MSG00729,value:ecount.resource.MSG00729}];this._fixClickedLayer(n,t,f)}.bind(this)})}}else n.ecLazyService&&setTimeout(function(){this.validatorOfShowRecommendLayer(n,t)&&this._lazyLoadDropdown(n,t,i,_.extend(r,{handler:"click."+n.ecLazyService,afterShow:{action:"removeLayer",delay:ecount.common.LAYER_DISAPPEAR_DELAY_1200}}))}.bind(this),0);if(this._tooltip&&(this._timeoutNo&&ecount.global.clearTimeoutByTimerNo(this.ecPageID,this._timeoutNo),this.destroyPopover(this._IT_SELF)),n.handler==ECountEvent.Type.CLICK_LAYER&&this.isOnTableLayer&&this.isOnTableLayer(n,t))this.ON_CLICK(_.extend({},n,{handler:ECountEvent.Type.CLICK_CONTROL}),t);else if(this.ON_CLICK(n,t,i,r)===!1)return!1},_fixClickedLayer:function(n,t,i){var r=i.serviceKey,u=ecount.layer.getLayer(r);if(!!i.useToggleMode&&!_.isNil(u)){ecount.layer.removeLayer(r);return}n.ecServiceAttr!=ecount.layer.constValue.FIXED||this.getDetailSearchLayoutStatus()?ecount.layer.clearTimer(i.serviceKey):(i.showingUpDelay=0,i._onClicked=!0,this.isInlineMode()&&(i.afterShow={action:"removeLayer",delay:ecount.common.LAYER_DISAPPEAR_DELAY_3000}),ecount.layer.show(i),ecount.layer.setOnClicked(i.serviceKey,!0))},ON_CLICK:function(){},_ON_BEFORE_MOUSEOVER:function(n){if(n.ecService==ecount.layer.constValue.FN){if(!this.isToggleFnLayer())return!1}else if(this.hasReadOnlyState(n.cindex))return!1;return!0},_ON_MOUSEOVER:function(n,t,i,r){if(this._onBeforeEventExecute(n,t,i,r)===!1)return!1;if(n.ecService&&n.ecService!="layer.selectbox"&&!this.hasError()&&!this._preventLayerOpenByHover){var u={};this.isInlineMode()&&(u.afterShow={action:"removeLayer",delay:ecount.common.LAYER_DISAPPEAR_DELAY_3000});this._showLayer(n,t,u)}return this._tooltip&&(this._timeoutNo=ecount.global.setTimeout(this.ecPageID,function(){this.setPopover(this._IT_SELF,{message:this._tooltip.message,placement:this._tooltip.placement,directShow:!0})}.bind(this),ecount.common.mouseHoverInTime)),this.ON_MOUSEOVER(n,t,i,r)===!1?!1:void 0},ON_MOUSEOVER:function(){},_ON_BEFORE_MOUSEOUT:function(n,t){return this.hasReadOnlyState(n.cindex)?(this.hasFnDynamicView()&&this._hideLayer(n,t),!1):!0},_ON_MOUSEOUT:function(n,t,i,r){return this._onBeforeEventExecute(n,t,i,r)===!1?!1:(n.ecService&&!this._preventLayerOpenByHover&&this._hideLayer(n,t),this._tooltip&&(this._timeoutNo&&ecount.global.clearTimeoutByTimerNo(this.ecPageID,this._timeoutNo),this.destroyPopover(this._IT_SELF)),this.ON_MOUSEOUT(n,t,i,r)===!1?!1:void 0)},ON_MOUSEOUT:function(){},_ON_BEFORE_MOUSEDOWN:function(n){return this.hasReadOnlyState(n.cindex)?!1:!0},_ON_MOUSEDOWN:function(n,t,i,r){return this._onBeforeEventExecute(n,t,i,r)===!1?!1:this.ON_MOUSEDOWN(n,t,i,r)===!1?!1:void 0},ON_MOUSEDOWN:function(){},_ON_BEFORE_INPUT:function(n,t){var i,r;return ecount.common.isChrome&&this.numericOnly&&n.value!==undefined&&n.cindex!==undefined&&t.originalEvent&&(i=this.getState(n.cindex,"value"),t.originalEvent.inputType=="insertCompositionText"&&(this._usingIMEComosingInput=!0),this._usingIMEComosingInput&&t.originalEvent.inputType=="insertText"&&(r=n.value,this._usingIMEComosingInput=!1,i.length>0&&i!==r))?(this.setState(n.cindex,"value",i,!0),!1):!0},_ON_COMPOSITIONUPDATE:function(n,t){var i;this.numericOnly&&t.target.value!==undefined&&t.originalEvent.data!==undefined&&(i=t.target.value.replace(/[\s\.\,·']/g,""),isNaN(+i)||(t.originalEvent.data.length>1&&ecount.user&&ecount.user.LAN_TYPE!="ja-JP"?this.setState(n.cindex,"value","",!0):this.setState(n.cindex,"value",t.target.value,!0)))},_ON_INPUT:function(n,t,i,r){return this._onBeforeEventExecute(n,t,i,r)===!1?!1:(this._onInputAction(n,t,i,r),n.ecLazyService&&this.validatorOfDeleteRecommendLayer(n,t)&&ecount.layer.removeLayer(this.getLazyLayerServiceKey(n,Event)),this.ON_INPUT(n,t,i,r)===!1?!1:void 0)},_onInputAction:function(n,t,i,r){function o(){var e=(n.value||"").toString().isContainsLimitedSpecial(this._getContainsType(n.cindex)),u;e.result||(u=ec$.safeCall(this,f,n,t,i,r),ecount.layer.update(u))}if(!this._checkValidation(n))return!1;if(this.setState(n.cindex,"value",n.value),n.cindex!=undefined&&this._setInputValue(n,t,i,r),n.ecService){var u=n.handler.toLowerCase().split(".").slice(1).join("."),f=("get_"+u.replace(/\./g,"_")+"_option").ecCamelize(!0),e=ecount.layer.constValue;switch(u){case e.AUTOCOMPLETE:o.call(this)}}},_checkValidation:function(){return!0},ON_INPUT:function(){},_ON_BEFORE_FOCUSIN:function(){return!0},_ON_FOCUSIN:function(n,t,i,r){var u,h,e,o,c;if(this._onBeforeEventExecute(n,t,i,r)===!1)return!1;var l=!$.isNull(n.gridID),a=!$.isNull(n.cindex),f=[],s=[];if(a&&!this.isReadOnly(this._IT_SELF)){if(this.hasFn&&this.getState("fn","attr.disabled")==!1&&this.hasFnDynamicView()&&this.displayFnDynamicView(!0),this.isInlineMode()&&this.getState("selector","style.display")==!0&&(f.push("selector"),s.push({afterShow:{action:"removeLayer",delay:ecount.common.LAYER_DISAPPEAR_DELAY_3000}})),l==!1&&r.showLayerInFocus!=!1)for(u=0,h=f.length;u<h;u++)this._showLayer(_.extend({},n,{handler:["focusin.layer",f[u]].join("."),ecService:["layer",f[u]].join(".")}),t,_.extend({showingUpDelay:ecount.common.mouseHoverInTime,_onClicked:!0},s[u]||{}));this.useFocusHandler&&(r.useFocusHandler=!0)}return $.isNull(n.cindex)||(e=n.value,o=null,this.isUseOriginVal(n.cindex)&&(c=this.getState(n.cindex,"viewValue"),_.isEmpty(c)||(e=this.getState(n.cindex,"value"),o=!0)),this._setNumericFilterdValueToComponent(n.cindex,e,!1,o)),ecount.global.setTimeout(this.ecPageID,function(){this.hasError()&&this.resetPopover(this._IT_SELF,{directShow:!0,trigger:"manual",doNotNotifyGrid:!0})}.bind(this)),this._focusPopover&&this.setPopover(this._IT_SELF,{message:this._focusPopoverMsg,placement:this._errPlacement,directShow:!0,trigger:"focus"}),n.ecLazyService&&this.validatorOfShowRecommendLayer(n,t)&&this._lazyLoadDropdown(n,t,i,_.extend(r,{afterShow:{action:"removeLayer",delay:ecount.common.LAYER_DISAPPEAR_DELAY_1200}})),this.ON_FOCUSIN(n,t,i,r)===!1?!1:void 0},ON_FOCUSIN:function(){},_ON_BEFORE_FOCUSOUT:function(){return!0},_ON_FOCUSOUT:function(n,t,i,r){var u,o,f,e;return this._onBeforeEventExecute(n,t,i,r)===!1?!1:!n.eventTriggerFromInternalTarget&&!n.eventTriggerFromIOSFnTarget&&this.getFunction("fn")&&[ecount.layer.constValue.FN].contains(n.ecService)?(this.hasReadOnlyState(n.cindex)||this.fnAlwaysShow||!this.hasFnDynamicView()||(this.hideLayerByEcServiceSuffix("fn"),this.displayFnDynamicView(!1)),!0):(!this.hasFnDynamicView()||this.isReadOnly(this._IT_SELF)||n.eventTriggerFromInternalTarget||n.eventTriggerFromIOSFnTarget||n.eventTriggerFromInternalLayerTarget||(this.displayFnDynamicView(!1),this.hideLayerByEcServiceSuffix("fn")),this.hasFn&&n.eventTriggerFromIOSFnTarget&&!this.gridColumnID&&this.ecview&&this.ecview.setFunctionFocus("fn"),this.isInlineMode()&&this.getState("selector","style.display")==!0&&this.hideLayerByEcServiceSuffix("selector"),this.numericOnly&&!_.isNull(n.cindex)&&(o=/^[-]$/,u=this._numericRTrim(o.test(n.value)?"":n.value),n.value!=u&&this.setState(n.cindex,"value",u),this.isUseOriginVal(n.cindex)&&(f=this.getState(n.cindex,"viewValue"),_.isEmpty(f)||this.setState(n.cindex,"viewValue",f,!0)),this.isNumericOnlyChangeEventExcute(u)&&this._focusInValue!=u&&this.setState(this._IT_SELF,"opt.triggerChange",n.cindex,!0)),this._useResetData&&(this._savedValue=this.getResetData()),this.hasError()&&(this.resetPopover(this._IT_SELF,{directShow:!1,trigger:"focus hover",doNotNotifyGrid:this.isInGridWithoutCombineParent()}),e=!1,typeof this.getGridActiveInfo=="function"&&typeof this.getGridValidateInfo=="function"&&typeof this.getGridInputMode=="function"&&(e=this.getGridActiveInfo()&&this.getGridValidateInfo()&&this.getGridInputMode()=="view"),this.isPreventHideError()||e||this.hideError(this._IT_SELF)),this._focusPopover&&this.destroyPopover(this._IT_SELF),n.gridColumnID&&n.ecService==ecount.layer.constValue.FN&&(n.eventTriggerFromInternalTarget||n.eventTriggerFromIOSFnTarget))?!1:this.isLayerMousedown?(this.isLayerMousedown=!1,!1):(n.ecLazyService&&this.hideLazyLayer(n,Event),this.ON_FOCUSOUT(n,t,i,r)===!1?!1:void 0)},ON_FOCUSOUT:function(){},_ON_BEFORE_KEYDOWN:function(){return!0},_ON_KEYDOWN:function(n,t,i,r){return this._onBeforeEventExecute(n,t,i,r)===!1?!1:this["_ON_"+n.keyEventHandlerName]&&this["_ON_"+n.keyEventHandlerName](n,t,i,r)===!1?!1:void 0},ON_KEYDOWN:function(){},_ON_KEYDOWN_SERVICE:function(n,t,i,r){if(this["_ON_"+n.keyEventHandlerName+"_SERVICE"]&&this["_ON_"+n.keyEventHandlerName+"_SERVICE"](n,t,i,r)===!1)return!1},_ON_BEFORE_KEYUP:function(){return!0},_ON_KEYUP:function(n,t,i,r){return this._onBeforeEventExecute(n,t,i,r)===!1?!1:this["_ON_"+n.keyEventHandlerName]&&this["_ON_"+n.keyEventHandlerName](n,t,i,r)===!1?!1:void 0},_ON_KEYUP_SERVICE:function(n,t,i,r){if(this["_ON_"+n.keyEventHandlerName+"_SERVICE"]&&this["_ON_"+n.keyEventHandlerName+"_SERVICE"](n,t,i,r)===!1)return!1},ON_KEYUP:function(){},_ON_KEYPRESS:function(n,t,i,r){if(this["ON_"+n.keyEventHandlerName]&&this["ON_"+n.keyEventHandlerName](n,t,i,r)===!1)return!1},_ON_KEYPRESS_SERVICE:function(n,t,i,r){if(this["_ON_"+n.keyEventHandlerName+"_SERVICE"]&&this["_ON_"+n.keyEventHandlerName+"_SERVICE"](n,t,i,r)===!1)return!1},_ON_BEFORE_DBLCLICK:function(){return!0},_ON_DBLCLICK:function(n,t,i,r){return this._onBeforeEventExecute(n,t,i,r)===!1?!1:this.ON_DBLCLICK(n,t,i,r)===!1?!1:void 0},ON_DBLCLICK:function(){},_ON_BEFORE_PASTE:function(){return!0},_ON_PASTE:function(n,t,i,r){return this._onBeforeEventExecute(n,t,i,r)===!1?!1:this.ON_PASTE(n,t,i,r)===!1?!1:void 0},ON_PASTE:function(){},_ON_KEYDOWN_BACKSPACE:function(n,t,i,r){if(n.ecService){var u=n.ecService.toLowerCase(),e=("get_"+u.replace(/\./g,"_")+"_option").ecCamelize(!0),f,o=ecount.layer.constValue;switch(u){case o.AUTOCOMPLETE:f=ec$.safeCall(this,e,n,t,i,r);ecount.layer.update(f)}}if(this.ON_KEYDOWN_BACKSPACE.apply(this,arguments)===!1)return!1},ON_KEYDOWN_BACKSPACE:function(){},_ON_KEYDOWN_BACKSPACE_SERVICE:function(){if(this.ON_KEYDOWN_BACKSPACE_SERVICE.apply(this,arguments)===!1)return!1},ON_KEYDOWN_BACKSPACE_SERVICE:function(){},_ON_KEYDOWN_DELETE:function(){if(this.ON_KEYDOWN_DELETE.apply(this,arguments)===!1)return!1},ON_KEYDOWN_DELETE:function(){},_ON_KEYDOWN_TAB:function(){if(this.ON_KEYDOWN_TAB.apply(this,arguments)===!1)return!1},ON_KEYDOWN_TAB:function(){},_ON_KEYDOWN_SPACE:function(){if(this.ON_KEYDOWN_SPACE.apply(this,arguments)===!1)return!1},ON_KEYDOWN_SPACE:function(){},_ON_KEYDOWN_UTILITY:function(){if(this.ON_KEYDOWN_UTILITY.apply(this,arguments)===!1)return!1},ON_KEYDOWN_UTILITY:function(){},_ON_KEYDOWN_ESC:function(){if(this.ON_KEYDOWN_ESC.apply(this,arguments)===!1)return!1},ON_KEYDOWN_ESC:function(){},_ON_KEYDOWN_ARROW_UP:function(){if(this.ON_KEYDOWN_ARROW_UP.apply(this,arguments)===!1)return!1},ON_KEYDOWN_ARROW_UP:function(){},_ON_KEYDOWN_ARROW_DOWN:function(){if(this.ON_KEYDOWN_ARROW_DOWN.apply(this,arguments)===!1)return!1},ON_KEYDOWN_ARROW_DOWN:function(n,t){if(n.ecLazyService){var i=ecount.layer.getLayer(this.getLazyLayerServiceKey(n,t));if(i&&i.isShow()&&(i.setFirstFocus(),t.preventDefault(),this.gridID&&!i.isEmtpyGroup()))return!1}},_ON_KEYDOWN_ARROW_RIGHT:function(){if(this.ON_KEYDOWN_ARROW_RIGHT.apply(this,arguments)===!1)return!1},ON_KEYDOWN_ARROW_RIGHT:function(){},_ON_KEYDOWN_ARROW_LEFT:function(){if(this.ON_KEYDOWN_ARROW_LEFT.apply(this,arguments)===!1)return!1},ON_KEYDOWN_ARROW_LEFT:function(){},_ON_KEYDOWN_ARROW_RIGHT_SERVICE:function(){if(this.ON_KEYDOWN_ARROW_RIGHT_SERVICE.apply(this,arguments)===!1)return!1},ON_KEYDOWN_ARROW_RIGHT_SERVICE:function(){},_ON_KEYDOWN_ARROW_LEFT_SERVICE:function(){if(this.ON_KEYDOWN_ARROW_LEFT_SERVICE.apply(this,arguments)===!1)return!1},ON_KEYDOWN_ARROW_LEFT_SERVICE:function(){},_ON_KEYDOWN_ENTER:function(){if(this.ON_KEYDOWN_ENTER.apply(this,arguments)===!1)return!1;this.hasFnDynamicView()&&this.hideLayerByEcServiceSuffix("fn")},ON_KEYDOWN_ENTER:function(){},_ON_KEYDOWN_F1:function(){if(this.ON_KEYDOWN_F1.apply(this,arguments)===!1)return!1},ON_KEYDOWN_F1:function(){},_ON_KEYDOWN_F2:function(){if(this.ON_KEYDOWN_F2.apply(this,arguments)===!1)return!1},ON_KEYDOWN_F2:function(){},_ON_KEYDOWN_F3:function(){if(this.ON_KEYDOWN_F3.apply(this,arguments)===!1)return!1},ON_KEYDOWN_F3:function(){},_ON_KEYDOWN_F4:function(){if(this.ON_KEYDOWN_F4.apply(this,arguments)===!1)return!1},ON_KEYDOWN_F4:function(){},_ON_KEYDOWN_F5:function(){if(this.ON_KEYDOWN_F5.apply(this,arguments)===!1)return!1},ON_KEYDOWN_F5:function(){},_ON_KEYDOWN_F6:function(){if(this.ON_KEYDOWN_F6.apply(this,arguments)===!1)return!1},ON_KEYDOWN_F6:function(){},_ON_KEYDOWN_F7:function(){if(this.ON_KEYDOWN_F7.apply(this,arguments)===!1)return!1},ON_KEYDOWN_F7:function(){},_ON_KEYDOWN_F8:function(){if(this.ON_KEYDOWN_F8.apply(this,arguments)===!1)return!1},ON_KEYDOWN_F8:function(){},_ON_KEYDOWN_F9:function(){if(this.ON_KEYDOWN_F9.apply(this,arguments)===!1)return!1},ON_KEYDOWN_F9:function(){},_ON_KEYDOWN_F10:function(){if(this.ON_KEYDOWN_F10.apply(this,arguments)===!1)return!1},ON_KEYDOWN_F10:function(){},_ON_KEYDOWN_F11:function(){if(this.ON_KEYDOWN_F11.apply(this,arguments)===!1)return!1},ON_KEYDOWN_F11:function(){},_ON_KEYDOWN_F12:function(){if(this.ON_KEYDOWN_F12.apply(this,arguments)===!1)return!1},ON_KEYDOWN_F12:function(){},_ON_KEYDOWN_OTHERS:function(){if(this.ON_KEYDOWN_OTHERS.apply(this,arguments)===!1)return!1},ON_KEYDOWN_OTHERS:function(){},_ON_KEYPRESS_OTHERS:function(){if(this.ON_KEYPRESS_OTHERS.apply(this,arguments)===!1)return!1},ON_KEYPRESS_OTHERS:function(){},_ON_KEYUP_SPACE:function(){if(this.ON_KEYUP_SPACE.apply(this,arguments)===!1)return!1},ON_KEYUP_SPACE:function(){},_ON_KEYUP_BACKSPACE:function(n,t,i,r){return this._onValueDeleteShowRecommendLayer(n,t,i,r),this.ON_KEYUP_BACKSPACE.apply(this,arguments)===!1?!1:void 0},ON_KEYUP_BACKSPACE:function(){},_ON_KEYUP_DELETE:function(n,t,i,r){return this._onValueDeleteShowRecommendLayer(n,t,i,r),this.ON_KEYUP_DELETE.apply(this,arguments)===!1?!1:void 0},ON_KEYUP_DELETE:function(){},_ON_KEYUP_OTHERS:function(){if(this.ON_KEYUP_OTHERS.apply(this,arguments)===!1)return!1},ON_KEYUP_OTHERS:function(){},_ON_CHANGE_SERVICE:function(n,t,i){return i&&this.getFnItem(i.id)&&this._setValueOnServiceControl(i),this.ON_CHANGE_SERVICE.apply(this,arguments)===!1?!1:void 0},ON_CHANGE_SERVICE:function(){return!0},_ON_CLICK_SERVICE:function(n,t,i,r){var u=r.originItem,f;return this.useFnActivedItem()&&(r.oldFnActivedId=this.getFnActivedId(),this.setFnActivedId(u?u.id:r.originId)),r.type==ecount.layer.constValue.RECOMMENDDROPDOWN?r.btnType=="Reload"&&(f=ecount.global.getEcServiceInstance(n.serviceKey,ecount.layer.serviceType),ecount.layer.removeLayer(f.serviceKey),this._lazyLoadDropdown(n,t,i,r)):this.gridDataKey&&this.controlEvent&&this.controlEvent.itemClick&&(r.value=this.getValue(),this.controlEvent.itemClick(this.gridDataKey,n,t,i,r)),this._useTableRowIndex&&(r.rowIndex=this.rowIdxTable,r.useTableRowIndex=!0),this.hasFnDynamicView()&&!this.hasReadOnlyState(n.cindex)&&r.hasFn&&this.displayFnDynamicView(!1),this.isInlineMode()&&!$.isNull(r.inlineMode)&&this.setActiveInlineMode(r.inlineMode),r.type=="caretdropdown"&&this._onClickCaretDropdownList(r),!this.isCombinedControl()&&u&&u.isSimpleSearch&&(_.extend(r,{shortcutName:u.ecRole,cid:u.cid,event:t,isNotSearch:!0},this.getSimpleSearchParam(u)),u.PopupCd&&(this.isGroupware?!$.isEmpty(u.PRG_ID):u.PRG_ID)&&(r.PopupCd=u.PopupCd,r.PRG_ID=u.PRG_ID,r.MENU_SEQ=u.MENU_SEQ)),n.ecFunctionId==="_nationalFn"&&this.openPopupNationalFlag(),this.ON_CLICK_SERVICE.apply(this,arguments)===!1?!1:void 0},openPopupNationalFlag:function(){this.getNationalFlag()&&!this.isCombinedControl()&&(!this.isReadOnly()||this.getState("nationalFlag","isFnUseOnReadOnly"))&&this.getState("nationalFlag","isClickPopup")&&this.openPopup({targetID:this.id,control:this},{url:"/ECERP/SVC/eck/eck001p_05",width:500,height:600,popupType:!1,isdisplayDialCd:!0})},ON_CLICK_SERVICE:function(n,t,i,r){this.setValueFromLayer(n,t,i,r)},_ON_MOUSEOVER_SERVICE:function(){if(this.ON_MOUSEOVER_SERVICE.apply(this,arguments)===!1)return!1},ON_MOUSEOVER_SERVICE:function(){return!0},_ON_MOUSEDOWN_SERVICE:function(){if(this.ON_MOUSEDOWN_SERVICE.apply(this,arguments)===!1)return!1},ON_MOUSEDOWN_SERVICE:function(){return!0},_ON_BEFORE_MOUSEOUT_SERVICE:function(n){return this.hasReadOnlyState(n.cindex)?!1:!0},_ON_MOUSEOUT_SERVICE:function(n,t,i,r){if(this._onBeforeServiceEventExecute(n,t,i,r)===!1)return!1;var u=ecount.global.getEcServiceInstance(n.serviceKey,ecount.layer.serviceType);return!this.hasFnDynamicView()||$.isNull(u.isOnClicked)||u.isOnClicked()||this.hasFocus()||n.eventTriggerFromInternalTarget||this.displayFnDynamicView(!1),this.ON_MOUSEOUT_SERVICE.apply(this,arguments)===!1?!1:void 0},ON_MOUSEOUT_SERVICE:function(){return!0},_ON_FOCUSIN_SERVICE:function(){if(this.ON_FOCUSIN_SERVICE.apply(this,arguments)===!1)return!1},ON_FOCUSIN_SERVICE:function(){return!0},_ON_FOCUSOUT_SERVICE:function(){if(this.ON_FOCUSOUT_SERVICE.apply(this,arguments)===!1)return!1},ON_FOCUSOUT_SERVICE:function(){return!0},_ON_INPUT_SERVICE:function(){if(this.ON_INPUT_SERVICE.apply(this,arguments)===!1)return!1},ON_INPUT_SERVICE:function(){return!0},_ON_KEYDOWN_ESC_SERVICE:function(){if(this.ON_KEYDOWN_ESC_SERVICE.apply(this,arguments)===!1)return!1},ON_KEYDOWN_ESC_SERVICE:function(){return!0},_ON_KEYDOWN_ARROW_UP_SERVICE:function(){if(this.ON_KEYDOWN_ARROW_UP_SERVICE.apply(this,arguments)===!1)return!1},ON_KEYDOWN_ARROW_UP_SERVICE:function(){return!0},_ON_KEYDOWN_ARROW_DOWN_SERVICE:function(){if(this.ON_KEYDOWN_ARROW_DOWN_SERVICE.apply(this,arguments)===!1)return!1},ON_KEYDOWN_ARROW_DOWN_SERVICE:function(){return!0},_ON_KEYDOWN_ENTER_SERVICE:function(){if(this.ON_KEYDOWN_ENTER_SERVICE.apply(this,arguments)===!1)return!1},ON_KEYDOWN_ENTER_SERVICE:function(n,t,i,r){this.setValueFromLayer(n,t,i,r)},_ON_KEYDOWN_TAB_SERVICE:function(){if(this.ON_KEYDOWN_TAB_SERVICE.apply(this,arguments)===!1)return!1},ON_KEYDOWN_TAB_SERVICE:function(){return!0},_ON_KEYDOWN_UTILITY_SERVICE:function(){if(this.ON_KEYDOWN_UTILITY_SERVICE.apply(this,arguments)===!1)return!1},ON_KEYDOWN_UTILITY_SERVICE:function(){return!0},_ON_KEYDOWN_OTHERS_SERVICE:function(){if(this.ON_KEYDOWN_OTHERS_SERVICE.apply(this,arguments)===!1)return!1},ON_KEYDOWN_OTHERS_SERVICE:function(){return!0},_ON_KEYDOWN_F7_SERVICE:function(){if(this.ON_KEYDOWN_F7_SERVICE.apply(this,arguments)===!1)return!1},ON_KEYDOWN_F7_SERVICE:function(){return!0},_ON_KEYDOWN_F8_SERVICE:function(){if(this.ON_KEYDOWN_F8_SERVICE.apply(this,arguments)===!1)return!1},ON_KEYDOWN_F8_SERVICE:function(){return!0},_ON_KEYPRESS_OTHERS_SERVICE:function(){if(this.ON_KEYPRESS_OTHERS_SERVICE.apply(this,arguments)===!1)return!1},ON_KEYPRESS_OTHERS_SERVICE:function(){return!0},triggerUserHandler:function(n,t){this.__handler&&this.__handler[n]&&this.__handler[n](t,this)},empty:function(n){return $.isEmpty(n)?!1:n},_makeCommandString:function(n){var t;return $.isNull(this._useTableRowIndex)?t=_.isNil(this._makeCommand)?n||this.id:this._makeCommand:(t=this.id.substring(0,this.id.lastIndexOf("_")),$.isNull(this._makeCommand)||(t=this._makeCommand)),"on"+[this.containerName,t].select(function(n){return n.charAt(0).toUpperCase()+n.slice(1)}).join("")},setFnbuttonDisableChange:function(n){var t=this.getFunction("fn");$.isNull(n)&&(n=!1);t&&this.setState("fn","attr.disabled",n!==!1)},getIsFnbuttonDisable:function(){var n=this.getFunction("fn");return n?this.getState("fn","attr.disabled"):!1},getToggledByToolbar:function(){return this.getState(this._IT_SELF,"opt.toggledByToolbar")},setToggledByToolbar:function(n){this.setState(this._IT_SELF,"opt.toggledByToolbar",n===!1?!1:!0)},isToggleFnLayer:function(){return!this.doPreventAction()&&this._allowToggleLayer&&this.isVisible()&&!this.getIsFnbuttonDisable()},showDropdownLayer:function(){},hideDropdownLayer:function(){},hideFnDropdownItemById:function(){},showFnDropdownItemById:function(){},isSelectType:function(){},setMaxLength:function(n,t){arguments.length===1&&(t=0);$.isEmpty(n)||this.setState(t,"attr.maxlength",n)},getCookies:function(n,t){var i=$.cookie(n);return $.isEmpty(i)?!1:t?n:i.split("&")[0]},displayFnDynamicView:function(n){var n=n===undefined?!0:n;this.setState("fn","style.display",n)},hideLayerByEcServiceSuffix:function(n){var t=ecount.common.makeServiceKey(this.getEcPath(),n);ecount.layer.setOnClicked(t,!1);ecount.layer.hide(t)},hasFnDynamicView:function(){return this.fnDynamicView&&this.hasFn?!0:!1},setFnDynamicView:function(n){this.fnDynamicView=n!=!1},getSimpleSearchParam:function(n){var t={transferType:"SimpleSearch",command:"onExecuteSimpleSearch",defaultDateTab:this.defaultDateTab,searchName:this.searchDateName||"",name:this.name,__self:this},i=n.fromDate||n.FROM_DATE||"",r=n.toDate||n.TO_DATE||"";return i&&i.length==8&&(t.fromDate=ecount.control.date.strToDate(i)),r&&r.length==8&&(t.toDate=ecount.control.date.strToDate(r)),t},getSimpleSearchList:function(n){var w=ecount.control.getInitData("widget.button.simpleSearch",!1,this.ecPageID),t=w.config,s=ecount.resource,h=n||this.fnOptions,b=h.useSimpleSearchEndDate,k=h.useSimpleSearchSettingButton,d=h.useDefaultSimpleSearchActive,u=[],r={},f,i,l,a,v,y,o,e,p,c;if(this.simpleSearchConfig&&(t=this.simpleSearchConfig),(n||{}).searchList)p=ecount.constValue.simpleSearchList,s=ecount.resource,n.searchList.forEach(function(n){r={ecRole:n,id:n,label:s[p[n]]};u.push(r)});else if(t&&t.CofmDateShortCutMenuMappingButtons&&t.Is_ScMode){if(l=t.PopupCd,a=t.PRG_ID,v=t.MENU_SEQ,y=k!=!1&&t.IsSettingButton,f=t.CofmDateShortCutMenuMappingButtons,!_.isArray(f)||f.length==0)return u;for(o=0;o<f.length;o++)i=f[o],e=i.U_SHORTCUT_NM||i.SHORTCUT_NM,b!=!0&&["endDay","endMonth"].contains(e)||(r={cid:this.id,id:e,ecRole:e,value:e,label:i.USER_TITLE,fromDate:i.FROM_DATE,toDate:i.TO_DATE,active:d!=!1&&i.IS_DEFAULT,isSimpleSearch:!0},u.push(r));y&&(c="settingButton",r={ecRole:c,id:c,label:s.LBL01593,PopupCd:l,PRG_ID:a,MENU_SEQ:v,isSimpleSearch:!0},u.push(r))}return u}});ecount.control.cachedDummyControl={};ecount.control.getInitData=function(n,t,i){var r,u,f,e;try{f=ecount.global.findViewBag(i);f&&(u=f.WidgetDatas);u&&(r=_.extend({},u[n]),r&&r.result&&(e=Object.clone(r.result,!0),delete r.result,r.result={Data:e}))}catch(o){console.log(o)}return r};ecount.control.initializeByUserSetting=function(n,t){var i=widget.generator.control(),r;i.define(t.controlType,t.id,t.name,t.subTitle,t.groupId,t.option);t.formset&&i.setOptions({formset:t.formset});t.searchItemCode&&i.setOptions({searchItemCode:t.searchItemCode});t.pcid?n(t.id,i,t.pcid):n(t.id,i);i.getOptions("_originId")&&_.isEmpty(i.getOptions("data"))&&_.isArray(t.data)&&t.data.length>0&&i.setOptions({data:t.data});i=i.end();for(r in i)if(i[r]!==undefined){if(r==="data"&&i[r]&&i[r].length===0)continue;t[r]=r==="data"?i[r]&&i[r].where(function(n){return $.isEmpty(n.isFnData)||n.isFnData==!1}):i[r]}};ecount.control.registerLazyRenderGrid=function(n,t){n._super?ecount.global.executeCallbak(n.ecPageID,ecount.widget.LAZY_RENDER_CONTROL_GRID,function(){n._lazyRender&&(n._lazyRender.call(n),n._lazyRender=null);t.call(n)}):n._lazyRender&&(n._lazyRender.call(n),n._lazyRender=null)};ecount.control.registerLazyRender=function(n,t){n._super?ecount.global.executeCallbak(n.ecPageID,ecount.widget.LAZY_RENDER_CONTROL,function(){n._lazyRender&&(n._lazyRender.call(n),n._lazyRender=null);t.call(n)}):n._lazyRender&&(n._lazyRender.call(n),n._lazyRender=null)};ecount.control.lazyLoad=function(n){var f=ecount.common.isExistNamespace(n),u,o;if(f==!1||f._export){var t=n.split("."),e=t.slice(0),i=ecount.common.createNamespace(t.shift()+"."+t.shift()),r=ecount.common.createNamespace(e.shift()+".view."+e.shift());i._export&&(i.repository=_.extend({},i._export()),i._export=null);r&&r._export&&(r.repository=_.extend({},r._export()),r._export=null);t.length>1&&!i[t.join(".")]?(u=t.slice(0),o=u.pop(),i.repository.create(u.join(".")),i.repository.create(ecount.common.createNamespace(n.split(".").slice(0,3).join(".")),o,t.join("."))):i.repository.create(t.join(".")==""?null:t.join("."))}};ecount.control.mountWidget=function(n,t,i,r){var u=n.prototype.ecPackage.split("."),e=u[0]=="widget"&&u.length==2?[u.shift(),"view",u.join(".")].join("."):[u.shift(),u.shift(),"view",u.join(".")].join("."),f=ecount.common.createNamespace(e);r.init||(r.init=function(){n.prototype.init.apply(this,arguments)});r.createView||(r.createView=function(){if(!this.viewName)return n.prototype.createView.apply(this,arguments);var i=this.viewName.split("."),u=i.pop(),r=i.join("."),t=ecount.common.createNamespace(i.join(".")).repository[u];return t!="function"&&(t.__inheritParent&&(t.__inheritParent.indexOf(r)>-1?t=ecount.control.getMergedWidgetProperty(t,r):f=ecount.common.createNamespace(t.__inheritParent)),t=$.Class(f,t)),this.ecview=new t});r.render||(r.render=function(){n.prototype.render.apply(this,arguments)});n[t]=$.Class(i,r)};ecount.control.mountMixinWidget=function(n,t,i,r){var e=r[0],u=r[1],o=r[2],f=ecount.common.createNamespace(i).repository,s;o&&(s=t.__inheritParent?ecount.common.createNamespace(t.__inheritParent):n,e[u]=$.Class(s,f[u]),t=f[o]);t.__inheritParent&&(~t.__inheritParent.indexOf(i)?(f.create(t.__inheritParent.split(".").pop()),t=ecount.control.getMergedWidgetProperty(t,i)):n=ecount.common.createNamespace(t.__inheritParent));ecount.control.mountWidget(e,u,n,t)};ecount.control.getMergedWidgetProperty=function(n,t){for(var i=Object.clone(n),e=ecount.common.createNamespace(t).repository,u=[],f,r;i.__inheritParent&&!~u.indexOf(i.__inheritParent)&&~i.__inheritParent.indexOf(t);)f=i.__inheritParent.split("."),r=e[f.pop()],u.push(i.__inheritParent),r&&r.__inheritParent&&(i.__inheritParent=r.__inheritParent),i=_.extend({},r,i);return i};ecount.control.loadRepository=function(n,t,i){for(var u=i.split("."),s=[u.shift(""),"view",u.join(".")],r,e,f,o,h,c,u=i.split(".");u.length>1;)r=(r?r:window)[u.shift()];while(s.length>1)f=(f?f:window)[s.shift()];e=u.shift();o=s.shift();h=$.Class(n,r[e].repository._default);c=$.Class(t,f[o].repository._default);r[e]=$.extend(h,r[e]);r[e]._baseLoaded=!0;f[o]=$.extend(c,f[o])};ecount.control.storeReloadTarget=function(n){var t=ecount.common.isExistNamespace(n);t!==!1&&(ecount.control.storeReloadTarget[n]=!0)};ecount.control.reloadRepository=function(n){var t=ecount.control.storeReloadTarget[n];t&&(ecount.control.lazyLoad(n),delete ecount.control.storeReloadTarget[n])};ecount.control.template={input:'<input type="text" {{attr.inputmode}} class="form-control {{style.css}} {{style.display}}" {{findex}} data-index={{index}} data-cid="{{cid}}" data-ecpath="{{ecPath}}" {{ecService}} {{ecServiceAttr}} {{ecLazyService}} placeholder="{{attr.placeholder}}" {{attr.disabled}} {{attr.readonly}} {{attr.maxlength}} value="{{value}}">',inputFn:'<div class="input-group {{style.display}}">((input))((fn))<\/div>',inputDate:'<input type="text" {{attr.inputmode}} class="form-control {{style.display}}" data-index={{index}} data-role-index="{{index}}" data-cid="{{cid}}" value="{{value}}" style="{{css.style}}" {{attr.disabled}} {{attr.maxlength}}>',inputPassword:'<input type="password" autocomplete="new-password" class="{{style.css}} {{style.display}}" placeholder="{{attr.placeholder}}" data-index={{index}} data-cid="{{cid}}" value="{{value}}" {{attr.maxlength}}  {{attr.readonly}} > ',inputColLabel:"((label))((divider))((input))",textarea:'<textarea rows="{{rows}}" class="form-control {{style.display}}" {{findex}} data-index={{index}} data-cid="{{cid}}" wrap="hard" placeholder="{{attr.placeholder}}" {{attr.readonly}} {{ecServiceAttr}} {{ecLazyService}} style="{{css.style}}">{{value}}<\/textarea>',textareaFn:'<div class="input-group {{style.display}}">((textarea))((fn))<\/div>',selectFn:'<div class="input-group {{style.display}}">((select))((fn))<\/div>',linkFn:'<div class="input-group {{style.display}}">((link))((fn))<\/div>',radio:'<span class="form-radio {{style.css}} {{style.display}}" data-cid="{{cid}}"><input type="radio" value="{{value}}" data-cid="{{cid}}" name="{{attr.name}}" {{findex}} data-index="{{index}}" id="{{attr.labelid}}" {{attr.checked}} {{attr.disabled}}><label  data-role="widget-focus" for="{{attr.labelid}}" data-cid="{{cid}}">{{label}}<\/label><\/span>',"radio-origin":'<input type="radio" value="{{value}}" data-cid="{{cid}}" name="{{name}}" {{findex}} data-index="{{index}}"  {{checked}}>{{label}}',"radio-vertical":'<input type="radio" value="{{value}}" data-cid="{{cid}}" name="{{name}}" {{findex}} data-index="{{index}}"  {{checked}}>{{label}}',"radio-span":'<span class="form-radio form-radio-icon {{style.display}}" data-cid="{{cid}}"><input type="radio" value="{{value}}" data-cid="{{cid}}" name="{{name}}" {{findex}} data-index="{{index}}" id="{{attr.labelid}}" {{attr.checked}} {{attr.readonly}} {{attr.disabled}} ><label data-role="widget-focus" for="{{attr.labelid}}" data-cid="{{cid}}"><span class="{{style.iconcss}}" data-cid="{{cid}}"><\/span><span class="{{style.labelcss}}" data-txtlabel="">{{label}}<\/span><\/label><\/span>',"radio-image":'<button id="{{id}}" class="{{style.css}} {{label}} {{style.active}} {{style.display}}" {{findex}} data-index={{index}} data-cid="{{cid}}"><\/button>',"radio-square":'<div class="checkbox-squared-fill {{style.css}} {{style.display}}" data-cid="{{cid}}"><input type="radio" value="{{value}}" data-cid="{{cid}}" name="{{attr.name}}" {{findex}} data-index="{{index}}" id="{{attr.labelid}}" {{attr.checked}} {{attr.disabled}}><label  data-role="widget-focus" for="{{attr.labelid}}" data-cid="{{cid}}"><\/label><\/div>',"radio-noLabel":'<span class="{{style.css}} {{style.display}} form-radio-text-no" data-cid="{{cid}}"><input type="radio" value="{{value}}" data-cid="{{cid}}" name="{{name}}" {{findex}} data-index="{{index}}" id="{{labelID}}" {{checked}}><label  data-role="widget-focus" for="{{labelID}}" data-cid="{{cid}}"><\/label><\/span>',"radio-labelColor":'<span class="{{style.css}} {{style.display}}" data-cid="{{cid}}" style="color:\'{{color}}\'"><input type="radio" value="{{value}}" data-cid="{{cid}}" name="{{attr.name}}" {{findex}} data-index="{{index}}" id="{{attr.labelid}}" {{attr.checked}} {{attr.readonly}} {{attr.disabled}}><label  data-role="widget-focus" for="{{attr.labelid}}" data-cid="{{cid}}" {{ecService}}>{{label}}<\/label><\/span>',"radio-thumbnail":'<span class="form-radio {{style.display}}" data-cid="{{cid}}"><input type="radio" value="{{value}}" data-cid="{{cid}}" name="{{name}}" {{findex}} data-index="{{index}}" id="{{attr.labelid}}" {{attr.checked}}><label data-role="widget-focus" for="{{attr.labelid}}" data-cid="{{cid}}"><img class="{{style.css}}" src="{{src}}" style="width: {{style.inline}}"><\/label><\/span>',checkbox:'<span class="{{style.css}}" data-cid="{{cid}}"><input type="checkbox" value="{{value}}" data-cid="{{cid}}" data-role="{{ecRole}}"name="{{attr.name}}" {{findex}} data-index="{{index}}" id="{{attr.labelid}}" class="{{style.display}}" {{attr.checked}} {{attr.readonly}} {{attr.disabled}}><label data-role="widget-focus" for="{{attr.labelid}}" data-cid="{{cid}}" class="{{style.display}}">{{label}}<\/label><\/span>',"checkbox-numbered":'<span class="{{style.divcss}} {{style.display}}"><input type="checkbox" value="{{value}}" data-cid="{{cid}}" name="{{name}}" {{findex}} data-index="{{index}}" id="{{attr.labelid}}" {{attr.checked}} {{attr.disabled}}/><div class="checkbox-numbered {{style.checked}} {{style.disabled}}" data-cid="{{cid}}">{{num}}<\/div>{{label}}<\/span>',"checkbox-plain":'<span class="form-checkbox form-checkbox-text-no {{style.display}}"><input class="{{style.checklayercss}}" type="checkbox" value="{{value}}" data-cid="{{cid}}" name="{{name}}" {{findex}} data-index="{{index}}" id="{{labelID}}" {{attr.checked}} {{attr.readonly}} {{attr.disabled}}><label data-role="widget-focus" for="{{labelID}}">{{label}}<\/label><\/span>',"checkbox-origin":'<input type="checkbox" value="{{value}}" data-cid="{{cid}}" name="{{name}}" {{findex}} data-index="{{index}}" id="{{labelID}}" {{checked}}><label  data-role="widget-focus" for="{{labelID}}"><\/label>',"checkbox-link":'<label  data-role="widget-focus" for="{{labelID}}"><a href="{{attr.href}}" {{attr.target}} {{findex}} data-index={{index}} id="{{id}}" data-cid="{{cid}}" class="{{style.css}} {{style.display}}">{{label}}<\/a><\/label>',"checkbox-square":'<div class="checkbox-squared-fill" data-cid="{{cid}}"><input type="checkbox" value="{{value}}" data-cid="{{cid}}" name="{{name}}" {{findex}} data-index="{{index}}" id="{{labelID}}" {{checked}}><label data-role="widget-focus" for="{{labelID}}" data-cid="{{cid}}" for="{{labelID}}"><\/label><\/div>',label:'<span style="{{style}} {{style.bgcolor}} {{style.color}}" data-index="{{index}}" data-value="{{attr.data-value}}" {{ecService}} class="{{style.css}} {{style.display}}">{{label}}<\/span>',"label-div":'<div id="{{id}}" name="{{name}}" class="{{style.css}} {{style.display}}" ><span style="{{style}}" class="{{labelCSS}}" data-index={{index}}>{{label}}<\/span><\/div>',"label-div1":'<div id="{{id}}" name="{{name}}" data-index={{index}}><\/div>',"label-div2":'<div id="{{id}}" name="{{name}}" data-index={{index}}>{{label}}<\/div>',"label-iframe":"{{label}}",link:'<a href="{{attr.href}}" {{attr.target}} {{findex}} data-index={{index}} id="{{id}}" data-cid="{{cid}}" class="{{style.css}} {{style.display}} {{css.disabled}} " style="{{style}} {{style.color}} {{style.bgcolor}}" data-role="{{ecRole}}" data-role-index="{{ecRoleIndex}}" data-toggle=\'{{data-toggle}}\' {{ecService}} {{ecServiceTrigger}} {{ecServiceAttr}}>{{label}}<\/a>',"link-arrow":'<a href="{{attr.href}}" {{attr.target}} {{findex}} data-index={{index}} id="{{id}}" data-cid="{{cid}}" class="{{attr.collapse}} {{style.css}} {{style.display}}" data-role="{{ecRole}}" data-role-index="{{ecRoleIndex}}" data-toggle=\'{{data-toggle}}\' {{ecService}} {{ecServiceAttr}}><span class="collapse-arrow" data-cid="{{cid}}" data-toggle=\'{{data-toggle}}\' data-role=\'dataToggle\'><\/span>{{label}}<\/a>',"link-caret":'<a href="{{attr.href}}" data-index="{{index}}" id="{{id}}" data-cid="{{cid}}" class="{{style.css}} {{style.display}}">{{label}}<span class="fa fa-caret-{{style.direction}}"><\/span><\/a>',"link-icon":'<a href="{{attr.href}}" data-index="{{index}}" id="{{id}}" data-cid="{{cid}}" class="{{style.css}} {{style.display}} {{style.labelcss}}">{{label}}<span data-cid="{{cid}}" data-index="{{index}}" class="{{style.iconcss}} {{style.preventPointer}}"><\/span><\/a>',"link-iconPopover":'<div class="option"><a href="{{attr.href}}" data-index="{{index}}" data-cid="{{cid}}" class="{{style.iconcss}}"><\/a><\/div><a href="{{attr.href}}" data-index="{{index}}" id="{{id}}" data-cid="{{cid}}" class="{{style.css}} {{style.display}} {{style.labelcss}}">{{label}}<\/a>',button:'<button  id="{{id}}" class="{{style.css}} {{style.display}} {{attr.disabled}}" {{findex}} data-index={{index}} data-cid="{{cid}}" data-ecpath="{{ecPath}}" data-role="{{ecRole}}" {{ecService}} {{ecServiceAttr}} {{ecServiceTrigger}} >{{label}}<\/button>',select:'<button {{ecService}} data-index="{{index}}" data-role="{{ecRole}}" data-role-index="{{index}}" data-cid="{{cid}}" class="{{style.css}} {{style.display}} {{attr.disabled}}"><div class="selectbox-label">{{selectedLabel}}<\/div><\/button><input type="text" {{attr.inputmode}} data-service="{{ecService.input}}" data-cid="{{cid}}" data-index="{{index}}" data-role="{{ecRole}}" data-role-index="{{index}}" {{attr.maxlength}} class="hidden form-control select-direct-input" {{attr.disabled}}>',"select-input":'<button {{ecService}} data-index="{{index}}" data-role="{{ecRole}}" data-role-index="{{index}}" data-cid="{{cid}}" class="hidden btn btn-default btn-selectbox {{style.css}} {{style.display}} {{attr.disabled}}"><div class="selectbox-label">{{selectedLabel}}<\/div><\/button><input type="text" {{attr.inputmode}} data-service="{{ecService.input}}" data-cid="{{cid}}" data-index="{{index}}" data-role="{{ecRole}}" data-role-index="{{index}}" {{attr.maxlength}} class="form-control select-direct-input" {{attr.disabled}}>',"select-image":'<button {{ecService}} data-index="{{index}}" {{findex}} data-role="{{ecRole}}" data-role-index="{{index}}" data-cid="{{cid}}" class="btn btn-default btn-selectbox {{style.css}} {{style.display}} {{attr.disabled}}"><div class="selectbox-label">{{selectedLabel}}<\/div><\/button>',code:'<span class="tag label label-primary label-light {{style.display}}" data-label="{{label}}" data-code="{{value}}">{{label}}<span class="tag-remove"><\/span><\/span>',sideLabel:'(<span class="{{style.css}} {{style.display}}" data-cid="{{cid}}"><input type="checkbox" value="{{value}}" data-cid="{{cid}}" name="{{name}}" data-index="{{index}}" id="{{attr.labelid}}" data-role="{{ecRole}}" {{attr.checked}}><label  data-role="widget-focus" for="{{attr.labelid}}" data-cid="{{cid}}">{{label}}<\/label><\/span>)',sideLabelCode:'<span class="control-inline {{style.display}}"><span class="form-checkbox"><span>&nbsp;<\/span><input type="checkbox" {{findex}} data-index="{{index}}" data-role="{{ecRole}}" data-cid="{{cid}}" tabindex="0" id="{{attr.labelid}}" {{attr.checked}} {{attr.readonly}} {{attr.disabled}} /><label data-role="{{ecRole}}" for="{{attr.labelid}}">{{label}}<\/label><\/span><\/span>',fn:'<button type="button" class="btn btn-default btn-fn dropdown-toggle fn {{style.css}} {{style.display}}" data-function="fn" data-service="layer.fn" data-service-attr="layer.fixed" data-cid="{{cid}}"><\/button>',dateFn:'<button type="button" class="btn btn-sm btn-default btn-fn dropdown-toggle fn {{style.css}} {{style.display}}"  data-service="layer.fn" data-service-attr="layer.fixed" data-cid="{{cid}}"><\/button>',colxs:'<div class="col-xs-{{column}}"><\/div>',colms:'<div class="col-sm-{{column}}"><\/div>',category:'<div class="col-xs-{{column}} {{style.display}}"><div class="panel panel-default"><div class="list-group" CATEGORY_DEPTH={{depth}}><\/div><\/div><\/div>',codeDropdown:'<div class="control-inline {{style.display}}"><div class="btn-group link-group"><a href="javascript:;" {{ecService}}><\/a><\/div><\/div>',codeSearchInput:'<input type="text" {{attr.inputmode}} class="{{style.css}} {{style.display}}" data-cid="{{cid}}" data-index={{index}} {{ecService}} {{ecServiceAttr}} {{ecLazyService}} placeholder="{{attr.placeholder}}" {{attr.readonly}} {{attr.disabled}} value="{{value}}" />',codeCaretDropdown:'<button class="btn btn-default dropdown-toggle btn-arrow btn-vertical-top {{style.display}}" data-service="{{ecService}}" data-service-attr="layer.fixed"><\/button>',codeInput:'<input type="text" {{attr.inputmode}} class="{{style.css}} {{style.display}}" data-index={{index}} data-cid="{{cid}}" {{ecService}} {{ecServiceAttr}} {{ecLazyService}}  placeholder="{{attr.placeholder}}" {{attr.readonly}} {{attr.disabled}} value="{{value}}"/>',codeHidden:'<input type="hidden"  data-index={{index}} data-cid="{{cid}}" value="{{value}}"  />',codeSearchButton:'<button class="btn btn-default btn-code-search {{style.display}}" data-function="{{ecFunction}}" data-function-id="{{ecFunctionId}}" data-cid="{{cid}}"><\/button>',divider:'<span class="inline-divider"><\/span>',singleControl1:"((codeInput))[[openpopup]]((codeInput))[[fn]]",singleControl2:"((codeInput))((codeInput))[[fn]]",singleControl3:"((codeInput))((codeHidden))[[fn]]",singleControl4:"((codeInput))((codeHidden))[[openpopup]][[fn]]","singleControl4-sm":"[[openpopup]]((codeInput))((codeHidden))[[fn]]",singleControl5:"[[openpopup]]((codeInput))((codeHidden))[[removeall]][[fn]]",singleControl6:"((codeInput))[[openpopup]]((codeInput))[[fn]]",singleControl7:"[[openpopup]]((codeInput))((codeHidden))",singleControl11:"((codeInput))((codeHidden))[[openpopup]][[fn]]","layer-select":'<ul data-service="layer.selectbox" data-servicekey= "{{serviceKey}}" data-notclear="mousedown" class="dropdown-menu {{style.css}} dropdown-menu-selectbox" style="{{style}}" data-index="{{index}}" data-ownerkey={{ownerKey}}>{{listItemHtml}}<\/ul>',"layer-select-editNewMode":'<div data-service="layer.selectbox" data-servicekey= "{{serviceKey}}" data-notclear="mousedown" class="dropdown-menu {{style.css}} position-fixed" style="{{style}}" data-index="{{index}}" data-ownerkey={{ownerKey}}>{{headerTemplate}}<ul class="dropdown-menu-item {{hiddenItem}}">{{listItemHtml}}<\/ul>{{footerTemplate}}<\/div>',"layer-datepicker":'<div data-service="layer.datepicker" data-service-attr="layer.focusable" data-servicekey= "{{serviceKey}}" class="hidden" data-ownerkey={{ownerKey}} data-notclear="mousedown"><\/div>',"layer-spectrum":'<div data-service="layer.spectrum" data-servicekey= "{{serviceKey}}" data-ownerkey="{{ownerKey}}"><\/div>',"layer-autocomplete":'<ui data-service="layer.autocomplete" data-servicekey= "{{serviceKey}}" data-ownerkey="{{ownerKey}}" style="{{style}}" tabindex="0" class="ui-autocomplete ui-front ui-menu ui-widget ui-widget-content ui-corner-all dropdown-menu">{{listItemHtml}}<\/ui>',listedItem:'<li><a href="{{attr.href}}" data-cid="{{cid}}" data-index="{{index}}" class="{{style.css}}">{{label}}<\/a><\/li>',sidelink:'<span class="inline-divider {{style.display}}" data-for="{{ecRole}}"><\/span>&nbsp;<a href="{{attr.href}}" data-cid="{{cid}}" data-index="{{index}}" data-role="{{ecRole}}" class="{{style.display}}"><span data-cid="{{cid}}"  class="{{style.css}}" data-role="{{ecRole}}">{{label}}<\/span><\/a>',itemList:"((select))((link))((link))",image:'<img id="{{id}}" src="{{src}}">',nationalFlag:'<img class="{{style.css}} {{style.display}}" data-function="{{function}}" src="{{nationalFlagBaseUrl}}{{nationalCode}}.png">',addonPopover:'<span class="{{style.css}}" data-function="{{function}}"><\/span>',litem:'<li {{findex}} data-index="{{index}}" data-cid="{{cid}}" class="{{isactive}}" data-menuid="{{id}}"><span  class="customer-support-icon {{style.css}}"><\/span>{{title}}<\/li>',litem2:'<li {{findex}} data-index="{{index}}" data-cid="{{cid}}" class="{{isactive}}" data-menuid="{{id}}"><a href="#">{{title}}<\/a><\/li>',scorebox:'<div class="{{style.css}}" data-index={{index}}><div class="score-box-heading" data-index={{index}}>{{value}}<\/div><div class="score-box-body" data-index={{index}}>{{label}}<\/div><\/div>',flowSlide:'<div class="label-group label-group-hover {{style.css}} {{style.noEllipsis}} {{style.display}}"><span id="{{id}}" data-index="{{index}}" data-cid="{{cid}}" {{ecService}} {{ecServiceAttr}} {{color}} class="label {{style.buttonType}}">{{label}}<\/span><\/div>',gridView:'<div class="wrapper-toolbar"><span class="label label-default label-light">((this.title))<\/span><span>((this.label))<\/span><\/div>',pagination:"",jstree:""};ecount.class("ecount.control.button","ecount.control",{ecPackage:"ecount.control.button",isButtonType:!0,_defaultCss:"btn btn-default",toggleIconCss:"btn-ouline-none btn-state-change",init:function(){ecount.control.prototype.init.apply(this,arguments)},initializeOptions:function(n){n.data&&n.data[0]&&n.data[0].css&&(this._userCss=n.data[0].css);$.extend(this,{_isSmall:n._isSmall,hasDropdown:n.hasDropdown,dropdownAdditionalOptions:n.dropdownAdditionalOptions,dropdownOptions:n.ownDropdownOptions||n.dropdownOptions,onClick:n.onClick,_clickOnce:n._clickOnce})},render:function(){ecount.control.prototype.render.apply(this,arguments)},onInitComponent:function(n,t,i,r,u){u.noActionBtn&&(r["style.css"]+=u.buttonArrowDirection==="up"?" btn-arrow btn-arrow-up":u.buttonArrowDirection==="down"?" btn-arrow btn-arrow-down":" btn-arrow btn-arrow-up");t==0&&((u._inline||u._isSmall)&&(r["style.css"]+=" btn-sm"),u._fixWidth&&(r["style.css"]+=" btn-width-auto"));u.isPrimary&&(r["style.css"]=r["style.css"].replace("default","primary"));u.hasDropdown?(r.ecService="layer.dropdown",r.ecServiceAttr="layer.fixed"):(r.ecService="",r.ecServiceAttr="",r.ecServiceTrigger="");u._clickOnce&&(r["opt.preventClick"]=!1);_.isEmpty(r.label)&&(r.label="");switch(u.iconType){case"toggle":r["style.css"]+=" btn-ouline-none btn-state-change";break;case"arrowUp":r["style.css"]+=" btn-ouline-none btn-arrow btn-arrow-up";break;case"arrowDown":r["style.css"]+=" btn-ouline-none btn-arrow btn-arrow-down"}},onAfterRender:function(){ecount.control.prototype.onAfterRender.apply(this,arguments)},validate:function(n,t){return this._executeValidateIfVisible&&!this.isVisibleElement(0)?[]:this.checkValidate(n,t)},checkValidate:function(n,t){var i=n||this.dataRules;return $.isNull(i)?[]:i[0]&&i[0].permission?ecount.validator.validate(i,t||this.dataRulesMsg):[]},getLayerServiceKey:function(n){var t=this._layerKey||n.cindex;return ecount.common.makeServiceKey(n.ecPath,t)},getLayerDropdownOption:function(n,t){return $.extend(this.getLayerDefaultOption(n,t),{items:this.dropdownOptions||[],boundary:this.getContainerBoundary(),baseType:!0,cid:n.cid,_forcedDisplayPosition:this.containerName=="footer"?"top":"",cindex:n.cindex},this.dropdownAdditionalOptions)},setAllowClick:function(n){this.setState(n||0,"opt.preventClick",!1)},isAllowClick:function(n){if($.isNull(n)){for(var t=0,i=this.getComponents().length;t<i;t++)if(this.getState(t,"opt.preventClick"))return!1;return!0}return this.getState(n,"opt.preventClick")},destroy:function(){ecount.control.prototype.destroy.apply(this,arguments)},changeLabel:function(n,t){this.setState(t||0,"label",n)},changeClass:function(n,t){this.setState(t||0,"style.css",n)},getValue:function(){},setClickOnce:function(n){this._clickOnce=n},isUsedClickOnce:function(){return!!this._clickOnce},ON_CLICK:function(n,t,i,r){var f=n.cindex,e=this.getLayerServiceKey(n,t),u;if(this._clickOnce){if(this.isAllowClick()!=!0)return!1;$.isNull(f)||this.setState(f,"opt.preventClick",!0)}if(this.dataRules&&(u=this.validate(),u.length>0))return ecount.alert(u[0].message),!1;if($.extend(r,{cid:n.cid,cindex:n.cindex,cname:this.name,containerName:this.containerName,event:t,__self:this}),this.onClick){r.type="button.click";this.onClick(r)}return this.isPostClick&&this.onPostClick&&this.onPostClick(r),!0}});ecount.class("ecount.layer.dropdown","ecount.layout.layer",{template:'<ul class="dropdown-menu {{css}}" data-service="service.layer" data-servicekey="{{serviceKey}}" data-ownerkey="{{ownerKey}}" style="{{style}}"/>',newFormTemplate:'<div class="dropdown-menu {{css}}" data-service="service.layer" data-servicekey="{{serviceKey}}" data-ownerkey="{{ownerKey}}" style="{{style}}"/>',dropdownMenuFooterTemplate:'<div class="dropdown-menu-footer"><a class="text-bold" href="javascript:;" data-service="service.layer" data-function-id="{1}" data-function-section="footer" data-value="new">{0}<\/a><\/div>',formSettingTemplate:'<div class="wrapper-popover-dropdown-menu left show {{css}}" data-service="service.layer" data-servicekey="{{serviceKey}}" data-ownerkey="{{ownerKey}}" style="{{style}}"><div class="arrow"><\/div>{0}<\/div>',serviceType:"layer",serviceName:"dropdown",css:"",mouseoverClass:"",items:null,_isShow:!1,itemList:null,baseType:!1,ownerKey:null,cindex:null,cid:null,_commandPrefix:"dropdown",_templateType:null,_onClicked:!1,withRemoveBtn:!1,resizeDropDownLayerWidth:!1,dottedUnderlineLayerOption:!1,init:function(){ecount.layout.prototype.init.apply(this,arguments);this.itemList=[];this.owner=this.getOwnerInstance()},getEcPath:function(){return this.ecPath},getEcIKey:function(){return this.ecIKey},setEcIKey:function(){this.ecIKey=ecount.global.registerEcServiceInstance(this,this.serviceType)},getOwnerKey:function(){return this.ownerKey},render:function(n){this.setMinimalize();this.setTemplate();this.items.length==0&&(this.hidden=!0);ecount.layout.prototype.render.call(this,n);this.items&&this.addItems(this.items.toArray(),this.$el)},setMinimalize:function(){function i(n,t,i){return n.substr(0,t-i-3)+"..."+n.substr(i*-1)}if(!$.isNull(this.minimalize))for(var n,t=0,r=this.items.length;t<r;t++)n=this.items[t],n.reducedLabel=n.label.length>this.minimalize.maxLen?i(n.label,this.minimalize.maxLen,this.minimalize.suffixLen):n.label},setTemplate:function(){var n=[];this.isNotFixedLayer||this.templateType=="droprightArrow"||n.push("position-fixed");this.hasDropdownLayerIcon&&n.push("dropdown-menu-icon-list");this.isSetDropdownSize&&n.push("dropdown-menu-fixed-height");this.type==="fn"&&n.push("dropdown-menu-fn");this.items.some(function(n){return n.isShowChecked})&&n.push("dropdown-menu-checked-list");this.reportType&&n.push("dropdown-menu-icon-list dropdown-menu-report");this.dottedUnderlineLayerOption&&n.push("dropdown-menu-label-group");var t=this.items.filter(function(n){return n.id==="newForm"}),i=this.items.filter(function(n){return n.section==="footer"}),u=this.items.filter(function(n){return n.section==="formSetting"}),r=this.items.filter(function(n){return n.isChildDepth===!0});$.isEmpty(t)&&$.isEmpty(i)?$.isEmpty(u)||(this.template=String.format(this.formSettingTemplate,this.template)):(this.template=this.newFormTemplate,this._templateType="newForm");this.templateType=="droprightArrow"&&(this.template=String.format(this.formSettingTemplate,this.template));(!r&&this.isSetDropdownSize||!r&&this.isSetDropdownSize!==!1&&this.type==="fn"&&this.items.length>7&&$.isEmpty(t)&&$.isEmpty(i))&&n.push("dropdown-menu-fixed-height");this.css=ecount.convertor.uniqSumClass(this.css,n.join(" "));this.template=ecount.widget.replaceAttr(this.template,{css:this.css,style:this._getStyle(),serviceKey:this.getEcIKey(),ownerKey:this.getOwnerKey()})},_getStyle:function(){var n="";return this.minWidth&&(n+=["min-width:",this.minWidth,"px"].join("")),n},_bindEvent:function(){this.$el.find("a > span.close").bind("click",function(n){this.removeItem(n.currentTarget.getAttribute("list-id"));n.preventDefault();n.stopPropagation()}.bind(this))},destroy:function(){this.hide();this.removeItems();this.$el&&this.$el.length>0&&(ecount.widget.removeChild(this.$el[0]),this.$el=null,delete this.$el)},_getControlTypeItem:function(n){var i,r=this._getPcid(),t;if(options={},n.ecPageID=this.ecPageID,n.containerName=this.containerName,n.tabID=this.tabID,n.gridID=this.gridID,n.delegator=this.delegator,n.data)for(t=0;t<n.data.length;t++)n.data[t].pcid=r;return i=ecount.common.createNamespace(n.controlType),new i(n)},_getDefaultLiTemplate:function(n,t){var i,u=this._getOptionCssTemplate(n),r=[n.liCss||"",u].join(" ").trim();return i=n.isDropdownTabItem===!0?String.format("<li id={0} data-isDropdownTabItem='true' class=\"{{css}}\" {{childItem}}>",n.id):'<li class="{{css}}" {{childItem}}>',i=n.childItems?i.replace(/{{childItem}}/g,'data-childItem="childItem_'+t+'"'):i.replace(/{{childItem}}/g,""),n.isShowChecked&&(r=ecount.convertor.uniqSumClass(r,"checked-item")),i.replace(/{{css}}/g,r)},_getPcid:function(){return this.ppcid?this.ppcid:this.pcid||""},_getCssTemplate:function(n){var t=[n.css,n.hide?"hidden":"",n.active?"active":""].join(" ").trim();return _.isBoolean(this.resizeDropDownLayerWidth)&&this.resizeDropDownLayerWidth&&(t+=" text-center"),t},_getOptionCssTemplate:function(n){var t=[n.hide?"hidden":"",n.active?"active":""].join(" ").trim();return _.isBoolean(this.resizeDropDownLayerWidth)&&this.resizeDropDownLayerWidth&&(t+=" text-center"),t},_getAttrDropdownTabItemTemplate:function(n){return n.isDropdownTabItem===!0?String.format("data-isDropdownTabItem='true' data-parentTabID='{0}'",n.parentTabID):""},_getBaseTypeListedItem:function(n,t){var i=this._getCssTemplate(n),r=this._getDefaultLiTemplate(n,t),u=this._getAttrDropdownTabItemTemplate(n);return $(r+(n.isFooter?'<div class="dropdown-menu-footer">':"")+'<a class="'+i+'" href="javascript:;" '+u+' data-trigger="click" data-service="service.layer" data-click-id="'+(n.clickId||"")+'" data-function-id="'+n.id+'" data-value="'+(n.value||"")+'" data-fixedFooter="'+(n.isFixedFooter||"")+'" originid="'+n.id+'">'+n.label+"<\/a>"+(n.isFooter?"<\/div>":"")+"<\/li>")},_getLiTemplate:function(n){return["{{liTemplate}}",n.isEditFormMode?'<span data-value="{{editValue}}" data-role-id="editForm" data-function="editForm" data-function-id="editForm" data-service="service.layer" data-is-edit="true" class="dropdown-menu-item-edit"><\/span>':"",'<a href="javascript:;" {{attrDropdownTabItem}}','data-toggle="tooltip" {{aCss}}','data-placement="left"  data-function-id="{{id}}"','data-click-id="{{clickId}}"','data-service="service.layer"','data-dualStep="{{dualStep}}"','data-dualControlId="{{dualControlId}}"','data-inlineMode="{{inlineMode}}"','data-value="{{value}}" data-originLabel="{{originLabel}}">{{anchorSpanInside}}{{label}}{{removeBtn}}<\/a><\/li>'].join(" ")},_getListedItemGroup:function(n){var t=[];return t.push(String.format('<li class="dropdown-menu-item-group" data-group="{0} data-function-id="{1}">',n.id,"group"+n.id)),t.push(String.format('<a href="javascript:;" data-group="{0}">{1}<\/a>',n.id,n.label)),t.push('<ul class="dropdown-menu"><\/ul>'),t.push("<\/li>"),t.join("")},_getListedItem:function(n,t){var i=n.aCss?'class="'+n.aCss+'"':"",r=this._getCssTemplate(n),u=n.spanCSS!=undefined?' class="'+n.spanCSS+'"':"",f=n.isUseSpanInside===!0?"<span {{anchorSpanCSS}}><\/span>".replace("{{anchorSpanCSS}}",u):"",e=this._getAttrDropdownTabItemTemplate(n),o=this._getDefaultLiTemplate(n,t),s=this._getLiTemplate(n);return $(s.replace("{{liTemplate}}",o).replace("{{attrDropdownTabItem}}",e).replace("{{css}}",r||"").replace("{{aCss}}",i||"").replace("{{id}}",n.id||"").replace("{{clickId}}",n.clickId||"").replace("{{dualStep}}",$.isNull(n.dualStep)?"":n.dualStep).replace("{{dualControlId}}",n.dualControlId||"").replace("{{inlineMode}}",$.isNull(n.inlineMode)?"":n.inlineMode).replace("{{editValue}}",n.value||"").replace("{{value}}",n.value||"").replace("{{anchorSpanInside}}",f||"").replace("{{originLabel}}",n.label||"").replace("{{label}}",$.isNull(this.minimalize)?n.label:n.reducedLabel).replace("{{removeBtn}}",this.withRemoveBtn?'<span class="close" data-role="delete" data-role-index="'+n.id+'"><\/span>':""))},_getFixedFooter:function(n){var r=$('<div class="dropdown-menu ">'),t=$('<div class="dropdown-menu-footer">'),u=n.find('a[data-fixedFooter="true"]').addClass("text-bold"),i;return t.append(u),i=n.find("li"),i.each(function(n,t){t.hasChildNodes()||$(t).remove()}),r.append(n.find("ul")).append(t)},addItems:function(n,t){var r,i,o=[],s=$('<ul class="dropdown-menu-item">'),v,h,f=!1,e,u,a;t||(t=this.$el);var c=n.filter(function(n){return n.id==="newForm"}),l=n.filter(function(n){return n.section==="footer"}),y=n.filter(function(n){return n.section==="formSetting"});for((v=n.any(function(n){return n.group}))&&(e=_.groupBy(n,"group"),h=Object.getOwnPropertyNames(e),n=h.reduce(function(n,t){return n.push({id:"group_"+t,label:t,isGroup:!0}),n.concat(e[t])},[]),this.$el.addClass("dropdown-menu-tree")),u=0,a=n.length;u<a;u++){if(i=n[u],i.__type===widget.generator.CONTROL){this.addControlTypeItem(t,i,u);continue}if(this.baseType){if(i.isGroup)f=!0,r=$(this._getListedItemGroup(i,u,f)).on("click",this.toggleGroupDropdown.bind(this)),this.openGroup&&_.indexOf(this.openGroup,i.label)!=-1&&r.addClass("open");else if(r=this._getBaseTypeListedItem(i,u),f){this.addGroupChildItem(r,i);continue}}else i.id==="newForm"||i.section==="footer"?o.push(String.format(this.dropdownMenuFooterTemplate,i.label,i.id)):r=this._getListedItem(i,u);i.isChildDepth==!0&&(this.isChildDepth=!0,this.addChildItems(r,i.childItems,u,i),this.addFixedFooter(r,i));i.id!=="newForm"&&i.section!=="footer"&&s.append(r);$.isEmpty(y)&&this.templateType!="droprightArrow"?$.isEmpty(c)&&$.isEmpty(l)&&t.append(r):t.find("ul").append(r)}$.isEmpty(c)&&$.isEmpty(l)||(t.append(s),t.append(o.join("")))},addControlTypeItem:function(n,t){var i=$('<li class="dropdown-menu-form"/>'),r=this._getControlTypeItem(_.clone(t));r.render(i);this.itemList.push(r);n.append(i)},addGroupChildItem:function(n){var t=this.$el.find("li[data-group]:last() > ul");t.append(n);t.find("li").length>8&&t.addClass("dropdown-menu-fixed-height")},addChildItems:function(n,t,i,r){for(var u,s=$(this.eventContainer||document.body),e=!1,o=!1,f=0;f<t.length;f++)t[f].isShowChecked&&(e=!0),$.isEmpty(t[f].isFixedFooter)||(o=!0);u=$('<ul class="'+(o?"dropdown-menu-item":"dropdown-menu")+(t.length>8?" dropdown-menu-fixed-height":"")+(e?" dropdown-menu-checked-list":"")+(r&&r.css?" "+r.css:"")+'"data-childItem="childItem_'+(i||0).toString()+'"><\/ul>');n.addClass("dropdown-menu-item-group");n.append(u);this.addItems(t,u);this.$el.hasClass("context-menu")||this.$el.addClass("context-menu");n.children("a").bind("mouseenter",this.onMouseoverChildUlHandler.bind(this,s,n,u));n.bind("mouseleave",function(){ecount.__isTRevokeEventMode()||n.removeClass("open")});u.bind("mouseenter",function(n){this.toggleParentDropdown(n,!0)}.bind(this));u.bind("mouseleave",function(n){ecount.__isTRevokeEventMode()||this.toggleParentDropdown(n,!1)}.bind(this))},onMouseoverChildUlHandler:function(n,t,i,r){var f=2-ecount.common.getZoomRatio(),e=(n.outerWidth()||window.outerWidth)/f,s=(n.outerHeight()||window.outerHeight)/f,o=t.offset(),h=i.offset(),u;i.show();t.removeClass("dropdown-menu-item-group-left").removeClass("dropdown-menu-item-group-top").addClass("open");n&&n[0]!=document||(e=$(window).width()/f+(ecount.isMobile==!0?0:$(document).scrollLeft()));o.left+t.width()+i.width()>e&&t.addClass("dropdown-menu-item-group-left");o.top+i.height()>s&&t.addClass("dropdown-menu-item-group-top");ecount.__isEventCaptureMode()&&(u=r.target,ecount.global.setTimeout(this.ecPageID,function(){ecount.eventLog("mouseover",{type:"mouseover",action:"showDropdownSubItem",actionTarget:u.id,desc:$(u).text(),value:u.getAttribute("data-value"),item:i})}))},addFixedFooter:function(n,t){var r=t.childItems.filter(function(n){return n.isFixedFooter}),i;r.length>0&&(i=this._getFixedFooter(n,t),n.append(i))},toggleParentDropdown:function(n,t){var r=n.currentTarget.getAttribute("data-childitem"),i=$(n.currentTarget).parent(),u=i.data("childitem");r===u&&(t?i.hasClass("open")||i.addClass("open"):i.hasClass("open")&&i.removeClass("open"))},toggleGroupDropdown:function(n){n.currentTarget.getAttribute("data-group")&&$(n.target.tagName=="A"?n.target.parentElement:n.target).toggleClass("open")},removeChildItems:function(n){for(var t,i=this.$el.find("a[data-function-id='list-"+n+"']").parent(),r=i.find("ul"),f=r.find("li.dropdown-menu-form"),u=0;u<f.length;u++)for(t=0;t<this.itemList.length;t++)if(f.find(this.itemList[t].$el).length>0){this.itemList[t].destroy();this.itemList.splice(u,1);break}i.removeClass("dropdown-menu-item-group");i.removeClass("dropdown-menu-item-group-left");r.off();r.remove()},insertChildItems:function(n,t){var i=this.$el.find("a[data-function-id='list-"+n+"']").parent();this.addChildItems(i,t)},removeItem:function(n){var r=this.$el?this.$el.find("a"):[],i,t;for($.isArray(n)||(n=[n]),t=0;t<n.length;t++)(i=this.findItem(n[t]),$.isNull(i)||$.isEmpty(i))||(i.parent().remove(),r.splice(t,1));r.length==0&&(this.onBeforeHide&&this.onBeforeHide(),this.hide())},showItem:function(n){var t=this.findItem(n);t&&t.hasClass("hidden")&&t.removeClass("hidden")},hideItem:function(n){var t=this.findItem(n);t&&!t.hasClass("hidden")&&t.addClass("hidden")},showItemList:function(){for(var t=this.$el.find("a")||[],i=[],n=0;n<t.length;n++)t.eq(n)&&!t.eq(n).hasClass("hidden")&&i.push(t.eq(n));return i},hideItemList:function(){for(var t=this.$el.find("a")||[],i=[],n=0;n<t.length;n++)t.eq(n)&&t.eq(n).hasClass("hidden")&&i.push(t.eq(n));return i},changeItemText:function(n,t){var i=this.findItem(n);i&&i.text(t)},changeItemClass:function(n,t){var i=this.findItem(n);i&&(t==null?i.removeAttr("class"):i.attr("class",t))},findItem:function(n){for(var u="list-"+n,r=this.$el?this.$el.find("a"):[],t,i=0,f=r.length;i<f;i++)if(t=r.eq(i),t.attr("data-function-id")===u)return t;return null},findOriginItem:function(n){return(this.items||[]).find(function(t){return t.id==n})||null},removeItems:function(){this.itemList.forEach(function(n){n.destroy();n=null;delete n});this.itemList=[];this.$el&&(this.$el.find("a").off(),this.$el.find("li").remove())},reset:function(){this.itemList.forEach(function(n){n.reset()})},toggle:function(n){this._isShow?this.hide(n):this.show(n)},setDropdownPosition:function(){function c(n){var i=n[0].value,r=0,t;if(n[0].value>0||n[1].value>0)for(t=0;t<n.length;t++)i>n[t].value&&(i=n[t].value,r=t);return n[r]}function l(n,t){var r,i,u;this._templateType!=="newForm"?(i=this.$el.height(),this._originStyle={height:i},this.$el.height((i*t-n)/t),this.$el.addClass("dropdown-menu-fixed-height")):(r=this.$el.find("ul"),i=r.height(),i>0&&n>0&&(u=(i*t-n)/t,this._originStyle={maxHeight:r.css("maxHeight")},this.$el.find("ul").css("maxHeight",u+"px")))}function a(n,t){var i=e-n/t,r=this.$el.find("a");this.$el.width(i<200?200:i-2);r.length>0&&r.addClass("ellipsis")}var r;if(_.isBoolean(this.resizeDropDownLayerWidth)&&this.resizeDropDownLayerWidth&&(this.$el.css({"min-width":this.getOwnerBoundary().width}),this.$el.css({padding:"0px"})),this.type!=="fn"){ecount.layout.prototype.setDropdownPosition.apply(this,arguments);return}var t={},w=this.boundary.offset||{},n=2-ecount.common.getZoomRatio();if(this._options.zIndex!=undefined&&(t["z-index"]=this._options.zIndex),this.isOwnFixedPosition)return!1;this.$el.css({top:0,left:0});this.$el.children().length>0&&this._originStyle&&(this._originStyle.maxHeight&&this.$el.find("ul").css("maxHeight",this._originStyle.maxHeight),this._originStyle.height&&this.$el.height(this._originStyle.height),delete this._originStyle);var f=this.$el.outerHeight(),v=this.boundary.bottom*n+f*n>$(window).height(),o=this.isResponsiveHeight?!1:v,s=$(window).scrollTop(),i=[{posName:"top",value:f*n-this.boundary.top*n+s},{posName:"bottom",value:f*n-($(window).height()-this.boundary.top*n-this.boundary.height*n)-s}],y=c.call(this,i);o===!0&&y.posName=="bottom"&&(o=!1);r="";o||this._forcedDisplayPosition=="top"?i[0].value>0?(this.isChildDepth||l.call(this,i[0].value,n),r=(this.boundary.top+-this.$el.outerHeight()+2)*n/n):r=(this.boundary.top-f+2)*n/n:(i[1].value>0&&!this.isChildDepth&&l.call(this,i[1].value,n),r=this.boundary.bottom);t.top=r;var e=this.$el.outerWidth(),h=this.boundary.left+e*n>$(window).width(),u=[{posName:"left",value:this.boundary.left*n+e*n-$(window).width()},{posName:"right",value:e*n-this.boundary.right}],p=c.call(this,u);p.posName=="left"&&(h=!1);h||this.directionX=="right"?(u[1].value>0&&a.call(this,u[1].value,n),t.left=(this.boundary.right-this.$el.outerWidth()*n)/n):(u[0].value>0&&a.call(this,u[0].value,n),t.left=this.boundary.left);this.$el.css(t);return},show:function(){if(!this._isShow&&!this.hidden)if(this._isShow=!0,this.onBeforeShow&&this.onBeforeShow(this),this.type=="fn"){this.$el.addClass("show");var n=this.$el.find("ul");n.length>0&&n.show();this.setDropdownPosition();this.dropdownHideBindEvent()}else this.setDropdownPosition(),this.dropdownHideBindEvent(),this.$el.addClass("show")},hide:function(n,t){if((!t||!this.pcid||!(this.$el.find($(t.target)).length>0||this.$el[0]==t.target))&&(!t||!t.type||t.type!="scroll"||!this.isChildDepth||this.__target!=widget.generator.HEADER||!this.pnode||!this.pnode.parents("div.header")||!this.pnode.parents("div.header").hasClass("header-fixed"))&&this._isShow){this._onClicked=!1;this._isShow=!1;this.onBeforeHide&&this.onBeforeHide(t);this.$el.removeClass("show");this.dropdownHideUnBindEvent();var i=this.$el.find("ul");i.length>0&&i.hide()}},setOnClicked:function(n){this._onClicked=n},setPreventDestroy:function(n){this.preventDestroy=n},setBoundary:function(n){$.isNull(n)||(this.boundary=n)},getOptionLength:function(){return this.items?this.items.length:0},getList:function(n){return this.itemList[n]},getListById:function(n){for(var t=0,i=this.itemList.length;t<i;t++)if(this.itemList[t].id==n)return this.itemList[t]},getNodeList:function(n){return this.$el.find("li")[n]},removeClass:function(n){this.$el.removeClass(n)},removeDropdownLayer:function(){ecount.layer.removeLayer(this.ecIKey)},getOwnerInstance:function(){var n=ecount.global.getEcInstance(this.getOwnerKey());return n._isGridCellControl?_.cloneDeep(n):n},getOwnerBoundary:function(){return this.boundary},isOnClicked:function(){return this._onClicked},ON_CLICK_SERVICE:function(n,t,i,r){var f=$(t.target),e=f.data("function-id"),v=f.data("function-section"),y=f.data("click-id"),h=y||e,u=this.owner,c=u&&u._isGridCellControl,b=this.findOriginItem(e),s,p,l,a,w,o;if(t.target.tagName!="A"&&!e&&((s=$(t.target).closest("a[data-isdropdowntabitem=true]"),s.length>0)||(s=$(t.target).closest("a[data-service='service.layer']"),s.length>0)))return s.trigger("click"),!1;if(!c&&!$.isNull(u)&&u.__type==widget.generator.CONTROL&&u.hasState()&&u.getState(this.cindex||0,"opt.preventClick"))return!1;if(f.data("group")&&(p=t.target.tagName=="A"?f.parent("li"):f,p.find("ul").length&&(l=this.$el.get(0).getBoundingClientRect(),l.y+l.height>ecount.parentFrame.outerHeight&&this.setDropdownPosition())),n.ecRole==="delete")return this.removeItem(n.ecRoleIndex),!0;switch(h){case"favoriteCodeTreeSetup":_.extend(r,{isOpenPopupLayer:!0})}if($.extend(r,{type:"dropdown.click",ecIKey:this.getEcIKey(),ownerKey:this.getOwnerKey(),gridID:this.gridID,gridSectionType:this.gridSectionType,gridColumnID:this.gridColumnID,gridDataKey:this.gridDataKey,tableId:this.tableId,sectionType:this.sectionType,columnId:this.columnId,rowId:this.rowId,targetID:["list",this._commandPrefix,h].join("-"),controlID:u&&u.id,pcontrolID:u&&u.pcid,value:f.attr("data-value"),dualStep:f.attr("data-dualstep"),dualControlid:f.attr("data-dualcontrolid"),inlineMode:f.attr("data-inlineMode")||null,command:"on"+(this._commandPrefix+"-"+h).split("-").select(function(n){return n.charAt(0).toUpperCase()+n.slice(1)}).join(""),control:this.owner,url:"/ECERP/SVC/Popup/FavoriteCodeTreeSetup",clickId:y,originId:e,originEvent:t,isEditMode:e==="editForm",isNewFormMode:e==="newForm",hasFn:u&&u.hasFn||!1,originItem:b,origineFunctionId:this.origineFunctionId,ownerTargetId:this.ownerTargetId||""}),v&&_.merge(r,{section:v}),this.subTitleLinkCid&&(_.merge(r,{subTitleLinkCid:this.subTitleLinkCid,subTitleLinkId:this.subTitleLinkId}),a=t.target.text,a&&$("#"+this.subTitleLinkId).text(a.trim())),r.isEditMode&&(r.editModeCommand=r.command),r.isNewFormMode&&(r.newFormCommand=r.command),w=Boolean(f.attr("data-isDropdownTabItem")),w===!0?this.onClick&&this.onClick(t):this.onClickDropdown&&this.onClickDropdown(r),f&&$(f).parent().hasClass("dropdown-menu-item-group")||n.cid||this.type=="selectitem"&&!!~_.indexOf(["checkbox","label"],$(t.target).attr("data-child-type"))||this.isNotCloseLayerByClick(n,t,i,r)||ecount.layer.removeLayer(this.getEcIKey()),this.onClickPriority){r.type="dropdown.click";this.onClickPriority(r)}return $.isEmpty(this.gridID)||$.isNull(u)||u.__type!="control"||c||u.setFocus(0),c&&_.get(this,"owner.$el")&&(o=ec$.parseGridElement(this.owner.$el.get(0)),_.merge(r,{gridId:o.gridID,tableId:o.gridTableID,rowId:o.dataKey,columnId:o.columnID,sectionType:o.sectionType})),!0},isNotCloseLayerByClick:function(){return!1},ON_MOUSEOVER_SERVICE:function(){ecount.layer.clearTimer(this.getEcIKey())},ON_MOUSEOUT_SERVICE:function(){this._onClicked!=!0&&ecount.layer.hide(this.getEcIKey())},ON_FOCUSIN_SERVICE:function(){ecount.layer.clearTimer(this.serviceKey)}});ecount.class("ecount.layer.selectitem","ecount.layer.dropdown",{template:'<div class="dropdown-menu context-menu {{css}}" data-service="service.layer" data-servicekey="{{serviceKey}}" data-ownerkey="{{ownerKey}}" style="{{style}}"/>',tempItemHeader:'<div class="dropdown-menu-header"><span data-service="service.layer" data-function-id="{{id}}" data-function-section="header">{{label}}<\/span><\/div>',tempItemTable:['<table class="table table-layout-auto table-hover table-bordered table-nowrap {{style.tableCss}}" style="{{style.tableWidth}}">',"{{colgroup}}","<tbody>","{{tbody}}","<\/tbody>","<\/table>",].join("\n"),tempItemTableTr:'<tr data-child-type="{{childType}}" data-child-li-index="{{childLiIndex}}" data-child-li-id="{{childLiId}}" data-child-index="{{childIndex}}">{{cell}}<\/tr>',tempItemTableTh:'<th data-function="{{ecFunction}}" data-function-id="{{ecFunctionId}}" data-role-index="{{index}}" class="{{cellCss}}" style="{{cellStyle}}" data-child-type="{{childType}}" data-child-li-index="{{childLiIndex}}" data-child-li-id="{{childLiId}}" data-child-index="{{childIndex}}">{{contents}}<\/th>',tempItemTableTd:'<td data-function="{{ecFunction}}" data-function-id="{{ecFunctionId}}" data-role-index="{{index}}" class="{{cellCss}}" style="{{cellStyle}}" data-child-type="{{childType}}" data-child-li-index="{{childLiIndex}}" data-child-li-id="{{childLiId}}" data-child-index="{{childIndex}}">{{contents}}<\/td>',serviceName:"selectitem",_templateType:"newForm",isChildDepth:!0,_visibleSelectLayer:null,setTemplate:function(){this.css=ecount.convertor.uniqSumClass(this.css,"position-fixed dropdown-menu-checked-list");this.template=ecount.widget.replaceAttr(this.template,{css:this.css,style:this._getStyle(),serviceKey:this.getEcIKey(),ownerKey:this.getOwnerKey()})},_getLiTemplate:function(){return'{{liTemplate}} <a href="javascript:;" {{attrDropdownTabItem}} data-toggle="tooltip" {{aCss}} data-placement="left"  data-function-id="{{id}}" data-click-id="{{clickId}}" data-service="service.layer" data-dualStep="{{dualStep}}" data-dualControlId="{{dualControlId}}" data-inlineMode="{{inlineMode}}" data-value="{{value}}" data-originLabel="{{originLabel}}">{{anchorSpanInside}}{{label}}<\/a><\/li>'},_getListedItem:function(n,t){var i=this._getCssTemplate(n),r=n.spanCSS!=undefined?' class="'+n.spanCSS+'"':"",u=n.isUseSpanInside===!0?"<span {{anchorSpanCSS}}><\/span>".replace("{{anchorSpanCSS}}",r):"",f=this._getAttrDropdownTabItemTemplate(n),e=this._getDefaultLiTemplate(n,t),o=this._getLiTemplate(n);return $(ecount.widget.replaceAttr(o,{liTemplate:e,attrDropdownTabItem:f,css:i||"",aCss:"",id:n.id||"",clickId:n.clickId||"",dualStep:$.isNull(n.dualStep)?"":n.dualStep,dualControlId:n.dualControlId||"",inlineMode:$.isNull(n.inlineMode)?"":n.inlineMode,editValue:n.value||"",value:n.value||"",anchorSpanInside:u||"",originLabel:n.label||"",label:$.isNull(this.minimalize)?n.label:n.reducedLabel}))},resetLayerItem:function(n){this.hide();this.items=n;this.$el.empty();this.addItems(n,this.$el)},addItems:function(n,t){var u,i,f=[],e=$('<ul class="dropdown-menu-item visible">'),r,o;for(t=t?t:this.$el,r=0,o=n.length;r<o;r++)i=n[r],i.section==="header"?f.push(ecount.widget.replaceAttr(this.tempItemHeader,{id:i.id,label:i.label})):(u=this._getListedItem(i,r),u.attr("data-item-id",i.id),_.isEmpty(i.itemsSelect)||(this.setDataItemsSelect(i.itemsSelect),this.addSelectItems(u,i.itemsSelect,r,i)),_.isEmpty(i.itemsCheckbox)||(this.setDataChildItems(i.itemsCheckbox),this.addChildItems(u,i.itemsCheckbox,r,i),u.addClass("dropdown-menu-item-group")),e.append(u));t.prepend(f.join(""));t.append(e)},addSelectItems:function(n,t,i,r){for(var e,h='<ul class="dropdown-menu dropdown-menu-checked-list {{scrollCss}}" data-childItem="childItem_'+(i||0).toString()+'" data-child-type="{{childType}}" data-child-li-index="{{childLiIndex}}" data-child-li-id="{{childLiId}}" style="opacity: 0; visibility: hidden; bottom: auto; left: 0;">{{liContents}}<\/ul>',u,o,s="",f=0;f<t.length;f++)u=t[f],u.selected&&(o=u.label),s+=ecount.widget.replaceAttr('<li class="{{liCss}}" data-child-type="{{childType}}"  data-child-li-index="{{childLiIndex}}" data-child-li-id="{{childLiId}}" data-child-index="{{childIndex}}"><a class="{{css}}" href="javascript:;" data-trigger="click" data-service="service.layer" data-value="{{data}}" data-child-type="{{childType}}" data-child-li-index="{{childLiIndex}}" data-child-li-id="{{childLiId}}" data-child-index="{{childIndex}}">{{label}}<\/a><\/li>',{childType:"select",childLiIndex:i,childLiId:r.id,childIndex:f,label:u.label,data:u.data,liCss:u.selected?"active checked-item":"",css:""});n.append(ecount.widget.replaceAttr(h,{liContents:s,childType:"select",childLiIndex:i,childLiId:r.id,scrollCss:t.length>=10?"dropdown-menu-fixed-height":""}));e=$(ecount.widget.replaceAttr('<div class="display-inline-block ml-5" data-child-type="{{childType}}" data-child-li-index="{{childLiIndex}}"><button class="btn btn-default btn-sm btn-selectbox" data-child-type="{{childType}}" data-child-li-index="{{childLiIndex}}" data-child-li-id="{{childLiId}}">{{selectedLabel}}<\/button><\/div>',{selectedLabel:o,childType:"select",childLiIndex:i,childLiId:r.id}));n.children("a").append(e);e.bind("click",function(n){var i=$(n.target),r=i.parents("li"),t=r.find("ul.dropdown-menu"),u=t.css("visibility")=="visible";r.removeClass("open");this._visibleSelectLayer&&(this._visibleSelectLayer.css({visibility:"hidden",opacity:0}),this._visibleSelectLayer=null);u||(t.css({left:i.position().left+"px",top:"-"+(i.position().top+t.height())+"px"}),ecount.global.setTimeout(this.ecPageID,function(){t.css({visibility:"visible",opacity:1})}.bind(this),100),this._visibleSelectLayer=t);n.originalEvent.stopPropagation();n.originalEvent.stopImmediatePropagation()}.bind(this))},setDataItemsSelect:function(n){n.every(function(n){return!n.selected})&&(n[0].selected=!0)},setDataChildItems:function(){},addChildItems:function(n,t,i,r){var f=$(this.eventContainer||document.body),u=$('<div class="dropdown-menu" data-childItem="childItem_'+(i||0).toString()+'" data-child-type="checkbox"><\/div>');n.append(u);u.append(this._setTemplateTable(t,i,u,r));n.children("a").bind("mouseenter",this.onMouseoverChildUlHandler.bind(this,f,n,u));n.bind("mouseleave",function(){ecount.__isTRevokeEventMode()||n.removeClass("open")});u.bind("mouseenter",function(n){this.toggleParentDropdown(n,!0)}.bind(this));u.bind("mouseleave",function(n){ecount.__isTRevokeEventMode()||this.toggleParentDropdown(n,!1)}.bind(this))},_setTemplateTable:function(n,t,i,r){var u=this.tempItemTable,h=n.column,o=n.list,f=[],s,e,c='<div class="wrapper-toolbar text-center" data-child-type="{{childType}}" data-child-li-index="{{childLiIndex}}" data-child-li-id="{{childLiId}}" data-child-index="{{childIndex}}">\n<span class="form-checkbox ml-5" data-cid="" data-child-type="{{childType}}" data-child-li-index="{{childLiIndex}}" data-child-li-id="{{childLiId}}" data-child-index="{{childIndex}}">\n<input type="checkbox" value="" data-cid="" data-role="{{ecRole}}" name="" data-index="0" id="control---WidgetTestPage_1-title10-0" class="" data-child-type="{{childType}}" data-child-li-index="{{childLiIndex}}" data-child-li-id="{{childLiId}}" data-child-index="{{childIndex}}" {{checked}}>\n<label data-role="widget-focus" for="control---WidgetTestPage_1-title10-0" data-cid="" class="" data-child-type="{{childType}}" data-child-li-index="{{childLiIndex}}" data-child-li-id="{{childLiId}}" data-child-index="{{childIndex}}"><\/label>\n<\/span>\n<\/div>';return s=h.map(function(n,i){return ecount.widget.replaceAttr(this.tempItemTableTh,{childType:"checkbox",childLiIndex:t,childLiId:r.id,childIndex:"header",index:i,ecFunction:"layer.row",ecFunctionId:"header",cellStyle:"width:"+n.width+"px",cellCss:"",contents:n.label})},this).join(""),f.push(ecount.widget.replaceAttr(this.tempItemTableTr,{cell:s,childType:"checkbox",childLiIndex:t,childLiId:r.id,childIndex:"header"})),o.forEach(function(n,i){e=ecount.widget.replaceAttr(this.tempItemTableTd,{childType:"checkbox",childLiIndex:t,childLiId:r.id,childIndex:i,index:i,ecFunction:"layer.cell",ecFunctionId:0,cellCss:"",cellStyle:"",contents:ecount.widget.replaceAttr(c,{checked:n.checked?"checked":"",childType:"checkbox",childIndex:i})});e+=ecount.widget.replaceAttr(this.tempItemTableTd,{childType:"label",childLiIndex:t,childLiId:r.id,childIndex:i,index:i,ecFunction:"layer.cell",ecFunctionId:1,cellCss:"text-center",cellStyle:"",contents:n.label});f.push(ecount.widget.replaceAttr(this.tempItemTableTr,{cell:e,childType:"checkbox",childLiIndex:t,childLiId:r.id,childIndex:i}))},this),u=u.replace("{{tbody}}",f.join("")),o.length>=10&&i.addClass("dropdown-menu-fixed-height"),ecount.widget.replaceAttr(u,{"style.tableCss":this["style.tableCss"]||"","style.width":this["style.width"]?["width:",this["style.width"],"px"].join(""):"","style.tableWidth":this["style.tableWidth"]?["width:",this["style.tableWidth"],"px"].join(""):"","style.css":"",colgroup:"",serviceKey:this.getEcIKey(),ownerKey:this.getOwnerKey()})},onMouseoverChildUlHandler:function(n,t,i,r){var u;if(!this._visibleSelectLayer){var f=2-ecount.common.getZoomRatio(),e=(n.outerWidth()||window.outerWidth)/f,s=(n.outerHeight()||window.outerHeight)/f,o=t.offset(),h=i.offset();i.show();t.removeClass("dropdown-menu-item-group-left").removeClass("dropdown-menu-item-group-top").addClass("open");n&&n[0]!=document||(e=$(window).width()/f+(ecount.isMobile==!0?0:$(document).scrollLeft()));o.left+t.width()+i.width()>e&&t.addClass("dropdown-menu-item-group-left");o.top+i.height()>s&&t.addClass("dropdown-menu-item-group-top");ecount.__isEventCaptureMode()&&(u=r.target,ecount.global.setTimeout(this.ecPageID,function(){ecount.eventLog("mouseover",{type:"mouseover",action:"showDropdownSubItem",actionTarget:u.id,desc:$(u).text(),value:u.getAttribute("data-value"),item:i})}))}},isNotCloseLayerByClick:function(n){var t=this.items.find(function(t){return t.id===n.ecFunctionId}),i=!1;return t&&!_.isEmpty(t.itemsSelect)&&(i=!0),i},show:function(){var n;this._isShow||this.hidden||!this.$el||(this._isShow=!0,this.onBeforeShow&&this.onBeforeShow(this),this.type=="fn"?(this.$el.addClass("show"),n=this.$el.find("ul"),n.length>0&&n.show(),this.setDropdownPosition(),this.dropdownHideBindEvent()):(n=this.$el.find("ul"),n.length>0&&n.show(),this.setDropdownPosition(),this.dropdownHideBindEvent(),this.$el.addClass("show")),ecount.isMobile&&this.setDisplayCheckboxLayer(!0))},hide:function(){this.$el&&(this._visibleSelectLayer&&(this._visibleSelectLayer.css({visibility:"hidden",opacity:0}),this._visibleSelectLayer=null),ecount.isMobile&&this.setDisplayCheckboxLayer(!1),ecount.layer.dropdown.prototype.hide.apply(this,arguments))},isVisibleSelectLayer:function(){return!!this._visibleSelectLayer},setDisplaySelectLayer:function(n,t){t||this._visibleSelectLayer&&(this._visibleSelectLayer.css({visibility:"hidden",opacity:0}),this._visibleSelectLayer=null)},setDisplayCheckboxLayer:function(n,t){var e=$(this.eventContainer||document.body),r=this.items.find(function(t){return t.id===n}),u,f,i;if(r&&!_.isEmpty(r.itemsCheckbox)?n&&t!==!1&&(u=this.$el.find("ul.dropdown-menu-item:eq(0)"),i=u.find("li[data-item-id='"+n+"']"),f=i.find("div.dropdown-menu")):_.isBoolean(n)&&n&&(r=this.items.find(function(n){return n.active===!0}),r&&(u=this.$el.find("ul.dropdown-menu-item:eq(0)"),i=u.find("li[data-item-id='"+r.id+"']"),f=i.find("div.dropdown-menu"))),u&&i&&f)this.onMouseoverChildUlHandler(e,i,f);else this.$el.find("ul.dropdown-menu-item:eq(0) > li").removeClass("open")},getItemValue:function(n){return n?_.get(this.items.find(function(t){return t.id===n}),"value",""):_.get(this.items.find(function(n){return n.active===!0}),"value","")},setItemValue:function(n){var t=this.$el.find("ul.dropdown-menu-item:eq(0)");t.children("li").removeClass("active checked-item");this.items.forEach(function(i){i.value===n?(i.active=!0,i.isShowChecked=!0,t.find("li[data-item-id='"+i.id+"']").addClass("active checked-item")):(i.active=!1,i.isShowChecked=!1)},this)},getSelectItemValue:function(n){var t,i={};return t=n?this.items.find(function(t){return t.id===n}):this.items.find(function(n){return n.active===!0}),t&&!_.isEmpty(t.itemsSelect)&&(i=t.itemsSelect.find(function(n){return n.selected===!0})||{}),i},setSelectItemValue:function(n,t){var i=this.items.find(function(t){return t.id===n}),r,u;i&&!_.isEmpty(i.itemsSelect)&&(r=this.$el.find("ul.dropdown-menu-item:eq(0) > li[data-item-id='"+n+"']"),u=r.find("ul.dropdown-menu"),u.children("li").removeClass("active checked-item"),i.itemsSelect.forEach(function(n,i){i==t?(n.selected=!0,r.find("button.btn-selectbox").text(n.label),u.find("li:eq("+i+")").addClass("active checked-item")):n.selected=!1},this))},setCheckboxItemValues:function(n,t,i){var r=this.items.find(function(t){return t.id===n});r&&!_.isEmpty(_.get(r,"itemsCheckbox.list"))&&(t==="all"?r.itemsCheckbox.list.forEach(function(n){n.checked=!!i},this):r.itemsCheckbox.list[t].checked=!!i)},getCheckboxItemValues:function(n){var t,i=[];return t=n?this.items.find(function(t){return t.id===n}):this.items.find(function(n){return n.active===!0}),t&&!_.isEmpty(_.get(t,"itemsCheckbox.list"))&&(i=t.itemsCheckbox.list.filter(function(n){return n.checked===!0})),i},setCheckboxItems:function(n,t,i){var r=this.items.find(function(t){return t.id===n}),f,u;r&&!_.isEmpty(_.get(r,"itemsCheckbox.list"))&&(f=this.$el.find("ul.dropdown-menu-item:eq(0) > li[data-item-id='"+n+"']"),u=f.find("div.dropdown-menu tr[data-child-index!='header'] input[type='checkbox']"),t==="all"?r.itemsCheckbox.list.forEach(function(n,t){n.checked=!!i;u.eq(t).prop("checked",!!i)},this):(r.itemsCheckbox.list[t].checked=!!i,u.eq(t).prop("checked",!!i)))}});ecount.class("ecount.layer.caretdropdown","ecount.layer.dropdown",{template:'<ul class="dropdown-menu dropdown-menu-delete-list {{css}}" data-service="service.layer" data-servicekey="{{serviceKey}}" data-ownerkey="{{ownerKey}}" />',serviceType:"layer",serviceName:"caretdropdown",isSetDropdownSize:!0,render:function(){ecount.layer.dropdown.prototype.render.apply(this,arguments);this.boundary&&this.setDropdownPosition()},removeItem:function(n){var r=this.$el?this.$el.find("a"):[],u,t,i,f;for($.isArray(n)||(n=[n]),i=0;i<n.length;i++)if(t=this.findItem(n[i]),!$.isNull(t)&&!$.isEmpty(t)){u={targetID:t.attr("id"),label:t.text(),value:t.data("value"),isRemoved:!0};this.onClickCaretDropdownList(u);t.parent().remove();r.splice(i,1)}if(r.length==0&&(f=[{id:ecount.resource.MSG00729,label:ecount.resource.MSG00729,value:ecount.resource.MSG00729}].toArray(),this.addItems(f,this.$el)),this.$el&&this.boundary){var e=this.$el.outerWidth(),o=2-ecount.common.getZoomRatio(),s=this.boundary.left+e*o>$(window).width();s&&this.setDropdownPosition()}},findItem:function(n){for(var u=n,r=this.$el?this.$el.find("a"):[],t,i=0,f=r.length;i<f;i++)if(t=r.eq(i),t.attr("data-function-id")===u)return t;return null},_onClickPriority:function(){},ON_CLICK_SERVICE:function(n,t,i,r){var u=$(t.target),e=u.data("function-id"),o=u.data("click-id"),s=o||e,f=u.attr("data-value");if(n.ecRole!=="delete"&&f!=ecount.resource.MSG00729&&$.extend(r,{targetID:["list",this._commandPrefix,s].join("-"),label:u.text(),value:f,type:this.type}),n.ecRole==="delete"&&n.ecRoleIndex!=ecount.resource.MSG00729)return this.removeItem(n.ecRoleIndex),!0;ecount.layer.removeLayer(this.getEcIKey())}});ecount.layer.fn=ecount.layer.dropdown;ecount.class("ecount.layer.table","ecount.layer.dropdown",{template:'<div class="dropdown-menu {{style.css}}" data-service="service.layer" data-servicekey="{{serviceKey}}" data-ownerkey="{{ownerKey}}" style="{{style.width}}">\n<table class="table table-layout-auto  {{style.tableCss}}" style="{{style.tableWidth}}">\n{{colgroup}}\n<tbody>\n{{tbody}}\n<\/tbody>\n<\/table>\n<div data-role="menuLink"><\/div>\n<\/div>',trTemplate:"<tr>{{cell}}<\/tr>",thTemplate:'<th data-function="{{ecFunction}}" data-function-id="{{ecFunctionId}}" data-role-index="{{index}}" class="{{cellCss}}" style="{{cellStyle}}"><\/th>',tdTemplate:'<td data-function="{{ecFunction}}" data-function-id="{{ecFunctionId}}" data-role-index="{{index}}" class="{{cellCss}}" style="{{cellStyle}}"><\/td>',anchorTemplate:'<a href="javascript:;" class="{{css}}" data-role="layer.contents" data-index={{index}} data-function="{{ecFunction}}"data-functionId="{{ecFunctionId}}">{{label}}<\/a>',_anchorTemplate:'<a href="javascript:;" class="{{css}}" data-role="layer.footer" data-index={{index}}>{{label}}<\/a>',footerTemplate:'<div class="dropdown-menu-footer"><a href="javascript:;" class="{{css}}" data-role="layer.footer" data-index={{index}}>{{label}}<\/a><\/div>',serviceType:"layer",serviceName:"table",headers:null,headerDirection:null,items:null,otherLink:null,initializer:null,preventDestroy:!1,dealyForHiding:0,init:function(){ecount.layout.dropdown.prototype.init.apply(this,arguments);this.keydownHandler=function(n){if(n.keyCode===13)return this.hide(),this.clickHandler(n),!1}.bind(this);this.headerDirection||(this.headerDirection="left")},getEcPath:function(){return this.ecPath},getEcIKey:function(){return this.ecIKey},setEcIKey:function(){this.ecIKey=ecount.global.registerEcServiceInstance(this,this.serviceType)},getOwnerKey:function(){return this.ownerKey},render:function(n){this.setTemplate();ecount.layout.prototype.render.call(this,n);this.items&&this.addItems(this.items.toArray(),this.$el);this.adjustLayerSize();this.adjustLayerPosition()},show:function(){ecount.layer.dropdown.prototype.show.apply(this,arguments);this.adjustLayerSize();ecount.global.setTimeout(this.ecPageID,function(){this._forcedDisplayPosition!="bottom"&&this.adjustLayerPosition()}.bind(this))},update:function(n){_.merge(this,n);this.setDropdownPosition();this.show()},reflowTable:function(){this.hide()},setTemplate:function(){var t,i=[],r="",u=$("<colgroup><\/colgroup>"),n;_.isEmpty(this.colgroup)||(this.colgroup.forEach(function(n){var t=$("<col><\/col>");n.width&&t.css("width",n.width+"px");u.append(t)}),r=u.html());t=this.template.replace("{{colgroup}}",r);this.items.forEach(function(n,t){var r="";n.forEach(function(n,i){if(n.position!=widget.generator.FOOTER){if(this.headerDirection=="top"&&t==0||this.headerDirection=="left"&&i==0){r+=ecount.widget.replaceAttr(this.thTemplate,$.extend({index:i,ecFunction:"layer.row",ecFunctionId:t,cellStyle:n.cellStyle||""},n));return}r+=ecount.widget.replaceAttr(this.tdTemplate,$.extend({index:i,ecFunction:"layer.cell",ecFunctionId:t,cellCss:n.cellCss||"",cellStyle:n.cellStyle||""},n))}}.bind(this));i.push(this.trTemplate.replace("{{cell}}",r))}.bind(this));t=t.replace("{{tbody}}",i.join(""));n=this["style.css"]||"";ecount.isMobile&&n.indexOf("generate-other-slips")>=0&&(n+=" open");this.items.length>10&&(n+=" dropdown-menu-fixed-height");this.template=ecount.widget.replaceAttr(t,{"style.tableCss":this["style.tableCss"]||"","style.width":this["style.width"]?["width:",this["style.width"],"px"].join(""):"","style.tableWidth":this["style.tableWidth"]?["width:",this["style.tableWidth"],"px"].join(""):"","style.css":n,serviceKey:this.getEcIKey(),ownerKey:this.getOwnerKey()})},addItems:function(n,t){var r,i,u;for(t||(t=this.$el),i=0,u=this.items.length;i<u;i++)r=!1,this.items[i].map(function(n){if(n.forceLink&&(r=!0),n.end&&typeof n.end=="function"){var t=n.end();return new ecount.layout.toolbar(t)}return n}).forEach(function(n,u){var f=t.find("tr:nth("+i+")").children(":nth("+u+")");switch(n.__type){case"LABEL":r?(n.css="text-default text-uline-no",f.append(ecount.widget.replaceAttr(this._anchorTemplate,n))):f.html(n.label);break;case"LINK":r||n.items.forEach(function(n){f.append(ecount.widget.replaceAttr(this.anchorTemplate,n))}.bind(this));break;case widget.generator.TOOLBAR:n.render(f);this.itemList.push(n)}if(n.position==widget.generator.FOOTER){t.append(ecount.widget.replaceAttr(this.footerTemplate,n));return}}.bind(this));this.items=null},adjustLayerSize:function(){if(this.heightAdjustment){var n=this.$el.height();this.$el.height(this.heightAdjustment+parseInt(n)+"px")}},adjustLayerPosition:function(){var n,i,t;this.tableTop&&this.$el.top(parseInt(this.tableTop)+"px");this.containerName!="contents"&&ecount.global.setTimeout(this.ecPageID,function(){this.$el&&((parseInt(this.$el.css("left"))<0||parseInt(this.$el.width())>=window.outerWidth)&&this.$el.css("left","0px"),n=parseInt(this.$el.css("top")),i=parseInt(this.$el.innerHeight()),t=i+n-this.boundary.top,t>0&&this.$el.css("top",n-t+"px"))}.bind(this),0)},showRow:function(n){var t=this.getRowIndexFromKey(n);~t&&this.$el.find("tr:nth("+t+")").removeClass("hidden")},hideRow:function(n){var t=this.getRowIndexFromKey(n);~t&&this.$el.find("tr:nth("+t+")").addClass("hidden")},getControl:function(n){for(var r,i,e,u,t=0,f=this.itemList.length;t<f;t++)for(r=this.itemList[t],i=0,e=r.itemList.length;i<e;i++)if(u=r.itemList[i],u.id==n)return u},getRowIndexFromKey:function(n){for(var r,i,f,e,t=0,u=this.itemList.length;t<u;t++)for(r=this.itemList[t],i=0,f=r.itemList.length;i<f;i++)if(e=r.itemList[i],e.id==n)return t},hide:function(){ecount.layer.dropdown.prototype.hide.apply(this,arguments);ecount.runtime.notify(ECountEvent.Type.LAYER_HIDE,null,{type:this.type,serviceKey:this.ecIKey,ecPageID:this.ecPageID})},destroy:function(){this.hide();this.removeItems();this.$el&&(ecount.widget.removeChild(this.$el[0]),this.$el=null,delete this.$el)},removeItems:function(){this.itemList.forEach(function(n){n.destroy();n=null;delete n});this.itemList=[];this.$el&&this.$el.find("li").remove()},ON_MOUSEOVER_SERVICE:function(){ecount.layer.clearTimer(this.getEcIKey())},ON_CLICK_SERVICE:function(n,t,i,r){if(clearTimeout(this._hidingTimeoutId),!i){var u=t.target;if(n.ecFunction=="layer.row"&&u.tagName=="TH"||n.ecFunction=="layer.cell"&&u.tagName=="TD")return!1;r.dataset=u.dataset||{index:u.getAttribute("data-index"),functionid:u.getAttribute("data-functionid")}}r.ecIKey=this.getEcIKey()},ON_MOUSEOUT_SERVICE:function(n){this._onClicked||~["layer.contents","layer.footer"].indexOf(n.ecRole)||ecount.layer.hide(this.getEcIKey())}});ecount.class("ecount.layer.createtable","ecount.layout.layer",{template:'<ul class="dropdown-menu {{css}}" data-servicekey="{{serviceKey}}" data-ownerkey="{{ownerKey}}"/>',tableLiTemplate:'<li class="dropdown-menu-text">{{tableTemplate}}<\/li>',tableTemplate:['<table class="table table-bordered tool-table-create {{style.tableCss}}" data-service="service.layer" data-servicekey="{{serviceKey}}" data-ownerkey="{{ownerKey}}">',"<tbody>","{{tbody}}","<\/tbody>","<\/table>",].join("\n"),trTemplate:'<tr data-function-id="{{index}}" >{{cell}}<\/tr>',tdTemplate:'<td data-function="{{ecFunction}}" data-service="service.layer" data-servicekey="{{serviceKey}}" data-ownerkey="{{ownerKey}}" data-function-id="{{ecFunctionId}}" data-role-index="{{index}}" class="{{cellCss}}"><\/td>',items:null,serviceType:"layer",serviceName:"createtable",columnCount:10,rowCount:10,init:function(n){ecount.layout.dropdown.prototype.init.apply(this,arguments);this.columnCount=n.columnCount||this.columnCount;this.rowCount=n.rowCount||this.rowCount;this.activeRow=0;this.activeColumn=0},getEcPath:function(){return this.ecPath},getEcIKey:function(){return this.ecIKey},setEcIKey:function(){this.ecIKey=ecount.global.registerEcServiceInstance(this,this.serviceType)},getOwnerKey:function(){return this.ownerKey},render:function(n){this.setTemplate();ecount.layout.prototype.render.call(this,n);this.renderTable(this.$el);this.items&&this.addItems(this.items.toArray(),this.$el)},setTemplate:function(){this.reportType&&(this.css+=" dropdown-menu-icon-list dropdown-menu-report");this.template=ecount.widget.replaceAttr(this.template,{css:this.css,serviceKey:this.getEcIKey(),ownerKey:this.getOwnerKey()})},update:function(n){_.merge(this,n);this.setDropdownPosition();this.show()},renderTable:function(n){var t=this.tableTemplate,f=[],i,u,r;for(n||(n=this.$el),i=1;i<this.rowCount+1;i++){for(u="",r=1;r<this.columnCount+1;r++)u+=ecount.widget.replaceAttr(this.tdTemplate,{index:r,ecFunction:"layer.cell",ecFunctionId:i,serviceKey:this.getEcIKey(),ownerKey:this.getOwnerKey(),cellCss:"",cellStyle:""});f.push(this.trTemplate.replace("{{cell}}",u).replace("{{index}}",i))}t=t.replace("{{tbody}}",f.join(""));t=ecount.widget.replaceAttr(t,{"style.tableCss":this["style.tableCss"]||"","style.css":this["style.css"]||"",serviceKey:this.getEcIKey(),ownerKey:this.getOwnerKey()});n.append(this.tableLiTemplate.replace("{{tableTemplate}}",t))},addItems:function(n,t){var i,r,u;for(t||(t=this.$el),i=0,r=n.length;i<r;i++)u=n[i],li=this._getBaseTypeListedItem(u,i),t.append(li)},_getCssTemplate:function(n){var t=[n.css,n.hide?"hidden":"",n.active?"active":""].join(" ").trim();return _.isBoolean(this.resizeDropDownLayerWidth)&&this.resizeDropDownLayerWidth&&(t+=" text-center"),t},_getDefaultLiTemplate:function(n){var t,i=(n.liCss||"").trim();return t='<li class="{{css}}" {{childItem}}>',t.replace(/{{childItem}}/g,"").replace(/{{css}}/g,i)},_getBaseTypeListedItem:function(n,t){var i=this._getCssTemplate(n),r=this._getDefaultLiTemplate(n,t);return $(r+'<a class="'+i+'" + href="javascript:;"  data-trigger="click" data-service="service.layer" data-click-id="'+(n.clickId||"")+'" data-function-id="'+n.id+'" data-value="'+(n.value||"")+'" originid="'+n.id+'">'+n.label+"<\/a><\/li>")},show:function(){this.$el.addClass("show")},hide:function(){this.$el.find("td").removeClass("active");this.$el.removeClass("show")},ON_MOUSEOVER_SERVICE:function(n){var e=n.ecFunction,r,u,t,f,i;if(e=="layer.cell"){for(r=parseInt(n.ecRoleIndex||0)+1,u=parseInt(n.ecFunctionId||0)+1,this.$el.find("td").removeClass("active"),t=1;t<u;t++)for(f=this.$el.find('tr[data-function-id="'+t+'"]'),i=1;i<r;i++)f.find('td[data-role-index="'+i+'"]').addClass("active");this.activeColumn=parseInt(n.ecRoleIndex||0);this.activeRow=parseInt(n.ecFunctionId||0)}},ON_CLICK_SERVICE:function(n,t,i,r){n.ecFunction=="layer.cell"||t.target.tagName=="TABLE"?(r.originId="createTable",r.rows=this.activeRow,r.columns=this.activeColumn):n.ecFunctionId=="insertTable"&&(r.originId="tablePopup",r.value=!0);this.hide()}});ecount.class("ecount.layer.imagefile","ecount.layer.dropdown",{items:null,serviceType:"layer",serviceName:"imagefile",init:function(){ecount.layout.dropdown.prototype.init.apply(this,arguments);this.items=this.items.concat([{id:"shareImage",label:ecount.resource.LBL12561,css:"tool-insert-image-share"},{id:"localImage",label:ecount.resource.LBL12562,css:"tool-insert-image-personal"},{id:"imagebox",label:ecount.resource.LBL08150,css:"tool-insert-image-filebox"}]);this.setImagefileSetting()},getEcPath:function(){return this.ecPath},getEcIKey:function(){return this.ecIKey},setEcIKey:function(){this.ecIKey=ecount.global.registerEcServiceInstance(this,this.serviceType)},getOwnerKey:function(){return this.ownerKey},render:function(n){this._super.render.call(this,n);this.setFileManger()},setImagefileSetting:function(){this._defaultUploaderConfig={url:"/ECAPI/Common/Infra/SaveTempFile",autostart:!0,chunk_size:ecount.common.parseSize("20mb"),extensions:"jpg, jpeg, gif, tif",dragdrop:!1,attach_file_size:0,max_file_size:ecount.common.parseSize("2gb"),max_file_count:10,multi_selection:!1,prevent_duplicates:!0,multipart_param:{},tot_size_lmt:{size:"1",flag:!1},menu_code:ecenum.filemenuCode.gw03,is_free_groupware:!1};this._defaultNewFileStorageConfig={collection:null,partition:null,comcode:"",owner_key:"",storage_host_number:0,upload_path:"/SaveTempFile/",temp_file_lifetime:ecenum.tempfileLifetime.infinity,severalOwner_key:!0};this.defaultParam={AFlag:4};this.options={DtCreateKey:"",UserFlag:"",MaxFileSize:0,UsedFileSize:0,RestFileSize:0,AttachSize:0};var n=this._uploaderConfigs&&this._uploaderConfigs.length>0?this._uploaderConfigs[0][1]:{},t=this._newFileStorageConfigs&&this._newFileStorageConfigs.length>0?this._newFileStorageConfigs[0][1]:{};_.merge(this,{initData:{uploaderConfig:_.merge(!0,this._defaultUploaderConfig,n),newFileStorageConfig:_.merge(!0,this._defaultNewFileStorageConfig,t),usingUploader:!0,usingNewFileStorage:!0,usingAlwaysCreateOwnerkey:!0}})},setFileManger:function(){this._initFileManager();this.setImageFileUpload()},_initFileManager:function(){this.ecountfileManager||(this.ecountfileManager=new ecount.fileManager({ecPageID:this.ecPageID,initData:$.extend(!0,{},this.initData),handler:{onComplete:this.onComplete.bind(this),onError:this._onError.bind(this),pageID:this.ecPageID}}))},setImageFileUpload:function(){var n=this,i=null,t=this.initData.uploaderConfig;i=this.$el.find("a[data-function-id='shareImage'], a[data-function-id='localImage']");this._isNotEditorImage?i.bind("click",function(){ecount.popup.openWindow({url:"/ECERP/Infra/Forbidden",popupType:!1,additional:!1,popupLevel:Number(n.popupLevel)+1,parentPageID:n.popupID,alreadyIncludedLayout:!0,popupID:"forbidden",param:{ProgramId:"E070313",__ecPageID:n.ecPageID}})}):i.each(function(){var i=$(this).plupload({url:ecount.common.buildSessionUrl(n.storageEndpoint),filters:{max_file_size:"100mb",prevent_duplicates:!1,mime_types:[{title:t.extensions,extensions:t.extensions}]},chunk_size:"0",extensions:t.extensions,dragdrop:!1,prevent_duplicates:!1,multi_selection:!0,max_file_count:10,autostart:!1,noHead:!1,autoHeightBody:!0,tot_size_lmt:{size:"102400000",flag:!1},extensionErrorMsg:!0,isEcountUpload:!0,checkFileAllowed:function(){ecmodule.common.fileSecurity.checkFileAllowed.apply(this,arguments)},byPassCheckFileAllowed:t.byPassCheckFileAllowed});n["uploader_"+this.getAttribute("data-function-id")]=i.plupload;i.bind("addFiles",function(t,i,r){n.onAddFile(t,i,r)});i.bind("beforeUpload",function(t,i,r){n.onBeforeUpload(i,r)});i.bind("complete",function(t){n.onComplete(t)});i.bind("error",function(t,i,r){n.onError(t,i,r)});i.bind("autostart",function(t,i){n.uploadStart(t,i)})})},onAddFile:function(n,t,i){var r=!1;this.options.uploadSize?(r=this.validate(n,t,i),r&&ecount.global.setTimeout(this.ecPageID,function(){this.uploadStart(n,t)}.bind(this),10)):ecount.common.api({url:"/Groupware/File/CheckFileSize",success:function(u){var f={provider_seq:ecount.cloudStorage.INNER,result:u};this.ecountfileManager.setConfigsize(f);this.options.uploadSize=!0;r=this.validate(n,t,i);r&&ecount.global.setTimeout(this.ecPageID,function(){this.uploadStart(n,t)}.bind(this),10)}.bind(this)})},onBeforeUpload:function(){this.$el.find("#file-progres").removeClass("hidden");this.$el.find("#browse_file").attr("disabled",!0)},onComplete:function(){var t=this,n=this["uploader_"+this.imageStorageValue];this._callback?this._callback():(this.MULTI_UPLOAD_FILES=[],n.files.forEach(function(n){this.MULTI_UPLOAD_FILES.add(n)}.bind(this)),this.MultiImageUpload())},onError:function(n,t,i){var r="";switch(i.code){case plupload.COM_STORAGE_SIZE_ERROR:r=i.message;break;case plupload.TOT_SIZE_LMT_ERROR:r=i.message;break;case plupload.FILE_SIZE_ERROR:r=ecount.resource.MSG05582;break;case plupload.FILE_EXTENSION_ERROR:r=String.format(ecount.resource.MSG05733,t.settings.extensions.toUpperCase().replaceAll(",",", "));break;case plupload.TOT_SIZE_LMT_ERROR:r=String.format(ecount.resource.MSG03611,t.settings.filters.max_file_size);break;default:r=i.message||"error"}i.file&&t.removeFile(i.file);ecount.alert(r)},_onError:function(n){var i=n.file,r=n.code,u=n.message,t=this["uploader_"+this.imageStorageValue];t&&t.removeFile(i);t.trigger("Error",{code:r,message:u})},validate:function(n,t,i){var f=!0,r,e,u,o;for(this.imageStorageValue=n.currentTarget.getAttribute("data-function-id"),r=0,e=i.length;r<e;r++)if(u=i[r],u.provider_seq||(u.provider_seq=ecount.cloudStorage.INNER),o={file:u,isFromTextEditor:!0},f=this.ecountfileManager.validate(o),!f)break;return f},uploadStart:function(){var r,n=[],t,i,u;for(r=this["uploader_"+this.imageStorageValue],t=0,u=r.files.length;t<u;t++)i=r.files[t],i.status!=plupload.DONE&&(i.provider_seq=ecount.cloudStorage.INNER,n.push(i));n&&n.length>0&&this.ecountfileManager.checkStorageQuota(n,function(){this.ecountfileManager.startUpload(n)}.bind(this))},MultiImageUpload:function(){var n={Flag:"I",DtCreateKey:this.options.DtCreateKey,Title:this.MULTI_UPLOAD_FILES[0].name,Type:["shareImage"].contains(this.imageStorageValue)?"2":"1",FileName:this.MULTI_UPLOAD_FILES[0].name,TargetName:this.MULTI_UPLOAD_FILES[0].target_name,Size:this.MULTI_UPLOAD_FILES[0].size,ownerKey:this.MULTI_UPLOAD_FILES[0].owner_key,usingNewFileStorage:!0,comCode:this.initData.newFileStorageConfig.comcode,temp_file_lifetime:this.initData.newFileStorageConfig.temp_file_lifetime,hasStorageHost:this.hasStorageHost};this.MULTI_UPLOAD_FILES.splice(0,1);ecount.document.setImageUploadInfoSave({param:n,callback:function(n,t){var i=this.getOwnerInstance(),r;if(i&&i.uploadSuccess(t.Data),this.MULTI_UPLOAD_FILES&&this.MULTI_UPLOAD_FILES.length>0)this.MultiImageUpload();else{if(this.MULTI_UPLOAD_FILES=null,r=this["uploader_"+this.imageStorageValue],r&&r.files.length)for(var e=r.files,o=e.length,u=null,f=o-1;f>=0;f--)u=e[f],u&&r.removeFile(u);i&&i.uploadComplete&&i.uploadComplete()}}.bind(this)})},createFile:function(n){var t,r,u;if(n instanceof Blob)t=n;else{var f=n.split(";base64,"),l=f[0].split(":")[1],e=window.atob(f[1]),o=e.length,s=new Uint8Array(o);for(r=0;r<o;++r)s[r]=e.charCodeAt(r);t=new Blob([s],{type:l})}var i={},h=Math.random().toString(36).substr(2,11)+".png",c=t.type;return ecount.constValue.isIE?(u=new Date,i=_.merge({},t,{lastModified:u.getTime(),lastModifiedDate:u,name:h,size:t.size,type:c,webkitRelativePath:""})):i=new File([t],h,{type:c}),i.provider_seq||(i.provider_seq=ecount.cloudStorage.INNER),i.getNative=function(){return t},i},pasteImageContents:function(n){this.imageStorageValue="paste";this.uploader_paste={files:n,removeFile:function(){this.files=[]}};this.ecountfileManager.checkStorageQuota(n,function(){this.ecountfileManager.startUpload(n)}.bind(this))},update:function(n){_.merge(this,n);this.setDropdownPosition();this.show()},hide:function(){ecount.layer.dropdown.prototype.hide.apply(this,arguments);ecount.runtime.notify(ECountEvent.Type.LAYER_HIDE,null,{type:this.type,serviceKey:this.ecIKey,ecPageID:this.ecPageID})},ON_MOUSEOVER_SERVICE:function(){},ON_CLICK_SERVICE:function(n,t,i,r){r.originId="imagebox";r.value=!0;this.hide()},ON_MOUSEOUT_SERVICE:function(){}});ecount.class("ecount.layer.boxsizesetting","ecount.layout.layer",{template:'<ul class="dropdown-menu {{css}}" data-service="service.layer" data-service-attr="{{serviceAttr}}" data-servicekey="{{serviceKey}}" data-ownerkey="{{ownerKey}}" style="{{style}}"/>',liTemplate:'<li class="{{liCss}}">{{contents}}<\/li>',items:null,serviceType:"layer",serviceName:"boxsizesetting",init:function(n){ecount.layout.dropdown.prototype.init.apply(this,arguments);this.boxWidth=this.boxWidth;this.boxHeight=this.boxHeight;this.fixed=this.fixed||!1;this.disabledList=($.isString(n.disabledList)?[n.disabledList]:n.disabledList)||[];this.sectionType=n.sectionType||ecount.grid.constValue.sectionType.tbody;this.sectionIndex=n.sectionIndex||0;this.selectedBoundary=n.selectedBoundary||{};this.selectedShapes=n.selectedShapes||[];this.items=[{id:"dimensionHeight",label:ecount.resource.LBL10811,liCss:"dropdown-menu-form tool-dimension-height",value:this.boxHeight},{id:"dimensionWidth",label:ecount.resource.LBL10810,liCss:"dropdown-menu-form tool-dimension-width",value:this.boxWidth},{id:"fixCheck",label:ecount.resource.LBL20566,liCss:"dropdown-menu-form",value:this.fixed},]},getEcPath:function(){return this.ecPath},getEcIKey:function(){return this.ecIKey},setEcIKey:function(){this.ecIKey=ecount.global.registerEcServiceInstance(this,this.serviceType)},getOwnerKey:function(){return this.ownerKey},render:function(n){this.setTemplate();ecount.layout.prototype.render.call(this,n);this.addItems(this.$el)},setTemplate:function(){this.reportType&&(this.css+=" dropdown-menu-icon-list dropdown-menu-report");this.template=ecount.widget.replaceAttr(this.template,{css:this.css,style:this._getStyle(),serviceKey:this.getEcIKey(),ownerKey:this.getOwnerKey(),serviceAttr:ecount.layer.constValue.FOCUSABLE})},setSize:function(n,t){this.boxWidth=n;this.$el.find("input[data-cid=dimensionWidth]").val(n);this.boxHeight=t;this.$el.find("input[data-cid=dimensionHeight]").val(t)},_getStyle:function(){var n="";return this.minWidth&&(n+=["min-width:",this.minWidth,"px"].join("")),n},addItems:function(n){var i;for(n||(n=this.$el),i=0;i<this.items.length;i++){var t=this.items[i],f=t.liCss,r="",u="",e=this.disabledList.some(function(n){return n==t.id});e&&(f+=" disabled",this.fixed=!1);t.id=="fixCheck"?(u=['<span class="form-checkbox" data-function-id="{{ecFunctionId}}">','<input type="checkbox" id="'+t.id+'" '+(this.fixed?"checked":"")+(e?"disabled":"")+">",'<label for="'+t.id+'">',t.label,"<\/label>","<\/span>"].join(""),r=this.liTemplate.replace("{{liCss}}",f).replace("{{contents}}",u).replace("{{ecFunctionId}}",t.id),n.append(r)):(u=t.label+'<input type="number" data-cid="'+t.id+'" class="form-control" value="'+t.value+'" min=0 data-function-id="{{ecFunctionId}}"'+(e?"disabled":"")+">",r=this.liTemplate.replace("{{liCss}}",f).replace("{{contents}}",u).replace("{{ecFunctionId}}",t.id),n.append(r))}},update:function(n){_.merge(this,n);this.setDropdownPosition();this.show()},hide:function(){ecount.layer.dropdown.prototype.hide.apply(this,arguments);ecount.runtime.notify(ECountEvent.Type.LAYER_HIDE,null,{type:this.type,serviceKey:this.ecIKey,ecPageID:this.ecPageID})},ON_CLICK_SERVICE:function(n,t,i,r){var f=this.disabledList.some(function(t){return n.cid==t}),u;if(f)return!1;n.cid=="dimensionHeight"?(u=this.$el.find("input[data-cid=dimensionHeight]").val(),u!=this.boxHeight&&this._setChangedHeight(t.target,r)):n.cid=="dimensionWidth"&&(u=this.$el.find("input[data-cid=dimensionWidth]").val(),u!=this.boxWidth&&this._setChangedWidth(t.target,r));n.id=="fixCheck"&&(this.fixed=!this.fixed,r.key="dimensionFixed",r.value=this.fixed)},ON_FOCUSIN_SERVICE:function(n,t,i,r){(n.cid=="dimensionHeight"||n.cid=="dimensionWidth")&&(r.key="focusInInputControl")},ON_FOCUSOUT_SERVICE:function(n,t,i,r){n.cid=="dimensionHeight"?this._setChangedHeight(t.target,r,!0):n.cid=="dimensionWidth"&&this._setChangedWidth(t.target,r,!0)},_ON_KEYDOWN_SERVICE:function(n,t,i,r){var u=t.which||t.keyCode;u==13&&(n.cid=="dimensionHeight"?this._setChangedHeight(t.target,r):n.cid=="dimensionWidth"&&this._setChangedWidth(t.target,r))},_setChangedHeight:function(n,t,i){var r=parseFloat($(n).val()),e=parseFloat(this.boxWidth),o=parseFloat(this.boxHeight),u,f;r>0&&(this.fixed&&(u=e/o*r,this.boxWidth=Math.round(u),this.$el.find("input[data-cid=dimensionWidth]").val(this.boxWidth)),f=Math.round(r),this.boxHeight=f,$(n).val(this.boxHeight),t.key="dimensionSize",t.value={width:this.boxWidth,height:this.boxHeight,isFocusout:i,sectionType:this.sectionType,sectionIndex:this.sectionIndex,selectedBoundary:this.selectedBoundary,selectedShapes:this.selectedShapes})},_setChangedWidth:function(n,t,i){var r=parseFloat($(n).val()),u=parseFloat(this.boxWidth),f=parseFloat(this.boxHeight);r>0&&(this.fixed&&(temp=f/u*r,this.boxHeight=Math.round(temp),this.$el.find("input[data-cid=dimensionHeight]").val(this.boxHeight)),tempWidth=Math.round(r),this.boxWidth=tempWidth,$(n).val(this.boxWidth),t.key="dimensionSize",t.value={width:this.boxWidth,height:this.boxHeight,isFocusout:i,sectionType:this.sectionType,sectionIndex:this.sectionIndex,selectedBoundary:this.selectedBoundary,selectedShapes:this.selectedShapes})}});ecount.class("ecount.layer.datepicker","ecount.layout.layer",{template:"((layer-datepicker))",serviceType:"layer",serviceName:"datepicker",ownerKey:null,dateSelectorTemplate:'<li data-value="{{value}}" {{class}}><a data-cid="{{cid}}" href="javascript:;">{{label}}<\/a><\/li>',keyStackID:null,_keyStack:"",isModeChangeFired:!1,init:function(n){ecount.layout.prototype.init.apply(this,arguments);this.data=[{serviceKey:this.ecIKey,ownerKey:n.ownerKey}];this._isOnlyFixedDatePicker=n&&n._isOnlyFixedDatePicker===!0?n._isOnlyFixedDatePicker:null;this._isOnlyFixedDatePicker||ecount.runtime.observingOnce("scroll.page.eventContainer",this.ecPageID,function(){this.destroy()}.bind(this))},getEcPath:function(){return this.ecPath},setEcPath:function(){},getEcIKey:function(){return this.ecIKey},setEcIKey:function(){this.ecIKey=ecount.global.registerEcServiceInstance(this,this.serviceType)},show:function(){this.initDatePicker();this.renderDatePicker();this.openDatePicker();ecount.layout.prototype.show.apply(this,arguments)},render:function(){ecount.layout.prototype.render.apply(this,arguments)},initDatePicker:function(){this.$el.dateRangePicker({container:this.$el,singleDate:this.singleDate===undefined?!0:this.singleDate,minYear:this.minYear||1990,minYearLimit:this.minYearLimit,maxYearLimit:this.maxYearLimit,initialized:!0,onBeforeShow:this._ON_BEFORE_SHOW_DATEPICKER.bind(this),parentOffset:_.extend({direction:"right"},this.boundary),closeDatePicker:this.closeDatePicker.bind(this),_defaults:this._getCalendarOption(),_isOnlyFixedDatePicker:this._isOnlyFixedDatePicker})},renderDatePicker:function(){var n=ecount.control.date.serverDate(this.ecPageID);this.$el.data("dateRangePicker").setOptions({eventContainer:$(document),popupID:this.popupID,popupLevel:this.popupLevel,singleDate:this.singleDate===undefined?!0:this.singleDate,_useSlip:this.useSlip||!1,_nowDate:n,isMonthCalendar:this.isMonthCalendar,isDateSpace:this.isDateSpace||!1,selectedSYear:this.selectedSYear,selectedSMonth:this.selectedSMonth,selectedEYear:this.selectedEYear,selectedEMonth:this.selectedEMonth,sYearData:this.sYearData,sMonthData:this.sMonthData,eYearData:this.eYearData,eMonthData:this.eMonthData,hideTodayBtn:!!(this.maxYearLimit&&this.maxYearLimit<=n.getFullYear()),_onlyThisYear:this._onlyThisYear||!1,notUseHolidayConfig:this.notUseHolidayConfig})},openDatePicker:function(){this.$el.data("dateRangePicker").open(!0)},closeDatePicker:function(){ecount.layer.removeLayer(this.ecIKey)},onLayerClickHandler:function(n,t,i,r){switch(n.ecFunctionId){case"year":case"month":return!1;case"calendar.prev":this.$el.data("dateRangeButton").moveToPrev(n,t,r);break;case"calendar.next":this.$el.data("dateRangeButton").moveToNext(n,t,r);break;case"calendar.date":this.onDateClickHandler(n,t,i,r);break;case"calendar.today":if(this._isOnlyFixedDatePicker)break;this.$el.data("dateRangeButton").moveToToday(n,t,r);break;case"calendar.delete":this.onDeleteClickHandler(n,t,i,r)}this._isOnlyFixedDatePicker||ecount.layer.clear(this.ecIKey)},onSelectClickHandler:function(n,t,i,r){this._setDatePickerDate(n,t,r)},onAutocompleteClickHandler:function(n,t,i,r){var u=n.serviceKey.split(ecount.popupIDDelimiter).pop().replace("autocomplete","");return this._setYearValueData(_.extend({},n,{ecFunctionId:u,ecRole:"year"}),t,i,{selected:r.itemList[r.selectedIndex]}),!1},onDateClickHandler:function(n,t,i,r){var u=this.$el.data("dateRangeButton").pickDate(n,t,r);r.selectedDate=u.slice(0);this._isOnlyFixedDatePicker||(+n.ecDatepickerIndex==1||this.singleDate!==!1)&&ecount.layer.removeLayer(this.ecIKey)},onDeleteClickHandler:function(n,t,i,r){var u=this.$el.data("dateRangeButton").deleteDate(n,t,r);r.selectedDate=u.slice(0);ecount.layer.removeLayer(this.ecIKey)},onEnterSelectboxHandler:function(n,t,i,r){var e=+n.ecFunctionId?"e":"s",f=this.isYearFirst?"year":"month",u=Number(n.ecRoleIndex);switch(n.ecRole){case"year":case"month":ecount.layer.clear(this.ecIKey)}r.selected&&this._setDatePickerDate(n,t,{index:(n.ecRole==f?0:1)+(n.ecFunctionId=="0"?0:2),selected:r.selected});n.ecRole=="year"&&t.target.tagName=="INPUT"&&this._setYearValueData(n,t,i,{selected:{value:t.target.value}});this.$el.find("button[data-role-index='"+(u+1)+"']").length>0?this.$el.find("button[data-role-index='"+(u+1)+"']").focus():this.$el.find("button[data-role-index='"+u+"']").blur()},onSelectboxServiceKeydownHandler:function(n,t,i,r){var h=this.isYearFirst?"year":"month",a=(n.ecRole==h?0:1)+(n.ecFunctionId=="0"?0:2),v=this.$el.find('div[data-service="layer.selectbox"]:nth('+a+")"),y=v.attr("data-selected"),p=+n.ecFunctionId?"e":"s",w=n.ecRole.ecCapitalize(),f=this[p+w+"Data"],c=String.fromCharCode(n.which),l,e=[],u,o,s;if(r.selected)this._setDatePickerDate(n,t,{index:r.selected.index,selected:f[r.selected.selectedIndex]});else{for(c!=this._keyStack&&(this._keyStack+=c.toLowerCase()),this.keyStackID&&ecount.global.clearTimeout(this.ecPageID),u=0;u<f.length;u++)o=f[u],o.label&&(""+o.label).toLowerCase().indexOf(this._keyStack)===0&&e.push(u);e.length>0&&(s=e.filter(function(n){return n>y}),l=s.length?s[0]:e[0],this._setDatePickerDate(n,t,{index:(n.ecRole==h?0:1)+(n.ecFunctionId=="0"?0:2),selected:f[l]}));this.keyStackID=ecount.global.setTimeout(this.ecPageID,function(){this.keyStackID=null;this._keyStack=""}.bind(this),300)}},changeAutoCompleteYear:function(n,t,i,r){var f,u;if(r.itemList&&r.itemList.length)f=r.itemList[r.selectedIndex||0];else{if(u=n.value||t.target.value,!u){var s=+n.ecFunctionId?"e":"s",e=this["selected"+s.toUpperCase()+n.ecRole.ecCapitalize(!0)],o=$(t.target).parent("div");if(e.value=="====")return;$(t.target).siblings("button").text(e.label).focus();o.attr("data-selected",e.value);o.removeClass("btn-group-select-edit");o.find("input").addClass("hidden");return}f={label:this._getOptionYearLabel(u),value:u}}this._setYearValueData(n,t,i,{selected:f})},getLayerServiceKey:function(n){var t=this.ecIKey+ecount.popupIDDelimiter+n.ecRoleIndex;return ecount.common.makeServiceKey(n.ecPath,t)},getLayerSelectboxOption:function(n,t){var u=this.isYearFirst?"year":"month",f={type:"selectbox",ecPageID:this.ecPageID,serviceKey:this.getLayerServiceKey(n,t),ownerKey:this.ecIKey,popupID:this.popupID,popupLevel:this.popupLevel,from:"layer",showingUpDelay:0,index:(n.ecRole==u?0:1)+(n.ecFunctionId=="0"?0:2)},i=$(t.target).parent("div"),e=+n.ecFunctionId?"E":"S",r=e+n.ecRole.ecCapitalize();return $.extend(f,{boundary:$.extend(i.offset(),{width:i.width(),height:i.height()}),selectedLabel:this["selected"+r].label,selectedValue:this["selected"+r].value,option:this[r.ecCamelize(!0)+"Data"]})},getLayerAutocompleteOption:function(n,t){var r=this.isYearFirst?"year":"month",u={type:"autocomplete",ecPageID:this.ecPageID,serviceKey:this.getLayerServiceKey(n,t)+"autocomplete",ownerKey:this.ecIKey,popupID:this.popupID,popupLevel:this.popupLevel,from:"layer",showingUpDelay:0,index:(n.ecRole==r?0:1)+(n.ecFunctionId=="0"?0:2)},i=$(t.target).parent("div");return $.extend(u,{boundary:_.extend(i.offset(),{width:i.width(),height:i.height()})})},openSelectLayer:function(n,t,i,r){if(n.ecRole!==undefined){var u=this.getLayerSelectboxOption(n,t,i,r);ecount.layer.show(u)}},openAutocompleteLayer:function(n,t,i,r){var u=this.getLayerAutocompleteOption(n,t,i,r);ecount.layer.update(_.extend(u,{value:t.target.value,searchSourceList:this.eraList||[],setupHandler:function(n,t,i){i(t)},responseFilter:this.autoCompleteListFilter.bind(this)}))},autoCompleteListFilter:function(n,t){return(t=(""+t).replace(/\D*/g,""),$.isEmpty(t)||!_.isNumber(+t))?[]:Object.getOwnPropertyNames(n).filter(function(i){return i!="length"&&n[i].indexOf(t)>1}).map(function(t){return{id:t,label:n[t],value:t}})},setDateRange:function(){var n,t,i=_.isArray(arguments[0]),r=this.$el.data("dateRangePicker");n=i?arguments[0][0]:arguments[0]||null;t=arguments[1]?arguments[1]:i?arguments[0][1]||null:null;n&&this.$el.data("dateRangePicker").setDateRange(n,t)},redraw:function(){this.$el.data("dateRangePicker").redraw()},_getCalendarOption:function(){var t=!(["en-US","id-ID","vi-VN","es"].indexOf(Date.CultureInfo.LANG)>-1),n=this.calendarData;return{holidayHandler:this._getHolidayHandler(),isYearFirst:this.isYearFirst,firstDay:n.STARTWEEK,showMonthAfterYear:t,dateInfo:{MAXYEAR:parseInt(n.MAXYEAR,10),MINYEAR:parseInt(n.MINYEAR,10),WEEK:n.WEEK||{}}}},_getOptionYearLabel:function(n){return this.eraList&&this.eraList[n]?this.eraList[n]:n},_getHolidayHandler:function(){var t=this.holidayURL,i=this.notUseHolidayConfig,n=ecount.cacheInfo&&ecount.cacheInfo.CalendarHash?ecount.cacheInfo.CalendarHash:"";return function(){return{getYearHalfYearString:function(n,t){return n+(t>6?"7":"1")},find:function(t,i){return new Promise(function(r){var f=this.getYearHalfYearString(t,i),u;if($.resetHoliday(f,n),u=$.getHolidayList(f),u&&u.length>0)return r(u);this.request(t,i).then(function(n){r(n)})}.bind(this))},request:function(r,u){function e(t){var i=ecount.control.date.setHolidayInfo({});$.addHoliday(f,i.HOLIDAYLIST,n);t&&t()}var f;return(r=r||(new Date).getFullYear(),f=this.getYearHalfYearString(r,u||1),u=u>6?7:1,i)?(e(),Promise.resolve([])):new Promise(function(i,o){var s={url:t||"/ECAPI/SVC/Common/Infra/GetListHolidayCache",data:{Year:r,StartMonth:u.valueOf().padding(2),EndMonth:(u+5).valueOf().padding(2),isNotHoliday:!0},versionType:"",versionName:"",hashKey:n};return ecount.cache.api(s).then(function(t){var r=ecount.control.date.setHolidayInfo(t);$.addHoliday(f,r.HOLIDAYLIST,n);i(r.HOLIDAYLIST)}).catch(e.bind(null,o))})}}}()},_getNextOption:function(n){var f=+n.ecFunctionId?"e":"s",e=this.isYearFirst?"year":"month",o=f+n.ecRole.ecCapitalize(),r=this[o+"Data"],s=this["selected"+f.toUpperCase()+n.ecRole.ecCapitalize(!0)],t=_.findIndex(r,function(n){return n.value==s.value}),i,u;switch(n.handler){case ECountEvent.Type.KEYDOWN_ARROW_UP:case ECountEvent.Type.KEYDOWN_ARROW_UP_SELECT_LAYER:i=t<=1?0:t-1;break;case ECountEvent.Type.KEYDOWN_ARROW_DOWN:case ECountEvent.Type.KEYDOWN_ARROW_DOWN_SELECT_LAYER:i=t+1>=r.length?t:t+1;break;default:i=t}return u=r[i],u.index=(n.ecRole==e?0:1)+(n.ecFunctionId=="0"?0:2),u},_setDatePickerDate:function(n,t,i){var e=i.index,f=this.$el.find('div[data-service="layer.selectbox"]:nth('+i.index+")"),u,r;switch(e){case 0:u=this.isYearFirst?"SYear":"SMonth";break;case 1:u=this.isYearFirst?"SMonth":"SYear";break;case 2:u=this.isYearFirst?"EYear":"EMonth";break;case 3:u=this.isYearFirst?"EMonth":"EYear"}if(r=i.selected?i.selected:this[u.ecCamelize(!0)+"Data"][n.ecFunctionId],r.id&&~r.id.indexOf("_manual")){this.isModeChangeFired=!0;f.addClass("btn-group-select-edit");f.find("input").val("").removeClass("hidden").focus();return}if(r.value==ecount.resource.LBL05716){f.find("button").text(r.label);return}this["selected"+u].value=r.value;this["selected"+u].label=r.label;f.attr("data-selected",r.value);f.find("button").text(r.label).focus();~u.indexOf("Year")?this.$el.data("dateRangeButton").setYear(n,r.value,e>1?"month2":"month1"):this.$el.data("dateRangeButton").setMonth(n,r.value,e>1?"month2":"month1");this.$el.data("dateRangeButton").moveToSelectedMonth(n,e>1?"month2":"month1")},_setYearValueData:function(n,t,i,r){var y=this.maxYearLimit||ecount.control.date.serverDate(this.ecPageID).getFullYear()+1,p=this.minYearLimit&&this.minYearLimit<this.minYear?this.minYearLimit:this.minYear,s=$(t.target).parent("div"),o=n.ecFunctionId,w=+n.ecFunctionId?"e":"s",f=w+n.ecRole.ecCapitalize(),h=this[f+"Data"],u=r.selected||h[o],c=ecount.control.date.getSelctedERA(this.eraList,u.value);if(c&&(u=c),u){var e=u.value,l=u.label,a,v=e<=y&&e>=p;if(!v&&(u.label||(u.label=e),this.setInvalidYear(o,u),!this.notUseHide)){this.hide();return}(!this.notUseHide||v)&&((a=h.find(function(n){return n.value==e}))?l=a.label:(this[f+"Data"]=h.filter(function(n){return n.id!="manualInput"}),this[f+"Data"].splice(this[f+"Data"].length-1,0,{id:"manualInput",label:u.label,value:e})));this.$el.data("dateRangeButton").setYear(n,u.value,o>0?"month2":"month1");this.$el.data("dateRangeButton").moveToSelectedMonth(n,o>0?"month2":"month1");this["selected"+(f=="eYear"?"EYear":"SYear")].value=u.value;this["selected"+(f=="eYear"?"EYear":"SYear")].label=u.label;this.isModeChangeFired=!0;$(t.target).siblings("button").text(l).focus();s.attr("data-selected",e);s.removeClass("btn-group-select-edit");s.find("input").addClass("hidden")}},ON_CLICK_SERVICE:function(n,t,i,r){if(t.pageX==0&&t.pageY==0&&t.clientX==0&&t.clientY==0)return!1;switch(n.handler){case ECountEvent.Type.CLICK_SELECT:return["INPUT","DIV"].contains(t.target.tagName)||(t.target.tagName=="SPAN"&&$(t.target).siblings("button").focus(),this.openSelectLayer(n,t,i,r)),!1}switch(n.ecFunction){case"select":return this.onSelectClickHandler(n,t,i,r);case"autocomplete":return this.onAutocompleteClickHandler(n,t,i,r);case"datepicker":return this.onLayerClickHandler(n,t,i,r)}},ON_KEYDOWN_ESC_SERVICE:function(n,t,i,r){switch(n.ecRole){case"year":case"month":ecount.layer.clear(this.ecIKey);r.layerClosed=!0;r.serviceName=this.serviceName}},ON_KEYDOWN_ENTER_SERVICE:function(n,t,i,r){if(n.ecRole){switch(n.ecService){case"layer.selectbox":this.onEnterSelectboxHandler(n,t,i,r);break;case"layer.autocomplete":this.changeAutoCompleteYear(n,t,i,r)}return!1}},ON_KEYDOWN_ARROW_UP_SERVICE:function(n,t,i,r){if(~["year","month"].indexOf(n.ecRole)&&n.ecService=="layer.selectbox"){var u=this._getNextOption(n);this._setDatePickerDate(n,t,{index:u.index,selected:{value:u.value,label:u.label}})}return~["year","month"].indexOf(n.ecRole)&&n.ecService=="layer.autocomplete"&&this.changeAutoCompleteYear(n,t,i,r),!1},ON_KEYDOWN_ARROW_DOWN_SERVICE:function(n,t){if(~["year","month"].indexOf(n.ecRole)&&n.ecService=="layer.selectbox"){var i=this._getNextOption(n);this._setDatePickerDate(n,t,{index:i.index,selected:{id:i.id,value:i.value,label:i.label}})}return!1},ON_KEYPRESS_OTHERS_SERVICE:function(n,t,i,r){switch(n.ecService){case"layer.selectbox":return this.onSelectboxServiceKeydownHandler(n,t,i,r)}},ON_INPUT_SERVICE:function(n,t,i,r){n.handler==ECountEvent.Type.INPUT_AUTOCOMPLETE_LAYER&&t.target.tagName=="INPUT"&&(t.target.value=(""+t.target.value).replace(/\D*/g,"").substring(0,4),this.openAutocompleteLayer(n,t,i,r))},ON_MOUSEDOWN_SERVICE:function(n,t,i,r){return n.ecService=="layer.autocomplete"&&(this.changeAutoCompleteYear(n,t,i,r),n.stopPropagation=!0),!1},ON_FOCUSIN_SERVICE:function(){this.isModeChangeFired=!1},ON_FOCUSOUT_SERVICE:function(n,t,i){var r,u,f;return n.ecRole?this.isModeChangeFired?!1:(r=t.target,n.ecRole=="year"&&(r.tagName=="INPUT"?(u=r.value||this.$el.data("dateRangeButton").getYear($(r).closest("div.datepicker").attr("data-datepickerindex")||0),this._setYearValueData(n,t,i,{selected:{value:u,label:u}})):r.innerText==ecount.resource.LBL05716&&(f=$(r),this.isModeChangeFired=!0,f.parent("div").addClass("btn-group-select-edit"),f.siblings("input").removeClass("hidden").focus())),!1):!1},onKeyInputFilter:function(n,t){var i=n.value;if(this.eraList)return this._filteringEraList(n,t);i.length&&isNaN(Number(i))&&(i=i.replace(this.nonNumericReg,""));i.length>4&&(i=i.substring(0,4));t.target.value=i},_ON_BEFORE_SHOW_DATEPICKER:function(){var n=this.beforeShowDatePickerHandler();n&&(this.$el.data("dateRangePicker").setDateRange(n[0],n[1]),!n[0]&&this.maxYearLimit&&this.$el.data("dateRangePicker").setCurrDate(ecount.control.date.serverDate(this.ecPageID),n[1]))}});ecount.class("ecount.layer.report","ecount.layer.dropdown",{ON_MOUSEOUT_SERVICE:function(){return!0}});ecount.class("ecount.layer.reportalign","ecount.layer.dropdown",{ON_MOUSEOUT_SERVICE:function(){return!0}});ecount.class("ecount.layer.spectrum","ecount.layout.layer",{template:"((layer-spectrum))",serviceType:"layer",serviceName:"spectrum",ownerKey:null,zIndex:null,init:function(n){ecount.layout.prototype.init.apply(this,arguments);this.data=[{serviceKey:this.ecIKey,ownerKey:n.ownerKey}]},getEcPath:function(){return this.ecPath},setEcPath:function(){},getEcIKey:function(){return this.ecIKey},setEcIKey:function(){this.ecIKey=ecount.global.registerEcServiceInstance(this,this.serviceType)},show:function(){this.renderSpectrum();ecount.layout.prototype.show.apply(this,arguments);this.$el.css("zIndex",this.zIndex);this.$el.removeClass("hidden")},render:function(){ecount.layout.prototype.render.apply(this,arguments)},onLayerClickHandler:function(n,t,i,r){var u;r.cindex=this.cindex;switch(n.ecFunctionId){case"spectrum.color":u=this.$el.data("spectrumButton").clickPalette(n,t);this.onClickPaletteHandler(u,n,t,r);break;case"spectrum.choose":u=this.$el.data("spectrumButton").clickChoose(n,t);this.onClickPaletteHandler(u,n,t,r);break;case"spectrum.more":this.$el.data("spectrumButton").moreToggle(n,t,i,r)}},onClickPaletteHandler:function(n,t,i,r){var u=n;r.selected=u;this.$el.data("spectrumButton").destroy();ecount.layer.clear(this.ecIKey);ecount.layer.removeLayer(this.ecIKey)},renderSpectrum:function(){this.$el.spectrum({ecRole:this.ecRole,ecRoleIndex:this.ecRoleIndex,appendTo:this.appendTo||this.$el,preferredFormat:this.preferredFormat||"Hex",showInitial:this.showInitial||!1,showInput:this.showInput||!1,showPaletteOnly:this.showPaletteOnly||!1,togglePaletteOnly:this.togglePaletteOnly||!1,togglePaletteMoreText:this.togglePaletteMoreText||ecount.resource.BTN00108,togglePaletteLessText:this.togglePaletteLessText||ecount.resource.LBL10378,hideAfterPaletteSelect:this.hideAfterPaletteSelect||!1,change:this.change||function(){}.bind(this),cancelText:this.cancelText||ecount.resource.BTN00133,chooseText:this.chooseText||ecount.resource.BTN00357,offsetSpectrumParent:this.boundary,isAlwaysShowPalette:this.isAlwaysShowPalette||!1,color:this.color||"#ffffff",palette:this.palette||[["#ffffff","#f3f3f3","#eeeeee","#cccccc","#999999","#666666","#444444","#000000"],["#ff0000","#ff9900","#ffff00","#00ff00","#00ffff","#0000ff","#9900ff","#ff00ff"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#cc0000","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#990000","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#660000","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]]});this.$el.data("spectrum").show()},ON_CLICK_SERVICE:function(n,t,i,r){switch(n.ecFunction){case"spectrum":this.onLayerClickHandler(n,t,i,r)}}});ecount.class("ecount.layer.palette","ecount.layout.layer",{template:'<ul class="dropdown-menu {{css}}" data-service="service.layer" data-servicekey="{{serviceKey}}" data-ownerkey="{{ownerKey}}""/>',serviceType:"layer",serviceName:"palette",ownerKey:null,zIndex:null,init:function(n){ecount.layout.prototype.init.apply(this,arguments);this.css=n.css||"";this.disabledList=($.isString(n.disabledList)?[n.disabledList]:n.disabledList)||[]},getEcPath:function(){return this.ecPath},setEcPath:function(){},getEcIKey:function(){return this.ecIKey},setEcIKey:function(){this.ecIKey=ecount.global.registerEcServiceInstance(this,this.serviceType)},getOwnerKey:function(){return this.ownerKey},show:function(){this.$el.addClass("show");this.palette&&(this.palette.setPaletteView(),this.palette.setHelperPosition(),this.palette.setDragEvent())},destroy:function(){this.palette&&this.palette.destroy();this.removeItems();ecount.widget.removeChild(this.$el[0]);this.$el=null;delete this.$el},hide:function(){ecount.layer.removeLayer(this.ecIKey)},removeItems:function(){this.$el.find("a").off();this.$el.find("li").remove()},render:function(){this.setTemplate();ecount.layout.prototype.render.apply(this,arguments);this.items&&this.addItems(this.items.toArray(),this.$el)},setTemplate:function(){this.css+=this.reportType?" dropdown-menu-icon-list dropdown-menu-report":" dropdown-menu-icon-list dropdown-menu-color-picker";this.template=ecount.widget.replaceAttr(this.template,{css:this.css,serviceKey:this.getEcIKey(),ownerKey:this.getOwnerKey()})},addItems:function(n,t){var r,f;for(t||(t=this.$el),r=0,f=n.length;r<f;r++){var i=n[r],u="",e="";u=i.isPalette?this._getPaletteItem(i):i.isChildPalette?this._getChildPaletteItem(i):i.divider?'<li class="divider"><\/li>':i.isCheckbox?this._getCheckboxItem(i):this._getBaseTypeListedItem(i);i.isChildDepth==!0?(this.isChildDepth=!0,this.addChildItems(u,i.childItems,r),t.append(u)):(t.append(u),i.isPalette&&(e=this._getBaseTypeListedItem({id:"toggleDetails",label:ecount.resource.LBL20558,css:"tool-color-more"}),t.append(e)))}},addChildItems:function(n,t,i){var u=$(this.eventContainer||document.body),f=this.reportType?"dropdown-menu-report ":"dropdown-menu-color-picker ",r=$('<ul class="dropdown-menu dropdown-menu-icon-list '+f+(t.length>8?" dropdown-menu-fixed-height":"")+'"data-childItem="childItem_'+(i||0).toString()+'"><\/ul>');n.addClass("dropdown-menu-item-group");n.append(r);this.addItems(t,r);n.children("a").bind("mouseenter",this.onMouseoverChildUlHandler.bind(this,u,n,r));n.bind("mouseleave",function(){n.removeClass("open")});n.bind("click",function(t){var i=$(t.target),u=i.attr("data-cid"),r=i.attr("data-function-id");(r=="palette.color"||r=="noneBackgroundColor")&&n.find("span").css({"background-color":u||"#ffffff"})}.bind(this));r.bind("mouseenter",function(n){this.toggleParentDropdown(n,!0)}.bind(this));r.bind("mouseleave",function(n){this.toggleParentDropdown(n,!1)}.bind(this))},_getCssTemplate:function(n){return[n.css,n.hide?"hidden":"",n.active?"active":""].join(" ").trim()},_getDefaultLiTemplate:function(n){var t=(n.liCss||"").trim(),i=this.disabledList.some(function(t){return t==n.id});return i&&(t+=" disabled"),(n.id==this.borderWidth||n.id==this.borderStyle)&&(t+=" active"),'<li class="{{css}}">'.replace(/{{css}}/g,t)},_getBaseTypeListedItem:function(n){var i=this._getCssTemplate(n),r=this._getDefaultLiTemplate(n),t="";return n.spanCss&&(t='<span class="'+n.spanCss+'" data-function-id="'+(n.functionId||n.id)+'" data-cid="'+n.id+'"><\/span>'),$(r+'<a class="'+i+'" href="javascript:;" data-trigger="click" data-service="service.layer" data-function-id="'+(n.functionId||n.id)+'" data-value="'+(n.value||"")+'" data-cid="'+n.id+'">'+(n.label||"")+t+"<\/a><\/li>")},_getChildPaletteItem:function(n){n.liCss=n.liCss||"";var t=this._getCssTemplate(n),i=this._getDefaultLiTemplate(n);return $(i+'<a class="'+t+'" href="javascript:;" data-trigger="click" data-service="service.layer" data-function-id="'+n.id+'" data-value="'+(n.value||"")+'" data-cid="'+n.id+'"><span class="tool-color-display line" style="background-color: '+(this.color||"")+'"><\/span>'+n.label+"<\/a><\/li>")},_getCheckboxItem:function(n){var t=this._getDefaultLiTemplate(n),i=this.stripePattern?"checked":"";return $(t+'<span class="form-checkbox"><input data-function-id="'+n.id+'" data-trigger="click" data-service="service.layer" type="checkbox" id="'+n.id+'" '+i+'><label for="'+n.id+'">'+n.label+"<\/label><\/li>")},_getPaletteItem:function(n){n.liCss=n.liCss||"";n.liCss+=" dropdown-menu-text";var i=this._getDefaultLiTemplate(n),t=$(i+"<\/li>");return this.palette=new ecount.palette({color:this.color}),this.palette.render(t),t},onMouseoverChildUlHandler:function(n,t,i){var r=2-ecount.common.getZoomRatio(),f=(n.outerWidth()||window.outerWidth)/r,e=(n.outerHeight()||window.outerHeight)/r,u=t.offset();i.show();t.removeClass("dropdown-menu-item-group-left").removeClass("dropdown-menu-item-group-top").addClass("open");u.left+t.width()+i.width()>f&&t.addClass("dropdown-menu-item-group-left");u.top+i.height()>e&&t.addClass("dropdown-menu-item-group-top")},toggleParentDropdown:function(n,t){var r=n.currentTarget.getAttribute("data-childitem"),i=$(n.currentTarget).parent(),u=i.data("childitem");r===u&&(t?i.hasClass("open")||i.addClass("open"):i.hasClass("open")&&i.removeClass("open"))},onLayerClickHandler:function(n,t,i,r){var u=ecount.global.getEcInstance(this.getOwnerKey()),f;this.ecRole&&(r.ecRole=this.ecRole);this.ecRoleIndex&&(r.ecRoleIndex=this.ecRoleIndex);switch(n.ecFunctionId){case"palette.color":r.key=u?u.cid:"palette";r.value=n.cid;this.palette.setColorData(n.cid);this.hide();break;case"toggleDetails":this.palette.togglePalette();break;case"noneBackgroundColor":r.key=u?u.cid:"palette";r.value="";this.palette.setColorData("");this.hide();break;case"palette.button":f=this.palette.getColorData();r.key=u?u.cid:"palette";r.value=f.toHexString();this.hide();break;case"stripePattern":r.key="stripePattern";r.value=t.target.checked;break;case"borderPosition":r.key="borderPosition";r.value=n.cid;this.hide();break;case"borderStyle":r.key="borderStyle";r.value=this.borderStyle=n.cid;this.hide();break;case"borderWidth":r.key="borderWidth";r.value=this.borderWidth=n.cid;this.hide()}},onLayerFocusoutHandler:function(n,t){switch(n.ecFunctionId){case"palette.input":var i=$(t.target).val();this.palette.setColorData(i);this.palette.setHelperPosition()}},ON_CLICK_SERVICE:function(n,t,i,r){var u=this.disabledList.some(function(t){return n.cid==t});if(n.ecFunctionId&&!u){this.onLayerClickHandler(n,t,i,r);return!0}return!1},ON_FOCUSIN_SERVICE:function(n,t,i,r){switch(n.ecFunctionId){case"palette.input":r.key="focusInInputControl"}},ON_FOCUSOUT_SERVICE:function(n,t,i,r){switch(n.ecFunction){case"palette":this.onLayerFocusoutHandler(n,t,i,r)}}});ecount.class("ecount.layer.selectbox","ecount.layout.layer",{template:"((layer-select))",editNewModeTemplate:"((layer-select-editNewMode))",serviceType:"layer",serviceName:"selectbox",ownerKey:null,liTemplate:'<li data-value="{{value}}" data-function="select" data-function-id="{{index}}" data-service="service.layer" class="{{style.display}} {{style.css}} {{style.functionalCss}}" >\n<a href="javascript:;" data-function="select" data-function-id="{{index}}" data-service="service.layer" class="{{style.functionalCss}}{{style.anchorCss}}">{{prefixTag}}{{label}}<\/a>\n<\/li>',reportTemplate:'<ul data-service="layer.selectbox" data-servicekey= "{{serviceKey}}" data-notclear="mousedown" class="{{style.css}}" style="{{style}}" data-index="{{index}}" data-ownerkey={{ownerKey}}>{{listItemHtml}}<\/ul>',reportLiTemplate:'<li data-value="{{value}}" data-function="select" data-function-id="{{index}}" data-service="service.layer" class="{{style.display}} {{style.css}} {{style.functionalCss}}" >\n<a href="javascript:;" data-function="select" data-function-id="{{index}}" data-service="service.layer" class="{{style.functionalCss}}{{style.anchorCss}}" style="{{aStyle}}">{{prefixTag}}{{label}}<\/a>\n<\/li>',dividerTemplate:'<li class="divider"><\/li>',editSymbol:'<span data-value="{{value}}" data-role-id="selectboxEditForm" data-function="selectboxEditForm" data-function-id="{{index}}" data-service="service.layer" data-is-edit="true" class="dropdown-menu-item-edit"><\/span>',editFormLiTemplate:'<li data-value="{{value}}" data-function="select" data-function-id="{{index}}" data-service="service.layer" class="{{style.display}} {{style.css}} {{style.functionalCss}}" >\n{{editSymbol}}\n<a href="javascript:;" data-function="select" data-function-id="{{index}}" data-service="service.layer" class="{{style.functionalCss}}{{style.anchorCss}}">{{prefixTag}}{{label}}<\/a>\n<\/li>',headerTemplate:'<div class="dropdown-menu-header">\n{{quickEntry}}\n<\/div>',quickEntry:'<a href="javascript:;" data-value="{{value}}" data-function="quickEntry" data-function-id="{{index}}" data-service="service.layer" class="text-bold recommend-word">\n{{quickEntryInner}}\n<\/a>',quickEntryInner:['<span data-id="quickEntry" data-function="quickEntry" data-function-id="{{labelIndex}}" class="label label-default">추천<\/span>','<span data-id="quickEntry" data-function="quickEntry" data-function-id="{{index}}">{{dataValueText}}<\/span>',].join("\n"),footerTemplate:'<div class="dropdown-menu-footer {{hiddenFooter}}"><a class="text-bold {{style.css}}" href="javascript:;" data-service="service.layer"  data-function="footer" data-function-id="{{ecFunctionId}}" data-role-id="{{ecRoleId}}">{{label}}<\/a><\/div>',prefixTemplate:'<span class="{{style.css}}"><\/span>',indexReg:/{{index}}/g,functionalCssReg:/{{style.functionalCss}}/g,activeClass:"active checked-item",checkedClass:"checked-item",liItems:null,keyStackID:null,_keyStack:"",useRecommendOption:!1,recommendValue:"",getEcPath:function(){return this.ecPath},setEcPath:function(){},getEcIKey:function(){return this.ecIKey},isHiddenBody:function(){return this.useRecommendOption?this._options.hiddenBody:!1},setEcIKey:function(){this.ecIKey=ecount.global.registerEcServiceInstance(this,this.serviceType)},getOwnerInstance:function(){return ecount.global.getEcInstance(this.getOwnerKey())},getOwnerKey:function(){return this.ownerKey},show:function(n){var t,i,r;ecount.layout.prototype.show.apply(this,arguments);t=this.$el.offset();i=this.$el.outerHeight();t.top+i>window.innerHeight&&this.$el.css("top",t.top-i-this.height);this.$el.css("min-width",0);r=(n.boundary.width?Number(n.boundary.width):"0")+"px";this.boundary.width>this.$el.outerWidth()?this.$el.css("width",r):this.$el.css("min-width",r);this.setScrollPosition("middle")},render:function(){this.setUseRecommendOption();this.setTemplate();this.useRecommendOption&&(this.css=this.css+" dropdown-menu-recommend-word");this.option=this.option.map(this._getAttributesFromOption.bind(this));this.data=[{serviceKey:this.ecIKey,ownerKey:this.ownerKey,style:this.getListStyle(),headerTemplate:this.getHeaderTemplate(),listItemHtml:this.getListedItems(),footerTemplate:this.getFooterTemplate(),"style.css":this.css||"dropdown-menu-checked-list position-fixed",hiddenItem:this.isHiddenBody()?"hidden":""}];ecount.runtime.observingOnce("scroll.page.eventContainer",[this.ecPageID,"selectbox"].join("_"),function(){this.destroy()}.bind(this));this.isReport&&(this.template=ecount.widget.replaceAttr(this.reportTemplate,this.data[0]));ecount.layout.prototype.render.apply(this,arguments)},setUseRecommendOption:function(){var n=this.getOwnerInstance();$.isEmpty(n)||(this.useRecommendOption=n.getState(n._IT_SELF,"useRecommendOption"),this.recommendValue=n.getState(n._IT_SELF,"recommendValue"))},setTemplate:function(){var n=this.option.some(function(n){return!!n.isFooterOption});this.useRecommendOption||n||this.isNewFormMode||this.isEditFormMode?this.template=this.editNewModeTemplate:this.isReport&&(this.template=this.reportTemplate)},update:function(n){$.extend(this,n);this.data.listItemHtml=this.getListedItems();this.$el&&this.$el.html(this.data.listItemHtml)},getListStyle:function(){var n=[],t={top:0,left:0};return ecount.common.isInApp&&ecount.common.isIOS&&(t={top:$(window).scrollTop(),left:$(window).scrollLeft()}),n.push("top: "+(+this.boundary.top+ +this.boundary.height-t.top)+"px"),n.push("left: "+(this.boundary.left-t.left)+"px"),n.push("min-width: "+(this.boundary.width?Number(this.boundary.width):"0")+"px"),this.isResponsiveHeight&&n.push("max-height: none"),n.join(";")},getHeaderTemplate:function(){var n="",t;return this.useRecommendOption&&this.selectedValue!=this.recommendValue&&(this.option=this.option.map(function(n){return this.recommendValue==n.value&&(n.recommend=!0),n}.bind(this)),t=this.option.filter(function(n){return!!n.recommend}).map(function(n){var t=this.quickEntryInner.replace("{{labelIndex}}",n.index).replace("{{index}}",n.index).replace("{{dataValueText}}",n.label);return this.quickEntry.replace("{{value}}",n.value).replace("{{index}}",n.index).replace("{{quickEntryInner}}",t)}.bind(this)).join("\n"),n=this.headerTemplate.replace("{{quickEntry}}",t)),n},getListedItems:function(){var n,t;return this.option?(n=this.option,t=this.selectedValue==undefined?n.head(function(n){return n.label==this.selectedLabel&&!$.isNull(n.value)}.bind(this)):n.head(ecount.control.select.optionFindingPredicate.bind(n,this.selectedValue)),n.forEach(function(n){n["style.css"]=""}),t&&!t["style.css"]&&(t["style.css"]=$.isNull(t.activeCss)?this.activeClass:t.activeCss),_.isEmpty(this.recommendValue)||(n=n.filter(function(){return t.value!=this.recommendValue})),n.map(function(n,t){var i="";return this.isEditFormMode&&(n.isEditMode||!1)?i=ecount.widget.replaceAttr(this.editFormLiTemplate,n):this.isReport?i=this.reportLiTemplate:n.isFooterOption||(i=this.liTemplate),n.isChecked&&(n["style.css"]=n["style.css"].replace(this.checkedClass,"")+" "+this.checkedClass),ecount.widget.replaceAttr(i,n).replace(this.indexReg,t).replace(this.functionalCssReg,n.functionalCss||"")}.bind(this)).join("\n")):"&nbsp;"},getFooterTemplate:function(){var t=this.option.filter(function(n){return n.isFooterOption}),i=!1,r=!1,n,u,f;return $.isEmpty(t)||(r=!0,i=t.some(function(n){return n.value===this.selectedValue}.bind(this))),n="",u=this.option.length-1,r?n=t.map(function(n){return n.ecFunctionId=u,n.ecRoleId=n.isFooterCustomRoleId?"selectbox"+n.value.ecCapitalize(!0):"selectboxAddNew",n["style.css"]=i?this.activeClass:"",n.hiddenFooter=this.isHiddenBody()?"hidden":"",ecount.widget.replaceAttr(this.footerTemplate,n)}.bind(this)).join("\n"):this.isNewFormMode&&(f={ecFunctionId:u,ecRoleId:r&&"selectboxAddNew"||this.isNewFormMode&&"selectboxAddNewForm","style.css":i?this.activeClass:"",label:this.newFormTitle,hiddenFooter:this.isHiddenBody()?"hidden":""},n=ecount.widget.replaceAttr(this.footerTemplate,f)),n},_getAttributesFromOption:function(n,t){var i=_.cloneDeep(n);return i.css=this.functionalCssReg,n.functionalCss||"",i.index=t,i.prefixTag=i.prefixCss?this.prefixTemplate.replace("{{style.css}}",n.prefixCss):"",i.editSymbol=this.isEditFormMode&&n.isEditMode?this.editSymbol:"",i["style.css"]=n.liCss?n.liCss:"",i["style.display"]=n["style.display"]===!1?"hidden":"",i["style.anchorCss"]=n.className?n.className:"",i},getCurrentSelectedItem:function(){var n=this.$el.find(".active"),t;if(n.length)return t=this.useRecommendOption?n.attr("data-function-id"):n.index(),_.extend({index:t},this.option[t])},setScrollPosition:function(n){var t=this.$el,u=t.find(".active"),f,i;if(u.length){var e=u.outerHeight(),i=t[0].scrollTop,f=this.$el.outerHeight(),r=u[0].offsetTop;switch(n){case"middle":r>f?t.scrollTop(r-f/2):t.scrollTop(0);break;case"up":r-i<0&&t.scrollTop(i-e);break;case"down":r+e-i>f&&t.scrollTop(i+e)}}},setNextOption:function(n,t,i,r){var o=this.$el.find(".active"),u,e,f,s,h,c;if(!o.length){this.getFooterElement().find("a[data-function-id=0]").addClass("active");this.getItemElement().children(":nth(0)").addClass("active");return}u={type:o.attr("data-function"),index:parseInt(o.attr("data-function-id"))};switch(n.handler){case ECountEvent.Type.KEYDOWN_ARROW_UP:case ECountEvent.Type.KEYDOWN_ARROW_UP_SELECT_LAYER:case ECountEvent.Type.KEYDOWN_ARROW_UP_AUTOCOMPLETE_LAYER:if(u.type==="quickEntry"){_.merge(r,{prevLayerSection:u.type,nextLayerSection:u.type,nextOption:f});return}if(!!this.useRecommendOption&&u.index==0){h=this.getQuickEntryElement();this.getItemElement().children(u.index).removeClass("active");h.addClass("active");e=h.attr("data-function-id");f=this.option[e];this.selectedValue=f.value;this.selectedLabel=f.label;_.merge(r,{prevLayerSection:u.type,nextLayerSection:"quickEntry",nextOption:f});return}if(u.index==0)return;if(e=u.index-1,s="up",u.type==="footer"){this.getFooterElement().children(u.index).removeClass("active");this.getItemElement().find("li[data-function-id="+e+"]").addClass("active");return}break;case ECountEvent.Type.KEYDOWN_ARROW_DOWN:case ECountEvent.Type.KEYDOWN_ARROW_DOWN_SELECT_LAYER:case ECountEvent.Type.KEYDOWN_ARROW_DOWN_AUTOCOMPLETE_LAYER:if(r.removeClassHidden){c=this.getQuickEntryElement();this.getItemElement().children(u.index).removeClass("active");c.addClass("active");f=this.option[0];this.selectedValue=f.value;this.selectedLabel=f.label;_.merge(r,{prevLayerSection:"",nextLayerSection:"select",nextOption:f});return}if(u.type==="quickEntry"){this.getQuickEntryElement().removeClass("active");this.getItemElement().children(":nth(0)").addClass("active");f=this.option[0];this.selectedValue=f.value;this.selectedLabel=f.label;_.merge(r,{prevLayerSection:u.type,nextLayerSection:"select",nextOption:f});return}if(this.option.length<=u.index+1)return;if(e=u.index+1,s="down",f=this.option[e],f.isFooterOption){this.getItemElement().children(u.index).removeClass("active");this.getFooterElement().find("a[data-function-id="+e+"]").addClass("active");return}}e!==undefined&&(f=this.option[e],this.selectedValue=f.value,this.selectedLabel=f.label,u.type==="select"&&(this.getItemElement().children(u.index).removeClass("active"),this.getItemElement().children(":nth("+e+")").addClass("active")),this.setScrollPosition(s))},setCurrentSelection:function(n){var i=this.$el.find(".active"),t,r;i.length&&(t=i.index(),r=t+n,this.$el.children(t).removeClass("active"),this.$el.children(":nth("+r+")").addClass("active"))},onLayerClickHandler:function(n,t,i,r){var f=n.ecFunctionId,u=this.option[f],e;if($.isNull(n.ecFunctionId)){if(!(e=$(t.target).closest("li[data-function-id]")))return!1;f=e.attr("data-function-id");u=this.option[f]}if(r.index=this.index,r.selected=u,u.className=="disabled")return!1;u.keepSelectBoxLayer||ecount.layer.removeLayer(this.ecIKey)},isQuickEntry:function(n){return ec$.getClosestAttr(n,"data-function")==="quickEntry"?!0:!1},getQuickEntryElement:function(){return this.$el.find('a[data-function="quickEntry"]')},getItemElement:function(){return this.$el.find("ul.dropdown-menu-item").length?this.$el.find("ul.dropdown-menu-item"):this.$el},getFooterElement:function(){return this.$el.find(".dropdown-menu-footer")},ON_CLICK_SERVICE:function(n,t,i,r){var f=$(t.target),e=f.data("role-id"),o=f.data("value"),u=e||"";this.isNewFormMode&&!u&&(u=_.camelCase([this.id,this.containerName,"click"].join("_")),r.cid=this.id);_.merge(r,{type:"selectbox.click",serviceName:this.serviceName,ecIKey:this.getEcIKey(),targetID:["list",u].join("-"),command:"on"+u.charAt(0).toUpperCase()+u.slice(1),originId:e,originEvent:t,value:o});switch(n.handler){case ECountEvent.Type.CLICK_LAYER:return this.onLayerClickHandler(n,t,i,r)}},ON_KEYDOWN_ESC_SERVICE:function(n,t,i,r){ecount.layer.removeLayer(this.ecIKey);r.layerClosed=!0},ON_KEYDOWN_ARROW_UP_SERVICE:function(n,t,i,r){this.setNextOption(n,t,i,r);n.suspend=!0},ON_KEYDOWN_ARROW_DOWN_SERVICE:function(n,t,i,r){if(this.useRecommendOption){var u=this.$el.find(".dropdown-menu-item.hidden"),f=this.$el.find(".dropdown-menu-footer.hidden");(u.length>0||f.length>0)&&(u.removeClass("hidden"),f.removeClass("hidden"),r.removeClassHidden=!0,this.hiddenBody=!1);this.setNextOption(n,t,i,r)}else this.setNextOption(n,t,i,r);n.suspend=!0},ON_KEYDOWN_ENTER_SERVICE:function(n,t,i,r){var u=this.getCurrentSelectedItem();if(r.serviceName=this.serviceName,!u){ecount.layer.removeLayer(this.ecIKey);return}r.index=this.index;r.selected=u;ecount.layer.removeLayer(this.ecIKey)},ON_KEYDOWN_TAB_SERVICE:function(n,t,i,r){var u=this.getCurrentSelectedItem();return(n.suspend=!0,!u)?(ecount.layer.removeLayer(this.ecIKey),!1):(r.index=this.index,r.selected=u,ecount.layer.removeLayer(this.ecIKey),!1)},ON_KEYDOWN_F8_SERVICE:function(n,t,i,r){r.ecIKey=this.getEcIKey()},ON_KEYPRESS_OTHERS_SERVICE:function(n,t,i,r){var h=String.fromCharCode(n.which),c=this.$el.find(".active").index(),f=[],e,u,o,s;for(h!=this._keyStack&&(this._keyStack+=h.toLowerCase()),this.keyStackID&&ecount.global.clearTimeout(this.ecPageID),u=0;u<this.option.length;u++)o=this.option[u],o.label&&(""+o.label).toLowerCase().indexOf(this._keyStack)===0&&f.push(u);f.length>0&&(s=f.filter(function(n){return n>c}),e=s.length?s[0]:f[0],this.$el.children(":nth("+c+")").removeClass("active"),this.$el.children(":nth("+e+")").addClass("active"),this.setScrollPosition("middle"),r.selected={index:this.index,selectedIndex:e});this.keyStackID=ecount.global.setTimeout(this.ecPageID,function(){this.keyStackID=null;this._keyStack=""}.bind(this),300)},ON_FOCUSOUT_SERVICE:function(n,t,i,r){var u=this.getCurrentSelectedItem();u&&(r.index=this.index,r.selected=u)}});ecount.class("ecount.layer.autocomplete","ecount.layout.layer",{serviceType:"layer",serviceName:"autocomplete",template:"((layer-autocomplete))",liTemplate:'<li data-service-parent-type="{{parentType}}" data-function="autocomplete" data-function-index="{{index}}" data-service="service.layer" class="ui-corner-all {{style.css}}" data-notclear="mousedown">\n<a href="javascript:;" tabindex="-1" data-function="autocomplete" data-function-index="{{index}}" data-service="service.layer" class="ui-corner-all">{{label}}<\/a>\n<\/li>',value:"",searchURL:null,searchParams:null,minLength:1,autoFocus:!1,responseList:null,selectedIndex:null,cache:null,searchingTimeoutkey:null,requestIndex:0,pending:0,uuid:0,indexReg:/{{index}}/g,disableCacheOnAutocomplete:!1,autoHighlightFirstResult:!1,_isShow:!1,init:function(){ecount.layout.layer.prototype.init.apply(this,arguments);ecount.runtime.observingOnce(ECountEvent.Type.PAGE_DESTROY,null,function(){this.destroy()}.bind(this));ecount.runtime.observe("header.toggle",this.ecPageID,function(n){n.showStatus||this.destroy()}.bind(this));this.owner=this.getOwnerInstance()},setEcPath:function(){},getEcIKey:function(){return this.ecIKey},setEcIKey:function(){this.ecIKey=ecount.global.registerEcServiceInstance(this,this.serviceType)},render:function(n){this.data=[{serviceKey:this.ecIKey,ownerKey:this.ownerKey,style:this.getListStyle(),"style.css":this.css||"dropdown-menu-checked-list"}];ecount.runtime.observingOnce("scroll.page.eventContainer",this.ecPageID,function(){this.destroy()}.bind(this));ecount.layout.prototype.render.call(this,n)},show:function(){this.setupHandler&&(this.disableValueSetting||this.getItemList().then(function(n){if(this.$el&&(this.$el.remove(),delete this.$el),this._isCancelShow===!0){this._isCancelShow=null;delete this._isCancelShow;return}this.owner.hasFocus()&&(this.setItemList.call(this,n),this.autoHighlightFirstResult&&n&&n.length>0&&(this.selectedIndex>0?this.$el.children(":nth("+this.selectedIndex+")").addClass("active"):(this.selectedIndex=0,this.$el.children(":first").addClass("active"))),_.isNumber(this.selectedIndex)&&this.owner.setLayerValue&&this.owner.setLayerValue(n[this.selectedIndex]))}.bind(this)).catch(function(n){this.$el&&this.$el.remove();console.log(n)}.bind(this)))},hide:function(){this.selectedIndex=null;ecount.layout.prototype.hide.call(this)},update:function(n){_.merge(this,n);this._preventToShow||this.show()},select:function(){},destroy:function(){this.$el&&this.$el.is(":visible")&&this.hide();ecount.runtime.stopObserving(ECountEvent.Type.PAGE_DESTROY,null);ecount.runtime.stopObserving("header.toggle",this.ecPageID);ecount.layout.prototype.destroy.call(this)},setPreventToShow:function(n){this._preventToShow=n},getItemList:function(){return(this.cancelSearch=!1,this.searchSourceList)?this._getDataFromSource():this.disableCacheOnAutocomplete?(this._clearCache(),this._callSearchAPI()):this._getCachedData().then(function(n){return n?Promise.resolve(n):this._callSearchAPI()}.bind(this)).catch(function(n){console.log(n)})},setItemList:function(n){var r=n.map(function(n,t){return this.liTemplate.replace("{{value}}",n.value).replace("{{label}}",this.getLabelFilter(n)).replace(this.indexReg,t)}.bind(this)),t,i;r.length&&((this.data=[{serviceKey:this.ecIKey,ownerKey:this.ownerKey,style:this.getListStyle(),listItemHtml:r.join(""),"style.css":this.css||"dropdown-menu-checked-list"}],this.$el&&this.$el.remove(),this._preventToShow)||(this.$el=$(ecount.widget.parseHTML.apply(this)),this.setDropdownPosition(),$(document.body).append(this.$el),ecount.layout.prototype.show.apply(this,arguments),t=this.$el.offset(),i=this.$el.outerHeight(),t.top+i>window.innerHeight&&this.$el.css("top",t.top-i-this.height)))},getResponseHandler:function(){var n=++this.requestIndex;return function(t,i){n===this.requestIndex&&i(t);this._decreasePendingCount()}.bind(this)},resetResponseList:function(){this.responseList=[]},getListStyle:function(){var n=[],t={top:0,left:0};return ecount.common.isInApp&&ecount.common.isIOS&&(t={top:$(window).scrollTop(),left:$(window).scrollLeft()}),n.push("top: "+(+this.boundary.top+ +this.boundary.height-t.top)+"px"),n.push("left: "+(this.boundary.left-t.left)+"px"),!this.setMinWidth||n.push("min-width: "+(this.boundary.width?Number(this.boundary.width):"0")+"px"),n.join(";")},getLabelFilter:function(n){return this._getLabelFilter(n.label)},selectResponseItem:function(n){if(this.$el){var e=n.which,r=this.$el.find(".active"),u=this.$el.find("li:visible"),t,i,f;t=r.length?r.index():-1;switch(e){case 38:i=~t?t<=0?0:t-1:this.responseList.length-1;this.owner&&this.owner.setLayerValue&&this.owner.setLayerValue(i);break;case 40:i=~t?t>=this.responseList.length-1?this.responseList.length-1:t+1:0;this.owner&&this.owner.setLayerValue&&this.owner.setLayerValue(i);break;case 33:i=~t?t>=this.responseList.length-1?this.responseList.length-1:t-u.length:0;case 34:i=~t?t>=this.responseList.length-1?this.responseList.length-1:t+u.length:0}f=this.responseList[i];this.selectedIndex=f?i:null;this.$el.children(t).removeClass("active");this.$el.children(":nth("+i+")").addClass("active");this.setScrollPosition()}},setScrollPosition:function(){var t=this.$el.find(".active"),n,r,i;if(!t.length){this.$el.find("");return}n=+t.position().top;itemHeight=+t.outerHeight();r=this.$el.outerHeight();i=this.$el.prop("scrollTop");n<t.innerHeight()?n<0?this.$el.prop("scrollTop",0):this.$el.prop("scrollTop",i-itemHeight):n+itemHeight>r&&(this.$el.prop("scrollHeight")-(n+itemHeight)<itemHeight?this.$el.prop("scrollTop",n):this.$el.prop("scrollTop",i+itemHeight))},onKeyInputHandler:function(){},getOwnerKey:function(){return this.ownerKey},getOwnerInstance:function(){return ecount.global.getEcInstance(this.getOwnerKey())},_getLabelFilter:function(n){var t=this.value.replace(/([\+\-\*\/\(\)])/g,"\\$1");return n.replace(new RegExp("("+t+")"),"<b>$&<\/b>")},_getCachedData:function(){var t=this.value,n;return this.cache&&""+t in this.cache?(n=this.cache[t],this.responseList=n,Promise.resolve(n)):(this.resetResponseList(),Promise.resolve(null))},_getActivatedLayer:function(n,t,i){if(n.ecService){var r=n.handler.toLowerCase().split(".").slice(1).join("."),f=("get_"+r.replace(/\./g,"_")+"_option").ecCamelize(!0),u;switch(r){case"layer.autocomplete":return u=ec$.safeCall(this,f,n,t,control,i),ecount.layer.getLayer(u.serviceKey)}}},_getResponseListStore:function(){return{ecIKey:this.getEcIKey(),index:this.index,itemList:Object.clone(this.responseList,!0),selectedIndex:this.selectedIndex}},_getDataFromSource:function(){return new Promise(function(n){this.setupHandler(this.value,this.defaultParam||{},function(){var t=this.responseFilter(this.searchSourceList,this.value);this.responseList=t;n(t)}.bind(this))}.bind(this))},_callSearchAPI:function(){function n(n){return n.keyword&&(n.keyword=n.keyword.replaceSpecial()),n.PARAM&&(n.PARAM=n.PARAM.replaceSpecial()),this.isSVC&&(n=this.copyParamToRequestData(n),n.PARAM&&(n.Request.Data.PARAM=n.PARAM)),n}function t(n){var t=n.Data;return this.isSVC&&(t=n.Data.Data),t}var i=this.getResponseHandler();return this._increasePendingCount(),new Promise(function(i,r){this.setupHandler(this.value,this.defaultParam||{},function(u){var f=Date.now(),e;this.resetResponseList();this.value==""&&i([]);e=n.call(this,u);ecount.common.api({ecPageID:this.ecPageID,url:this.searchURL,data:JSON.stringify(e),__ecRequestInfo:{id:f},success:function(n,r,u){u.__ecRequestInfo.id!=f&&i([]);var e=t.call(this,n);this._handleResponse(i,e)}.bind(this),error:r})}.bind(this))}.bind(this))},_handleResponse:function(n,t){if(t&&t.length>0){var i=this.responseFilter(t);this.responseList=i;this._storeCache(i);n(i)}else n([])},_storeCache:function(n){this.cache||(this.cache={});this.cache[this.value]=n},_clearCache:function(){$.isEmpty(this.cache)||(this.cache={})},_increasePendingCount:function(){this.pending++;this.$el&&this.$el.addClass("ui-autocomplete-loading")},_decreasePendingCount:function(){this.pending--;this.pending||this.$el.removeClass("ui-autocomplete-loading")},_setSelectedIndex:function(n,t,i,r){var f=t.target.tagName,e,u;e=f!="LI"?f=="INPUT"?this.$el.find("li.active"):$(t.target).closest("li"):$(t.target);u=e.index();this.selectedIndex=u>-1?u:undefined;_.extend(r,this._getResponseListStore())},_setStoreData:function(n,t,i,r){r.index=this.index;r.hasAutocompleteFocus=this.responseList&&this.responseList.length>0?!0:!1;this.$el&&this._setSelectedIndex(n,t,i,r)},_clearLayer:function(){ecount.layer.clearTimer(this.serviceKey);this.destroy()},ON_FOCUSIN_SERVICE:function(n,t,i,r){this._setStoreData(n,t,i,r)},ON_CLICK_SERVICE:function(n,t,i,r){this._setStoreData(n,t,i,r);this._clearLayer()},ON_KEYDOWN_F7_SERVICE:function(){this._clearLayer()},ON_KEYDOWN_F8_SERVICE:function(){this._clearLayer()},ON_KEYDOWN_TAB:function(n,t,i,r){this._setStoreData(n,t,i,r);this._clearLayer()},ON_KEYDOWN_TAB_SERVICE:function(n,t,i,r){this._setStoreData(n,t,i,r);this._clearLayer()},ON_KEYDOWN_ENTER:function(n,t,i,r){this._setStoreData(n,t,i,r);this._clearLayer()},ON_KEYDOWN_ENTER_SERVICE:function(n,t,i,r){this._setStoreData(n,t,i,r);this._clearLayer()},ON_KEYDOWN_ARROW_UP_SERVICE:function(n,t,i,r){this.selectResponseItem(n,t,r)},ON_KEYDOWN_ARROW_DOWN_SERVICE:function(n,t,i,r){this.selectResponseItem(n,t,r)},ON_KEYDOWN_UTILITY_SERVICE:function(n,t,i,r){var u=n.which;switch(u){case 33:case 34:return this.selectResponseItem(n,t,r)}},ON_MOUSEOVER_SERVICE:function(n,t,i,r){this._setStoreData(n,t,i,r);ecount.layer.clearTimer(this.serviceKey)},ON_MOUSEDOWN_SERVICE:function(n,t,i,r){this._setStoreData(n,t,i,r);this._clearLayer()},ON_FOCUSOUT:function(n,t,i,r){this._setStoreData(n,t,i,r)},ON_FOCUSOUT_SERVICE:function(n,t,i,r){this._setStoreData(n,t,i,r)},ON_MOUSEOUT_SERVICE:function(n,t,i,r){r.index=this.index}});ecount.class("ecount.layer.notificationdropdown","ecount.layer.dropdown",{template:'<div class="dropdown-menu dropdown-menu-set-send-notice {{css}}" data-service="service.layer" data-servicekey="{{serviceKey}}" data-ownerkey="{{ownerKey}}" style="{{style}}"/>',ulTemplate:'<ul class="dropdown-menu-item {{css}}" data-service="service.layer"/>',dropdownMenuHeaderTemplate:'<div class="dropdown-menu-header text-center"><span>{{text}}<\/span><\/div>',dropdownMenuFooterTemplate:'<div class="dropdown-menu-footer {{css}}"><a href="javascript:;" data-service="service.layer" data-function-id="settings" data-value="new">{{text}}<\/a><\/div>',_commandPrefix:"notificationdropdown",serviceName:"notificationdropdown",_onClicked:!1,withRemoveBtn:!1,init:function(){ecount.layer.dropdown.prototype.init.apply(this,arguments)},render:function(n){this.setTemplate();ecount.layout.prototype.render.call(this,n);this.setHeaderTemplate(this.$el);this.items&&this.addItems(this.items.toArray(),this.$el);this.setFooterTemplate(this.$el)},setTemplate:function(){$.isEmpty(this.css)?this.css="":this.css.indexOf("position-fixed")<0&&(this.css+=" position-fixed");this.isSetDropdownSize&&(this.css+=" dropdown-menu-fixed-height");this.type==="fn"&&(this.css+=" dropdown-menu-fn");this.template=ecount.widget.replaceAttr(this.template,{css:this.css,style:this._getStyle(),serviceKey:this.getEcIKey(),ownerKey:this.getOwnerKey()})},_bindEvent:function(){ecount.layer.dropdown.prototype._bindEvent.apply(this,arguments)},destroy:function(){ecount.layer.dropdown.prototype.destroy.apply(this,arguments)},setHeaderTemplate:function(n){this.dropdownMenuHeaderTemplate=this.dropdownMenuHeaderTemplate.replace("{{text}}",ecount.resource.LBL08162);n.append($(this.dropdownMenuHeaderTemplate))},setFooterTemplate:function(n){var t;t=this.dropdownMenuFooterTemplate.replace("{{text}}",ecount.resource.BTN00168);t=t.replace("{{css}}","text-center");n.append(t)},addItems:function(n,t){var e,f,o,v,i,r,s,y,p,h=$(this.ulTemplate),u,c,l,a;for(t||(t=this.$el),u=0,c=n.length;u<c;u++)v=this.ppcid?this.ppcid:this.pcid||"",i=n[u],f=[i.css,i.hide?"hidden":""].join(" ").trim(),o=[i.liCss||"",f].join(" ").trim(),l=i.aCss?i.isShowChecked?'class="checked-item '+i.aCss+'"':'class="'+i.aCss+'"':i.isShowChecked?'class="checked-item"':"",s="",r='<li class="{{css}}" {{childItem}}>',r=r.replace(/{{childItem}}/g,""),r=r.replace(/{{css}}/g,o),a=["{{liTemplate}}",i.isEditFormMode?'<span data-value="{{editValue}}" data-role-id="editForm" data-function="editForm" data-function-id="editForm" data-service="service.layer" data-is-edit="true" class="dropdown-menu-item-edit"><\/span>':"",'<a href="javascript:;" {{attrDropdownTabItem}}','class="{{css}}"','data-toggle="tooltip" {{aCss}}','data-placement="left"  data-function-id="{{id}}"','data-click-id="{{clickId}}"','data-service="service.layer"','data-dualStep="{{dualStep}}"','data-dualControlId="{{dualControlId}}"','data-value="{{value}}" data-originLabel="{{originLabel}}">',"{{anchorSpanInside}}","{{label}}","{{removeBtn}}","<\/a>","<\/li>"].join(" "),e=$(a.replace("{{liTemplate}}",r).replace("{{attrDropdownTabItem}}",s).replace("{{css}}",f||"").replace("{{aCss}}",l||"").replace("{{id}}",i.id||"").replace("{{clickId}}",i.clickId||"").replace("{{dualStep}}",$.isNull(i.dualStep)?"":i.dualStep).replace("{{dualControlId}}",i.dualControlId||"").replace("{{editValue}}",i.value||"").replace("{{value}}",i.value||"").replace("{{anchorSpanInside}}",y||"").replace("{{originLabel}}",i.label||"").replace("{{label}}",(i.isShowChecked?'<span class="fa fa-check text-primary"><\/span> ':"")+($.isNull(this.minimalize)?i.label:i.reducedLabel)).replace("{{removeBtn}}",this.withRemoveBtn?'<span class="close" data-role="delete" data-role-index="'+i.id+'"><\/span>':"")),h.append(e);t.append(h);t.append(p)},changeItemClass:function(){ecount.layer.dropdown.prototype.changeItemClass.apply(this,arguments)},show:function(){ecount.layer.dropdown.prototype.show.apply(this,arguments)},onClickDropdown:function(){},toggleActive:function(n,t){var i=$(t.target),u=i.data("function-id"),r=i.parents(".dropdown-menu-item").find(".active");r.removeClass("active");i.parent("li").addClass("active")},ON_CLICK_SERVICE:function(n,t,i,r){var u=$(t.target),e=u.data("function-id"),o=u.data("click-id"),s=o||e,f=this.owner,h;if(!$.isNull(f)&&f.__type==widget.generator.CONTROL&&f.getState(this.cindex||0,"opt.preventClick"))return!1;if(this.toggleActive(n,t,i,r),$.extend(r,{type:"dropdown.click",ecIKey:this.getEcIKey(),ownerKey:this.getOwnerKey(),gridID:this.gridID,gridSectionType:this.gridSectionType,gridColumnID:this.gridColumnID,gridDataKey:this.gridDataKey,targetID:["list",this._commandPrefix,s].join("-"),controlID:f.id,pcontrolID:f.pcid,value:u.attr("data-value"),dualStep:u.attr("data-dualstep"),dualControlid:u.attr("data-dualcontrolid"),command:"on"+(this._commandPrefix+"-"+s).split("-").select(function(n){return n.charAt(0).toUpperCase()+n.slice(1)}).join(""),clickId:o,originId:e,originEvent:t,isEditMode:e==="editForm",isNewFormMode:e==="newForm"}),this.subTitleLinkCid&&_.merge(r,{subTitleLinkCid:this.subTitleLinkCid,subTitleLinkId:this.subTitleLinkId}),r.isEditMode&&(r.editModeCommand=r.command),r.isNewFormMode&&(r.newFormCommand=r.command),h=Boolean(u.attr("data-isDropdownTabItem")),h===!0?this.onClick&&this.onClick(t):this.onClickDropdown&&this.onClickDropdown(r),u&&$(u).parent().hasClass("dropdown-menu-item-group")||n.cid||$(u).parent().attr("class").indexOf("send-notice")>-1||ecount.layer.removeLayer(this.getEcIKey()),this.onClickPriority){r.type="dropdown.click";this.onClickPriority(r)}return $.isEmpty(this.gridID)||$.isNull(f)||f.__type!="control"||f.setFocus(0),!0},ON_MOUSEOVER_SERVICE:function(){ecount.layer.dropdown.prototype.ON_MOUSEOVER_SERVICE.apply(this,arguments)},ON_MOUSEOUT_SERVICE:function(){ecount.layer.dropdown.prototype.ON_MOUSEOUT_SERVICE.apply(this,arguments)},ON_FOCUSIN_SERVICE:function(){ecount.layer.dropdown.prototype.ON_FOCUSIN_SERVICE.apply(this,arguments)}});ecount.class("ecount.layer.recommenddropdown","ecount.layer.dropdown",{template:'<div class="dropdown-menu dropdown-menu-tree dropdown-menu-recommend-word {{css}}" data-notclear="mousedown" data-layer-type="{{layerType}}" data-service-attr="{{serviceAttr}}" data-service="service.layer" data-servicekey="{{serviceKey}}" data-ownerkey="{{ownerKey}}" style="{{style}}"><\/div>',ulTemplate:'<ul class="dropdown-menu-item {{css}}" />',quickEntryTemp:'<a class="text-bold recommend-word" href="javascript:;" data-service="service.layer" data-function-id="quickEntry">{{quickEntryInner}}<\/a>',quickEntryInnerTemp:'<span class="label label-default">추천<\/span><span data-id="quickEntry" data-value="{{dataValue}}">{{dataValueText}}<\/span>',categoryTemplate:'<div class="recommend-category"><div class="{{css}}" data-service="layer.dropdown" data-type="{{categoryID}}">{{categoryLabel}}<\/div><div class="recommend-category-option"><button class="btn btn-default btn-sm btn-transparant btn-reload btn-setup" data-type="ViewAll"><\/button><button class="btn btn-default btn-sm btn-transparant btn-reload" data-type="Reload"><\/button><\/div><\/div>',dropdownMenuHeaderTemplate:'<div class="dropdown-menu-header">{{quickEntry}}<\/div>',dropdownMenuFooterTemplate:'<div class="dropdown-menu-footer"><div class="wrapper-toolbar"><div class="pull-left">{0}<\/div><\/div><\/div>',serviceType:"layer",serviceName:"recommenddropdown",items:null,_isShow:!1,itemList:null,ownerKey:null,cindex:null,cid:null,_commandPrefix:"recommenddropdown",_onClicked:!1,withRemoveBtn:!1,prevTargetLi:[],constValue:{ArrowUp:"ArrowUp",ArrowDown:"ArrowDown",ArrowLeft:"ArrowLeft",ArrowRight:"ArrowRight",ToParent:"ToParent"},init:function(){if(ecount.layer.dropdown.prototype.init.apply(this,arguments),ecount.runtime.observe("resize",this.ecIKey,this.setDropdownPosition.bind(this)),this.dropItems=[],this.isFromCS)return this.dropItems.push({id:"PM",label:ecount.resource.LBL18571}),!1;this.getLayerType()=="TEXT"?(this.dropItems.push({id:"PM",label:ecount.resource.LBL00301}),this.dropItems.push({id:"SM",label:ecount.resource.LBL05639})):(this.dropItems.push({id:"PM",label:ecount.resource.LBL18571}),this.dropItems.push({id:"PA",label:ecount.resource.LBL18572}),this.dropItems.push({id:"SM",label:ecount.resource.LBL18573}),this.dropItems.push({id:"SA",label:ecount.resource.LBL18574}))},getEcPath:function(){return this.ecPath},getEcIKey:function(){return this.ecIKey},setEcIKey:function(){this.ecIKey=ecount.global.registerEcServiceInstance(this,this.serviceType)},getOwnerKey:function(){return this.ownerKey},getLayerType:function(){var n="";if(this.items[0]&&this.items[0].LAYER_TYPE)switch(this.items[0].LAYER_TYPE){case"T":n="TEXT";break;case"S":n="SINGLE_CODE";break;case"M":n="MULTI_CODE"}return n},render:function(n){this.setMinimalize();this.setTemplate();ecount.layout.prototype.render.call(this,n);this.setHeaderTemplate(this.$el);!this.useFavoriteCode||this.setBodyTemplate(this.$el);this.isEmptyData()||this.addItems(this.items.toArray(),this.$el,null);this.addEmptyGroupTemplate(this.$el);this.toggleEmptyGroup(this.hasShowList());this.setActiveToLiTags(this.$el);this.setFooterTemplate(this.$el)},setMinimalize:function(){function i(n,t,i){return n.substr(0,t-i-3)+"..."+n.substr(i*-1)}if(!$.isNull(this.minimalize))for(var n,t=0,r=this.items.length;t<r;t++)n=this.items[t],n.reducedLabel=n.label.length>this.minimalize.maxLen?i(n.label,this.minimalize.maxLen,this.minimalize.suffixLen):n.label},isEmptyData:function(){if(this.items.length)return this.items.filter(function(n){return this.isEmptyItem(n.SETUP_ITEM_CTT)&&n.ITEM_TYPE_CD!=="I"}.bind(this)).length},isEmptyItem:function(n){return $.isNull(n)?!0:typeof n=="string"&&n==""?!0:!1},setTemplate:function(){$.isEmpty(this.css)?this.css="":this.css.indexOf("position-fixed")<0&&(this.css+=" position-fixed");this.type==="fn"&&(this.css+=" dropdown-menu-fn");this.template=ecount.widget.replaceAttr(this.template,{css:this.css,style:this._getStyle(),serviceKey:this.getEcIKey(),ownerKey:this.getOwnerKey(),layerType:this.getLayerType(),serviceAttr:ecount.layer.constValue.FOCUSABLE})},_getStyle:function(){var n="";return this.minWidth&&(n+=["min-width:",this.minWidth,"px"].join("")),n},setQuickEntryTemplate:function(){var r="",u="",n="",f="",e="",t=this.getOwnerInstance(),i;if(t)return i=t.getState(t._IT_SELF,"useRecommendOption"),$.isBoolean(i)&&!!i&&(n=t.getState(t._IT_SELF,"recommendValue"),f=t.getValue(),e=n&&n.value||n.dataValue&&n.dataValue.split("∬")[0],!i||e==f||(r=this.quickEntryInnerTemp.replace("{{dataValue}}",n.dataValue).replace("{{dataValueText}}",n.label),u=this.quickEntryTemp.replace("{{quickEntryInner}}",r))),u},setCategoryTemplate:function(){var n="recommend-category-select";return!this.isFromCS||(n+=" single"),this.categoryTemplate.replace("{{css}}",n).replace("{{categoryLabel}}",this.dropItems[0].label).replace("{{categoryID}}",this.dropItems[0].id)},setHeaderTemplate:function(n){var t,i;t=this.setQuickEntryTemplate();i=$(this.dropdownMenuHeaderTemplate.replace("{{quickEntry}}",t));n.append(i)},setFooterTemplate:function(n){var i="",t=$("<div class='control-set'>");this.getLayerType()=="MULTI_CODE"&&t.append('<div class="control"><button class="btn btn-primary btn-sm  btn-enter" data-type="Apply"><\/button><\/div>');t.append('<div class="control"><button class="btn btn-default btn-sm btn-transparant btn-hamburger" data-type="ViewAll"><\/button><\/div>');t.append('<div class="control"><button class="btn btn-default btn-sm btn-transparant btn-plus" data-type="Modify"><\/button><\/div>');t.append('<div class="control"><button class="btn btn-default btn-sm btn-transparant btn-reload" data-type="Reload"><\/button><\/div>');i=String.format(this.dropdownMenuFooterTemplate,t.wrap("<p/>").parent().html());n.append(i)},setBodyTemplate:function(n){var t="";return t=this.getLayerType()=="MULTI_CODE"?this.ulTemplate.replace("{{css}}","dropdown-menu-item-checkbox"):this.ulTemplate.replace("{{css}}",""),n.append(t)},addItems:function(n,t,i){for(var e,y,s,o,r,u,h,p,c,f,w,l,b=i?i:t.find(".dropdown-menu-item"),a,k=n.filter(function(n){return n.HGRK_ITEM_SNO!="0"}).length?!0:!1,v=0,d=n.length;v<d;v++)r=n[v],a=r.childItems&&r.childItems.length?!0:!1,y=[r.css].join(" ").trim(),s=[r.liCss||"",y].join(" ").trim(),o=r.STATUS&&r.STATUS!=="A"?"text-muted":"",u='<li class="{{css}}" {{dataDepth}} {{dataType}} {{isDisabled}}>',p=r.SETUP_ITEM_CTT&&r.SETUP_ITEM_CTT.replace(/\xA0/g," ").escapeHTML(),c=p.split("∬"),f=c.length>1?c[1]:c[0],f=$.isEmpty(ecount.resource[f])?f:ecount.resource[f],r.ITEM_TYPE_CD==="C"&&(s=[s,"dropdown-menu-item-group"].join(" ")),w="data-depth='"+r.HGRK_ITEM_SNO+"'",l="data-type='"+r.ITEM_TYPE_CD+"'",u=u.replace(/{{css}}/g,s),u=u.replace("{{dataDepth}}",w),u=u.replace("{{dataType}}",l),u=u.replace("{{isDisabled}}",o?"data-disabled='true'":""),this.getLayerType()=="MULTI_CODE"?(h=[u,'<a href="javascript:;" class="{{aCss}}" data-group="{{dataGroup}}" data-service="service.layer" data-function-id="{{dataFunctionId}}", ','data-status="{{dataStatus}}" data-value="{{dataValue}}" originid="{{originId}}" data-haschild="{{dataHasChild}}">','<span class="form-checkbox">','<input type="checkbox" id="{{id}}" data-depth-id="{{depthId}}" {{dataType}} {{isDisabled}}>','<label for="{{id}}">{{label}}<\/label>',"<\/span>","<\/a>","<\/li>"].join(" "),e=$(h.replace("{{aCss}}",o).replace("{{dataGroup}}",r.ITEM_GRP_TYPE_CD).replace("{{dataFunctionId}}",""+r.Key.ITEM_SNO).replace("{{dataStatus}}",""+r.STATUS||"A").replace("{{dataValue}}",""+r.SETUP_ITEM_CTT.escapeHTML()||"").replace("{{originId}}",""+r.Key.ITEM_SNO).replace("{{dataHasChild}}",a?"true":"false").replaceAll("{{id}}",""+r.Key.ITEM_SNO).replace("{{depthId}}",a||k?r.HGRK_ITEM_SNO:"").replace("{{dataType}",l?l:"").replace("{{isDisabled}}",o?"disabled":"").replace("{{label}}",f))):(h=[u,'<a href="javascript:;" class="{{aCss}}" data-group="{{dataGroup}}" data-service="service.layer" data-function-id="{{dataFunctionId}}"','data-status="{{dataStatus}}" data-value="{{dataValue}}" originid="{{originId}}" data-haschild="{{dataHasChild}}">{{label}}',"<\/a>","<\/li>"].join(" "),e=$(h.replace("{{aCss}}",o).replace("{{dataGroup}}",r.ITEM_GRP_TYPE_CD).replace("{{dataFunctionId}}",""+r.Key.ITEM_SNO).replace("{{dataStatus}}",""+r.STATUS||"A").replace("{{dataValue}}",""+r.SETUP_ITEM_CTT.escapeHTML()||"").replace("{{originId}}",""+r.Key.ITEM_SNO).replace("{{dataHasChild}}",a?"true":"false").replaceAll("{{id}}",""+r.Key.ITEM_SNO).replace("{{label}}",f))),r.childItems&&r.childItems.length&&this.addChildItems(e,r.childItems,v),this.toggleOpenLi(e),b.append(e);t.append(b)},setActiveToLiTags:function(n){function f(n){var r=$(n.target);t=r.parents("li").length>1?r.parents("li[data-depth="+r.attr("data-depth-id")+"]"):$(n.target).parents("li[data-depth='0']");u.removeActive(i);u.setActive(t)}var i=$(n.find("li")),r=i.find("span"),e=$(n).attr("data-type"),u=this,t;r.length?r.bind("click",function(n){f(n)}):$(n.find("li>a")).bind("click",function(n){f(n)})},toggleOpenLi:function(n){var t;n.attr("data-type")=="C"&&n.children("a").bind("click",function(n){n.target.type!=="checkbox"&&(t=$(n.target).parents("li[data-type='C']"),t.hasClass("open")?t.removeClass("open"):t.addClass("open"))})},addChildItems:function(n,t){var r=$(this.eventContainer||document),u=2-ecount.common.getZoomRatio(),i=$('<ul class="dropdown-menu"><\/ul>');n.addClass("dropdown-menu-item-group");this._forcedDisplayPosition=="top"&&n.addClass("dropup");this.addItems(t,n,i);this.$el.hasClass("context-menu")||this.$el.addClass("context-menu")},addEmptyGroupTemplate:function(n){var t="<li class=\"nodata hidden\" data-id='emptyGroup' >"+ecount.resource.MSG80035+"<\/li>",i=n.find("ul.dropdown-menu-item");i.append($(t))},addGridCallbakOptions:function(n){this.gridID&&this.getLayerType()=="MULTI_CODE"&&_.merge(n,{isGridAction:!0,gridID:this.gridID,callbackID:"onRecommendDropdownApply"})},show:function(){ecount.layer.dropdown.prototype.show.apply(this,arguments)},setBoundary:function(){ecount.layer.dropdown.prototype.setBoundary.apply(this,arguments)},isEmtpyGroup:function(){return this.$el.find(".dropdown-menu-item>li:visible[data-id='emptyGroup']").length===0?!1:!0},fixLayerDirection:function(){var n=[],t=[],i=[],r=!1,f=this,u;if($.each(this.items,function(t,i){if(i.WIGT_CD!==f.getOwnerInstance().controlType){r=!0;return}n.push(i.ITEM_GRP_TYPE_CD);i.childItems&&i.childItems.length&&(n=n.concat(i.childItems.map(function(n){return n.ITEM_GRP_TYPE_CD})))}),r)return!1;u=n.filter(function(t,i){return n.indexOf(t)===i});u.forEach(function(i){var r=[];n.forEach(function(n){i===n&&r.push(n)});t.push(r)});i=t&&t.reduce(function(n,t){return n.length>t.length?n:t},[]);this.$el.addClass("invisible");this.$el.addClass("show");var e=this.$el.get(0).getBoundingClientRect(),o=window.innerHeight-e.bottom,s=(o/25).floor()+this.getFirstTabData().length,h=i.length>10?10:i.length;this._forcedDisplayPosition=s<h?"top":"footer";this.$el.removeClass("show");this.$el.removeClass("invisible")},setFirstFocus:function(){this.getQuickEntryEl().length?this.setQuickEntryFocusAndActiveClass():this.setFirstListFocus()},setFirstListFocus:function(){var n=this.getFirstListElement();n.length&&(this.removeQuickEntryActiveClass(),this.setFocus(n.children("a")),this.setActive(n))},getFirstListElement:function(){return this.$el.find(".dropdown-menu-item>li:visible").first()},getFirstTabData:function(){return this.$el.find(".dropdown-menu-item").children().not(".hidden")},onClickQuickEntryHandler:function(n,t,i,r){var f=n||$(t.target),e=f.closest("a"),o,u,s;if(e.attr("data-function-id")!=="quickEntry"||f.attr("data-id")&&!f.find("span[data-id]").length)return!1;o=e.find("span[data-value]").attr("data-value");u=this.getSplitedData(o);s=$.isString(u)?u:{value:u[0],label:u[1]};_.merge(r,{value:s})},removeQuickEntryActiveClass:function(){var n=this.getQuickEntryEl();n&&this.removeActive(n.parent())},setQuickEntryFocusAndActiveClass:function(){var n=this.getQuickEntryEl();n.length&&(this.removeAllListActiveClass(),this.setFocus(n),this.setActive(n.parent()))},getQuickEntryEl:function(){return this.$el.find('a[data-function-id="quickEntry"]')},hasQuickEntryEl:function(){return this.$el.find('a[data-function-id="quickEntry"]').length!=0?!0:!1},isQuickEntry:function(n){return ec$.getClosestAttr(n,"data-function-id")==="quickEntry"?!0:!1},setFocus:function(n){n&&n.trigger("mousedown").focus()},getOptionLength:function(){return this.items?this.items.length:0},getNodeList:function(n){return this.$el.find("li")[n]},removeClass:function(n){this.$el.removeClass(n)},getOwnerInstance:function(){return ecount.global.getEcInstance(this.getOwnerKey())},getOwnerBoundary:function(){return this.boundary},isOnClicked:function(){return this._onClicked},toggleEmptyGroup:function(n){var t=this.$el.find("li[data-id='emptyGroup']");n?t.addClass("hidden"):t.removeClass("hidden")},getTargetList:function(n){return this.$el.find("li>a[data-group='"+n+"']").parent()},hasShowList:function(){return this.getItemList().filter(function(n){return!!n.ITEM_GRP_TYPE_CD}).length===0?!1:!0},getItemList:function(){return this.items},addCindexToStore:function(n){n&&_.merge(n,{cindex:this.cindex})},switchDataList:function(n){var t,i;this.prevTargetLi.length||(this.prevTargetLi=this.getTargetList("PM"));this.setHide(this.prevTargetLi);foundLi=this.getTargetList(n);this.toggleEmptyGroup(foundLi.length);foundLi.length&&(this.prevTargetLi=foundLi,this.setShow(this.prevTargetLi));ecount.layer.dropdown.prototype.setDropdownPosition.apply(this);this.removeAllListActiveClass();t=this.$el.find("li:not(.hidden)");i=t.first().find("a");this.setFocus(i);this.setActive(t.first())},changeCategory:function(n){var i=this.$el.find("div.recommend-category-select"),t="";this.dropItems.forEach(function(i){i.id==n&&(t=i.label)});t&&(i.text(t),i.attr("data-type",n));this.switchDataList(n)},onClickApply:function(n){var i=this.$el.find("input:checkbox:checked[data-depth-id !='0']"),u=[],o,f,e,r,t;if(i.length)for(t=0;t<i.length;t++)o=$(i[t]).attr("data-depth-id"),f=$(i[t]).attr("data-type"),f!="C"&&(e=$(i[t]),r=this.getSplitedData(e.parents("a")),u.push({value:r[0],label:r[1]}));this.addGridCallbakOptions(n);_.merge(n,{value:u});this.addCindexToStore(n);ecount.layer.removeLayer(this.ecIKey)},onClickShowAll:function(n,t){var i={isControlCall:!0,btnType:t};_.merge(n,i,{Reload:{handler:"click.layer.recommenddropdown",ecLazyService:"layer.recommenddropdown",url:"/ECERP/SVC/Popup/FavoriteCodeTreeSetup"},ViewAll:{url:"/ECERP/SVC/Popup/FavoriteCodeTreeSearch"},Modify:{url:"/ECERP/SVC/Popup/FavoriteCodeTreeSetup"}}[t])},onClickMenuItem:function(n,t){var i,r;n.parent("li").attr("data-depth")=="0"&&n.parent("li").attr("data-type")=="C"?ecount.layer.dropdown.prototype.setDropdownPosition.apply(this):n.parent("span.form-checkbox").length||n.children("span.form-checkbox").length||n.attr("data-status")!=="A"||n.parent().attr("data-id")==="emptyGroup"||(i=this.getSplitedData(n),r=$.isString(i)?i:{value:i[0],label:i[1]},_.merge(t,{value:r}))},onClickRecommendWord:function(n,t){var i=this.getSplitedData(n.parent().find("[data-value]")),r=$.isString(i)?i:{value:i[0],label:i[1]};_.merge(t,{value:r})},toggleGroupCheckbox:function(n,t){var i=n||$(t.target),u=i.parents("li[data-depth='0']"),e=i.attr("data-depth-id"),o=i.attr("id"),r,f=0;e=="0"?(r=this.$el.find("input:enabled[data-depth-id='"+o+"']"),r.prop("checked",i.prop("checked"))):($.each(u.find("input:enabled[data-depth-id !='0']"),function(n,t){$(t).prop("checked")||f++}),r=u.find("input[data-depth-id='0']"),r.prop("checked",f>=1?!1:!0));ecount.layer.dropdown.prototype.setDropdownPosition.apply(this)},getSplitedData:function(n){var t=$.isString(n)?n:n.attr("data-value").unescapeHTML().replace(/\xA0/g," ");return t.indexOf("∬")>-1?t.split("∬"):t},setActive:function(n){n.attr("data-id")!=="emptyGroup"&&n.addClass("active")},removeActive:function(n){n.removeClass("active")},setHide:function(n){n&&n.addClass("hidden")},setShow:function(n){n&&n.removeClass("hidden")},toggleHideAndShow:function(n){n.hasClass("hidden")?n.removeClass("hidden"):n.addClass("hidden")},removeAllListActiveClass:function(){this.removeActive(this.$el.find("ul.dropdown-menu-item").find("li.active"))},selectChildOption:function(n,t,i){var e=this.$el.find("li:visible"),r=e.filter(".active"),f,u;switch(i){case"ArrowRight":r.attr("data-depth")==="0"&&(r.addClass("open"),r.children("ul").length&&(this.removeAllListActiveClass(),f=r.find("ul.dropdown-menu > li").first(),this.setActive(f),this.setFocus(f.children("a"))));break;case"ArrowLeft":r.attr("data-depth")==="0"?r.removeClass("open"):r.attr("data-depth")!=="0"&&(u=e.find("a[originid="+r.attr("data-depth")+"]").parent("li"),u.removeClass("open"),this.removeAllListActiveClass(),this.setActive(u),this.setFocus(u.children("a")))}ecount.layer.dropdown.prototype.setDropdownPosition.apply(this)},setOperatorOption:function(n,t){var i="";switch(n){case this.constValue.ArrowUp:i=":lt("+t+"):last()";break;case this.constValue.ArrowDown:i=":gt("+t+"):first()";break;case this.constValue.ToParent:i=":eq("+t+")"}return i},getNextSelectTarget:function(n,t){return n.children(":visible [data-id!='emptyGroup']"+t)},selectNextOption:function(n){var u=this.$el.find("li:not(.hidden)"),i=u.filter(".active"),e=i.hasClass("open"),t,r,f=i.index();r=this.setOperatorOption(n,f);t=this.getNextSelectTarget(i.parent(),r);this.constValue.ArrowUp!==n||t.length?!t.hasClass("hidden")&&t.length&&(this.removeAllListActiveClass(),this.setActive(t),this.setFocus(t.children("a"))):this.hasQuickEntryEl()?this.setQuickEntryFocusAndActiveClass():(this.removeAllListActiveClass(),this.getOwnerInstance().setFocus(0))},setValueByEnterFocuseElement:function(n,t,i,r){var f=this.$el.find(".active"),h=f.find(".recommend-word"),u,s,e,o;h.length>0?(e=f.find("span[data-id='quickEntry']"),u=this.getSplitedData(e),o=$.isString(u)?u:{value:u[0],label:u[1]},this.addGridCallbakOptions(r),_.merge(r,{value:[o]}),r.type=ecount.layer.constValue.RECOMMENDDROPDOWN,this.addCindexToStore(r)):f.attr("data-id")=="emptyGroup"||f.attr("data-disabled")=="true"||(s=f.find("ul > li"),e=s.length&&f.attr("data-type")=="C"?s.first().children("a"):f.find("a"),u=this.getSplitedData(e),o=$.isString(u)?u:{value:u[0],label:u[1]},this.addGridCallbakOptions(r),_.merge(r,{value:[o]}),r.type=ecount.layer.constValue.RECOMMENDDROPDOWN,this.addCindexToStore(r));ecount.layer.removeLayer(this.ecIKey)},checkBySpaceFocusElement:function(n,t){var i=$(t.target),r=i.prop("tagName");r=="A"&&(i=i.find("input:checkbox:not([disabled])"));i.prop("checked",!i.prop("checked"));this.toggleGroupCheckbox(i,t)},getLayerServiceKey:function(n){var t=this.ecIKey+ecount.popupIDDelimiter+"category";return this.dropdownServiceKey=ecount.common.makeServiceKey(n.ecPath,t),this.dropdownServiceKey},getLayerDropdownOption:function(n,t){var f={type:"dropdown",ecPageID:this.ecPageID,serviceKey:this.getLayerServiceKey(n,t),ownerKey:this.ecIKey,popupID:this.popupID,popupLevel:this.popupLevel,from:"layer",showingUpDelay:0,zIndex:1003},i=$(t.target).parent("div"),r=i.offset(),e=i.width(),u=i.height();return $.extend(f,{boundary:$.extend(r,{width:e,height:u,bottom:r.top+u}),items:this.dropItems,_onClicked:this._onClicked})},openDropdownLayer:function(n,t){if(!this.isFromCS){var i=this.getLayerDropdownOption(n,t);ecount.layer.show(i)}},callClickEvent:function(n,t,i,r,u){if(i.hasClass("form-checkbox"))this.toggleGroupCheckbox(n,t);else if(r=="Reload"||r=="ViewAll"||r==="Modify")this.onClickShowAll(u,r);else if(i.hasClass("dropdown-menu-item"))this.onClickMenuItem(n,u);else if(i.hasClass("recommend-word")||n.hasClass("recommend-word"))this.onClickRecommendWord(n,u);else if(r=="Apply")this.onClickApply(u);this.dropdownServiceKey&&ecount.layer.hide(this.dropdownServiceKey);this._onClicked=!1},destroy:function(){ecount.runtime.stopObserving("resize",this.ecIKey);ecount.layer.dropdown.prototype.destroy.call(this)},ON_CLICK_SERVICE:function(n,t,i,r){var u=$(t.target),o=u.data("function-id"),s=u.data("click-id"),e=s||o,f=this.owner,c=u.attr("data-type"),h=u&&u.parents();return!$.isNull(f)&&f.__type==widget.generator.CONTROL&&f.getState(this.cindex||0,"opt.preventClick")?!1:n.handler==ECountEvent.Type.CLICK_DROPDOWN?(this._onClicked=!0,this.openDropdownLayer(n,t),!1):this.dropItems.filter(function(n){return n.id==e}).length>0?(this.changeCategory(e),!1):(this.callClickEvent(u,t,h,c,r),r.btnType&&(r.command="onRecommendDropdown"+r.btnType),$.extend(r,{type:ecount.layer.constValue.RECOMMENDDROPDOWN,serviceName:this.serviceName,ecIKey:this.getEcIKey(),ownerKey:this.getOwnerKey(),gridID:this.gridID,gridSectionType:this.gridSectionType,gridColumnID:this.gridColumnID,gridDataKey:this.gridDataKey,targetID:["list",this._commandPrefix,e].join("-"),controlID:f.id,pcontrolID:f.pcid,control:this.getOwnerInstance(),clickId:s,originId:o,originEvent:t,cindex:this.cindex}),u.parents("li.dropdown-menu-item-group").length&&u.parent().attr("data-depth")=="0"||u.hasClass("dropdown-menu-item dropdown-menu-item-checkbox")||(u.parents("[data-layer-type]").attr("data-layer-type")=="MULTI_CODE"?u.siblings().hasClass("form-checkbox")||u&&u.length||u.attr("type")=="checkbox":h.hasClass("recommend-category")||u.hasClass("btn-reload")||u.parent().attr("data-id")=="emptyGroup"||ecount.layer.removeLayer(this.getEcIKey())),!0)},ON_MOUSEDOWN_SERVICE:function(){ecount.layer.clearTimer(this.getEcIKey());this.owner.isLayerMousedown=!0},ON_MOUSEOVER_SERVICE:function(n,t){ecount.layer.dropdown.prototype.ON_MOUSEOVER_SERVICE.apply(this,arguments);switch(n.handler){case ECountEvent.Type.MOUSEOVER_DROPDOWN:return this.openDropdownLayer(n,t),!1}},ON_MOUSEOUT_SERVICE:function(){this.dropdownServiceKey&&!this._onClicked&&ecount.layer.hide(this.dropdownServiceKey)},ON_FOCUSIN_SERVICE:function(){ecount.layer.dropdown.prototype.ON_FOCUSIN_SERVICE.apply(this,arguments)},ON_KEYDOWN_ESC_SERVICE:function(n,t,i,r){ecount.layer.removeLayer(this.ecIKey);n.suspend=!0;r.layerClosed=!0;r.serviceName=this.serviceName},ON_KEYDOWN_ARROW_RIGHT_SERVICE:function(n,t){this.selectChildOption(n,t,"ArrowRight");n.suspend=!0},ON_KEYDOWN_ARROW_LEFT_SERVICE:function(n,t){this.selectChildOption(n,t,"ArrowLeft");n.suspend=!0},ON_KEYDOWN_ARROW_UP_SERVICE:function(n){this.selectNextOption(this.constValue.ArrowUp);n.suspend=!0},ON_KEYDOWN_ARROW_DOWN_SERVICE:function(n,t){this.isQuickEntry(t.target)?this.setFirstListFocus():this.selectNextOption(this.constValue.ArrowDown);n.suspend=!0},ON_KEYDOWN_ENTER_SERVICE:function(n,t,i,r){this.setValueByEnterFocuseElement(n,t,i,r);n.suspend=!0;r.serviceName=this.serviceName},ON_KEYDOWN_SPACE_SERVICE:function(n,t,i,r){this.checkBySpaceFocusElement(n,t,i,r);n.suspend=!0},ON_KEYDOWN_F8_SERVICE:function(n,t,i,r){this.onClickApply(r);r.type=ecount.layer.constValue.RECOMMENDDROPDOWN;n.suspend=!0}});ecount.class("ecount.layer.searchdropdown","ecount.layer.dropdown",{template:'<div class="dropdown-menu dropdown-menu-tree dropdown-menu-recommend-word {{css}}" data-notclear="mousedown" data-layer-type="{{layerType}}" data-service-attr="{{serviceAttr}}" data-service="service.layer" data-servicekey="{{serviceKey}}" data-ownerkey="{{ownerKey}}" style="{{style}}"><\/div>',ulTemplate:'<ul class="dropdown-menu-item dropdown-menu-item-checkbox"/>',dropdownMenuFooterTemplate:'<div class="dropdown-menu-footer"><a href="javascript:;" data-trigger="click" data-service="service.layer" data-type="More">{{footerLabel}}<\/a><\/div>',_onClicked:!1,init:function(n){ecount.layer.dropdown.prototype.init.apply(this,arguments);this.selectedItem=[];this.searchDropdownListType=n.searchDropdownListType},getEcPath:function(){return this.ecPath},getEcIKey:function(){return this.ecIKey},setEcIKey:function(){this.ecIKey=ecount.global.registerEcServiceInstance(this,this.serviceType)},getOwnerKey:function(){return this.ownerKey},render:function(n){this.setMinimalize();this.setTemplate();ecount.layout.prototype.render.call(this,n);this.setBodyTemplate(this.$el);this.addItems(this.items,this.$el);this.setFooterTemplate(this.$el)},setMinimalize:function(){function i(n,t,i){return n.substr(0,t-i-3)+"..."+n.substr(i*-1)}if(!$.isNull(this.minimalize))for(var n,t=0,r=this.items.length;t<r;t++)n=this.items[t],n.reducedLabel=n.label.length>this.minimalize.maxLen?i(n.label,this.minimalize.maxLen,this.minimalize.suffixLen):n.label},setTemplate:function(){this.template=ecount.widget.replaceAttr(this.template,{css:this.css,style:this._getStyle(),serviceKey:this.getEcIKey(),ownerKey:this.getOwnerKey(),serviceAttr:ecount.layer.constValue.FOCUSABLE})},setFooterTemplate:function(n){var t=this.dropdownMenuFooterTemplate;t=this.dropdownMenuFooterTemplate.replace("{{footerLabel}}",ecount.resource.LBL02482);n.append(t)},setBodyTemplate:function(n){var t=this.ulTemplate;return n.append(t)},addItems:function(n,t){for(var e=t.find(".dropdown-menu-item"),o,i,s,h,c,l,r,u,f=0;f<n.length;f++)i=n[f],l=i.COL_NM,r=i.CHO_TF,u=i.COL_CD,r&&this.selectedItem.push(u),h='<li><a href="javascript:;" data-service="service.layer" data-function-id="{{dataFunctionId}}" data-value="{{dataValue}}"><span class="form-checkbox"><input type="checkbox" id="{{id}}" {{checked}}><label for="{{id}}">{{label}}<\/label><\/span><\/a><\/li>',c='<li><a href="javascript:;" data-service="service.layer" data-function-id="{{dataFunctionId}}" data-value="{{dataValue}}"><span class="form-radio"><input type="radio" id="{{id}}" name="{{name}}" {{checked}}><label for="{{id}}">{{label}}<\/label><\/span><\/a><\/li>',s=this.searchDropdownListType==="radio"?c:h,o=$(s.replace("{{checked}}",r?"checked":"").replace("{{dataFunctionId}}",this.id).replace("{{dataValue}}",u).replaceAll("{{id}}",this.id).replace("{{label}}",l||"").replace("{{name}}",this.name||"quickSearch")),e.append(o);t.append(e)},setLastFocus:function(n,t){t.children("a").removeClass("text-bold");this.setActive(n);this.setFocus(n.children("a"))},setControlFocus:function(n){this.removeAllListActiveClass();n.isLayerArrowUp=!0},setFooterFocus:function(n){this.removeAllListActiveClass();n.children("a").addClass("text-bold");this.setFocus(n.children("a"))},setFocus:function(n){n&&n.trigger("mousedown").focus()},removeClass:function(n){this.$el.removeClass(n)},getOwnerInstance:function(){return ecount.global.getEcInstance(this.getOwnerKey())},setActive:function(n){n.addClass("active")},removeActive:function(n){n.removeClass("active")},getSelectedData:function(){return this.selectedItem},setSelectedData:function(n){var i=n.parent().parent().data("value"),r=n.attr("type"),t;r==="radio"&&(this.selectedItem=[]);n.length>0&&n[0].checked?this.selectedItem.push(i):(t=this.selectedItem.indexOf(i),t>-1&&this.selectedItem.splice(t,1))},removeAllListActiveClass:function(){this.removeActive(this.$el.find("ul.dropdown-menu-item").find("li.active"))},setOperatorOption:function(n,t){var i="";switch(n){case"ArrowUp":i=":lt("+t+"):last()";break;case"ArrowDown":i=":gt("+t+"):first()"}return i},getNextSelectTarget:function(n,t){return n.children(t)},selectNextOption:function(n){var o=this.$el.find("li:not(.hidden)"),r=o.filter(".active"),s=this.$el.find(".dropdown-menu-item > li:last()"),u=this.$el.find(".dropdown-menu-footer"),f=this.getOwnerInstance(),i=r.index(),t,e;if(e=this.setOperatorOption(n,i),t=this.getNextSelectTarget(r.parent(),e),n=="ArrowUp"&&i==-1){this.setLastFocus(s,u);return}if(t.length==0&&n=="ArrowUp"&&i!==-1){this.setControlFocus(f);return}if(t.length==0&&n=="ArrowDown"){this.setFooterFocus(u);return}t.length&&(f.isLayerArrowUp=!1,this.removeAllListActiveClass(),this.setActive(t),this.setFocus(t.children("a")))},onClickApply:function(n,t){var i=$(n.target),r=i.data("type"),u=this.getOwnerInstance();_.extend(t,{type:ecount.layer.constValue.SEARCHDROPDOWN,ecIKey:this.getEcIKey(),ownerKey:this.getOwnerKey(),controlID:u.id,command:"onQuickSearchDropdown",dataType:r,originEvent:n,selectedData:this.getSelectedData()})},checkBySpaceFocusElement:function(n,t){var i=$(t.target),r=i.prop("tagName");r=="A"&&(i=i.find("input:"+this.searchDropdownListType));i.prop("checked",!i.prop("checked"));this.setSelectedData(i)},callClickEvent:function(n,t,i){if(t=="More"){this.onClickApply(n,i);ecount.layer.removeLayer(this.ecIKey)}this.dropdownServiceKey&&ecount.layer.hide(this.dropdownServiceKey);this._onClicked=!1},ON_CLICK_SERVICE:function(n,t,i,r){var u=$(t.target),f=this.getOwnerInstance(),e=u.attr("data-type");return!$.isNull(f)&&f.__type==widget.generator.CONTROL&&f.getState(this.cindex||0,"opt.preventClick")?!1:(this.callClickEvent(t,e,r),this.setSelectedData(u),_.extend(r,{type:ecount.layer.constValue.SEARCHDROPDOWN,ecIKey:this.getEcIKey(),ownerKey:this.getOwnerKey(),controlID:f.id,command:"onQuickSearchDropdown",dataType:e,originEvent:t,selectedData:this.getSelectedData()}),u.hasClass("dropdown-menu-item dropdown-menu-item-checkbox")||u.attr("type")==this.searchDropdownListType||ecount.layer.removeLayer(this.ecIKey),!0)},ON_MOUSEOUT_SERVICE:function(){this.dropdownServiceKey&&!this._onClicked&&ecount.layer.hide(this.dropdownServiceKey)},ON_KEYDOWN_ESC_SERVICE:function(n){ecount.layer.removeLayer(this.ecIKey);n.suspend=!0},ON_KEYDOWN_ARROW_UP_SERVICE:function(n){this.selectNextOption("ArrowUp");n.suspend=!0},ON_KEYDOWN_ARROW_DOWN_SERVICE:function(n){this.selectNextOption("ArrowDown");n.suspend=!0},ON_KEYDOWN_ENTER_SERVICE:function(n,t,i,r){this.onClickApply(t,r);n.suspend=!0;ecount.layer.removeLayer(this.ecIKey)},ON_KEYDOWN_SPACE_SERVICE:function(n,t,i,r){this.checkBySpaceFocusElement(n,t,i,r);this.onClickApply(t,r);n.suspend=!0;r.dataType=="More"&&ecount.layer.removeLayer(this.ecIKey)},ON_KEYDOWN_F8_SERVICE:function(n,t,i,r){this.onClickApply(t,r);r.type=ecount.layer.constValue.SEARCHDROPDOWN;n.suspend=!0;ecount.layer.removeLayer(this.ecIKey)},ON_KEYPRESS_OTHERS_SERVICE:function(n,t,i,r){this.onClickApply(t,r);this.removeAllListActiveClass();n.suspend=!0}});ecount.class("ecount.layer.employeedetail","ecount.layer.dropdown",{template:'<div class="wrapper-orgchart-profile {{css}}" data-service="service.layer" data-servicekey="{{serviceKey}}" data-ownerkey="{{ownerKey}}"><div class="close"><\/div><\/div>',profileImgTemplate:'<div class="orgchart-profile-img" style="background-image: url({{src}})"><\/div>',profileDetailTemplate:'<div class="orgchart-profile-info"> <div class="department">{{team}}<\/div> <div class="name">{{name}}<\/div> <ul class="orgchart-profile-info-list">{{profileDatas}}<\/ul> <\/div>',serviceType:"layer",serviceName:"employeedetail",defaultImageSrc:"/static/contents/images/icon/personal-image-orgchart.png",ownerKey:null,_onClicked:!1,init:function(){ecount.layer.dropdown.prototype.init.apply(this,arguments)},getEcPath:function(){return this.ecPath},getEcIKey:function(){return this.ecIKey},setEcIKey:function(){this.ecIKey=ecount.global.registerEcServiceInstance(this,this.serviceType)},getOwnerInstance:function(){return ecount.global.getEcInstance(this.getOwnerKey())},getOwnerKey:function(){return this.ownerKey},render:function(){this.setTemplate();ecount.layout.prototype.render.apply(this,arguments);this.$el.css("z-index","1000");this.setEmployeeTemplate(this.$el)},setTemplate:function(){var n=this.employeeDetailOptions.settings;this.template=ecount.widget.replaceAttr(this.template,{ownerKey:this.getOwnerKey(),serviceKey:this.getEcIKey(),css:n.employeeImageUrl?"":"orgchart-profile-img-unused"})},setEmployeeTemplate:function(n){var t=this.employeeDetailOptions.data,i=this.employeeDetailOptions.settings,r=this.getProfileDatas(t,i);this.profileImgTemplate=ecount.widget.replaceAttr(this.profileImgTemplate,{src:_.isEmpty(t.employeeImageUrl)?this.defaultImageSrc:t.employeeImageUrl});this.template=ecount.widget.replaceAttr(this.profileDetailTemplate,{team:t.employeeTeam,name:t.employeeName,profileDatas:r});n.append(this.profileImgTemplate).append(this.template)},getProfileDatas:function(n,t){var i=ecount.resource,u="",f="",e={employeePosition:i.LBL03786,employeeTitle:i.LBL02684,employeePhone:i.LBL02509,employeeCellPhone:i.LBL00228,employeeEmail:i.LBL70053};for(var r in t)u=n[r],!t[r]||_.isUndefined(u)||_.isUndefined(e[r])||(f+=this.setProfileData(e[r],u));return f},setProfileData:function(n,t){return'<li><div class="title">{{title}}<\/div><div class="description">{{description}}<\/div><\/li>'.replace("{{title}}",n).replace("{{description}}",_.isUndefined(t)?"":t)},ON_CLICK_SERVICE:function(n,t){var i=$(t.target);i.hasClass("close")&&ecount.layer.removeLayer(this.ecIKey)},ON_MOUSEOUT_SERVICE:function(){this._onClicked||ecount.layer.removeLayer(this.ecIKey)},ON_KEYDOWN_ESC_SERVICE:function(){ecount.layer.removeLayer(this.ecIKey)}});ecount.class("ecount.layer.filegroup","ecount.layer.dropdown",{tableTemplate:'<div class="dropdown-menu {{style.css}}" data-service="service.layer" data-servicekey="{{serviceKey}}" data-ownerkey="{{ownerKey}}" style="{{style.width}}">\n<table class="table table-layout-auto  {{style.tableCss}}" style="{{style.tableWidth}}">\n{{colgroup}}\n<tbody>\n{{tbody}}\n<\/tbody>\n<\/table>\n<div data-role="menuLink"><\/div>\n<\/div>',trTemplate:"<tr>{{cell}}<\/tr>",thTemplate:'<th data-function="{{ecFunction}}" data-role="layer.thead" data-function-id="{{ecFunctionId}}" data-role-index="{{index}}" class="{{cellCss}}" style="{{cellStyle}}"><\/th>',tdTemplate:'<td data-function="{{ecFunction}}" data-function-id="{{ecFunctionId}}" data-role-index="{{index}}" class="{{cellCss}}" style="{{cellStyle}}"><\/td>',anchorTemplate:'<a href="javascript:;" class="{{css}}" data-role="layer.contents" data-parentid={{parentId}} data-index={{index}} data-function="{{ecFunction}}"data-functionId="{{ecFunctionId}}">{{label}}<\/a>',_anchorTemplate:'<a href="javascript:;" class="{{css}}" data-role="layer.footer" data-parentid={{parentId}} data-index={{index}}>{{label}}<\/a>',footerTemplate:'<div class="dropdown-menu-footer"><a href="javascript:;" class="{{css}}" data-role="layer.footer" data-parentid={{parentId}} data-index={{index}}>{{label}}<\/a><\/div>',headerDirection:null,init:function(){ecount.layout.dropdown.prototype.init.apply(this,arguments);this.headerDirection||(this.headerDirection="left")},setTableTemplate:function(n){var i,r=[],u="",f=$("<colgroup><\/colgroup>"),t;return _.isEmpty(this.colgroup)||(this.colgroup.forEach(function(n){var t=$("<col><\/col>");n.width&&t.css("width",n.width+"px");f.append(t)}),u=f.html()),i=this.tableTemplate.replace("{{colgroup}}",u),n.forEach(function(n,t){var i="";n.forEach(function(n,r){if(n.position!=widget.generator.FOOTER){if(this.headerDirection=="top"&&t==0||this.headerDirection=="left"&&r==0){i+=ecount.widget.replaceAttr(this.thTemplate,$.extend({index:r,ecFunction:"layer.row",ecFunctionId:t,cellStyle:n.cellStyle||""},n));return}i+=ecount.widget.replaceAttr(this.tdTemplate,$.extend({index:r,ecFunction:"layer.cell",ecFunctionId:t,cellCss:n.cellCss||"",cellStyle:n.cellStyle||""},n))}}.bind(this));r.push(this.trTemplate.replace("{{cell}}",i))}.bind(this)),i=i.replace("{{tbody}}",r.join("")),t=this["style.css"]||"",ecount.isMobile&&t.indexOf("generate-other-slips")>=0&&(t+=" open"),n.length>10&&(t+=" dropdown-menu-fixed-height"),ecount.widget.replaceAttr(i,{"style.tableCss":this["style.tableCss"]||"","style.width":this["style.width"]?["width:",this["style.width"],"px"].join(""):"","style.tableWidth":this["style.tableWidth"]?["width:",this["style.tableWidth"],"px"].join(""):"","style.css":t,serviceKey:this.getEcIKey(),ownerKey:this.getOwnerKey()})},addTableItems:function(n,t){for(var i,r=0,u=t.length;r<u;r++)i=!1,t[r].map(function(n){if(n.forceLink&&(i=!0),n.end&&typeof n.end=="function"){var t=n.end();return new ecount.layout.toolbar(t)}return n}).forEach(function(t,u){var f=n.find("tr:nth("+r+")").children(":nth("+u+")");switch(t.__type){case"LABEL":i?(t.css="text-default text-uline-no",f.append(ecount.widget.replaceAttr(this._anchorTemplate,t))):f.html(t.label);break;case"LINK":i||t.items.forEach(function(n){f.append(ecount.widget.replaceAttr(this.anchorTemplate,n))}.bind(this))}if(t.position==widget.generator.FOOTER){n.append(ecount.widget.replaceAttr(this.footerTemplate,t));return}}.bind(this))},addChildItems:function(n,t){var r=$(this.eventContainer||document.body),u=this.setTableTemplate(t),i=$(u);this.addTableItems(i,t);n.addClass("dropdown-menu-item-group");n.append(i);this.$el.hasClass("context-menu")||this.$el.addClass("context-menu");n.children("a").bind("mouseenter",this.onMouseoverChildUlHandler.bind(this,r,n,i));n.bind("mouseleave",function(){ecount.__isTRevokeEventMode()||n.removeClass("open")});i.bind("mouseenter",function(n){this.toggleParentDropdown(n,!0)}.bind(this));i.bind("mouseleave",function(n){ecount.__isTRevokeEventMode()||this.toggleParentDropdown(n,!1)}.bind(this))},ON_CLICK_SERVICE:function(n,t,i,r){var u=$(t.target),e=u.data("function-id"),s=u.data("click-id"),o=s||e,f=this.owner,h=this.findOriginItem(e);if(n.ecRole){if(n.ecFunction=="layer.row"&&t.target.tagName=="TH"||n.ecFunction=="layer.cell"&&t.target.tagName=="TD")return!1;r.dataset=t.target.dataset||{index:t.target.getAttribute("data-index"),functionid:t.target.getAttribute("data-functionid")}}return $.extend(r,{ecIKey:this.getEcIKey(),ownerKey:this.getOwnerKey(),targetID:["list",this._commandPrefix,o].join("-"),controlID:f&&f.id,pcontrolID:f&&f.pcid,value:u.attr("data-value"),command:"on"+(this._commandPrefix+"-"+o).split("-").select(function(n){return n.charAt(0).toUpperCase()+n.slice(1)}).join(""),control:this.getOwnerInstance(),originId:e,originEvent:t,originItem:h}),u&&$(u).parent().hasClass("dropdown-menu-item-group")||n.cid||ecount.layer.removeLayer(this.getEcIKey()),!0}});ecount.class("ecount.layer.mappingdataoption","ecount.layer.dropdown",{serviceName:"mappingdataOption",template:'<div class="areaselect-content-select-table-cell {{css}}" data-service-attr="{{serviceAttr}}" data-servicekey="{{serviceKey}}" data-ownerkey="{{ownerKey}}" style="position: absolute; {{style}}"><div class="option"><\/div><\/div>',childTemplate:'<div data-value="{{value}}" class="{{divCss}}" data-service="service.layer">{{label}}<\/div>',render:function(){this.setTemplate();ecount.layout.prototype.render.apply(this,arguments);this.setChildrenRender(this.$el.find(".option"))},setTemplate:function(){this.template=ecount.widget.replaceAttr(this.template,{ownerKey:this.getOwnerKey(),serviceKey:this.getEcIKey()})},setChildrenRender:function(n){for(var i="",t=0,r=this.items.length;t<r;t++)i+=this.childTemplate.replace("{{value}}",this.items[t].value).replace("{{label}}",this.items[t].label).replace("{{divCss}}",this.items[t].divCss||"");n.append(i)},ON_CLICK_SERVICE:function(n,t,i,r){var u=$(t.target);$.extend(r,{value:u.attr("data-value")})},ON_MOUSEOUT_SERVICE:function(){this._onClicked||ecount.layer.removeLayer(this.ecIKey)},ON_KEYDOWN_ESC_SERVICE:function(){ecount.layer.removeLayer(this.ecIKey)}});ecount.class("ecount.layer.folditem","ecount.layer.dropdown",{template:'<div class="dropdown-menu {{css}}" data-service="service.layer" data-servicekey="{{serviceKey}}" data-ownerkey="{{ownerKey}}" style="{{style}}"/>',tempItemHeader:'<div class="dropdown-menu-header"><a href="javascript:;" class="cursor-default" data-service="service.layer" data-function-id="{{id}}" data-function-section="header">'+ecount.resource.BTN00425+"<\/a><\/div>",tempItemHeaderCheckbox:['<div class="dropdown-menu-header">','<div class ="wrapper-toolbar">','<span data-service="service.layer" data-function-id="headerCheckbox" data-function-section="header" class="form-checkbox">','<input type="checkbox" data-function-id="headerCheckbox" {{checked}}>','<label data-function-id="headerCheckbox">',ecount.resource.BTN00425,"<\/label>","<\/span>","<\/div>","<\/div>"].join(""),tempItemLi:'<li><a href="javascript:;" class="cursor-default ellipsis">{{liData}}<\/a><\/li>',tempItemLiCheckbox:'<li data-function-id="bodyCheckbox" style="{{cellStyle}}"><a href="javascript:;"><span class="form-checkbox"><input type="checkbox" data-function-id="bodyCheckbox" data-cid="{{liId}}" {{checked}}><label>{{liData}}<\/label><\/span><\/a><\/li>',tempItemFooter:'<div class="dropdown-menu-footer"><div class="wrapper-toolbar"><div class="control-set"><div class="control"><button id="apply" class="btn btn-primary btn-sm btn-enter" data-function-id="apply"><\/button><\/div><\/div><\/div>',serviceName:"folditem",_templateType:"newForm",_visibleSelectLayer:null,checkboxData:{},init:function(){ecount.layout.dropdown.prototype.init.apply(this,arguments);this.isCheckbox&&this.setCheckboxData()},_getStyle:function(){return"max-width:300px"},addItems:function(n,t){var i;this.isCheckbox?(i=$('<ul class="dropdown-menu-item dropdown-menu-item-checkbox">'),n.forEach(function(n){var t="",r;t=this.notUseValue?n.label:_.isEmpty(n.css)?String.format('{0} <span class="inline-divider"/> {1}',n.label,n.value):String.format('{0} <span class="inline-divider"/> <span class="{1}">{2}<\/span>',n.label,n.css,n.value);r=this.tempItemLiCheckbox.replace("{{liData}}",t).replace("{{liId}}",n.key).replace("{{checked}}",n.checked?"checked":"");i.append(r)}.bind(this)),t.append(this.tempItemHeaderCheckbox.replace("{{checked}}",n.every(function(n){return n.checked})?"checked":"")),t.append(i),t.append(this.tempItemFooter)):(i=$('<ul class="dropdown-menu-item">'),n.forEach(function(n){var t="",r;t=_.isEmpty(n.css)?String.format('{0} <span class="inline-divider"/> {1}',n.label,n.value):String.format('{0} <span class="inline-divider"/> <span class="{1}">{2}<\/span>',n.label,n.css,n.value);r=this.tempItemLi.replace("{{liData}}",t);i.append(r)}.bind(this)),t.append(this.tempItemHeader),t.append(i))},setCheckboxData:function(){this.checkboxData={};this.items.forEach(function(n){this.checkboxData[n.key]=n.checked}.bind(this))},setHeaderCheckbox:function(n,t){var i=$(t.target).prop("checked");Object.keys(this.checkboxData).forEach(function(n){this.checkboxData[n]=i;this.$el.find('input[data-cid="'+n+'"]').prop("checked",i)}.bind(this))},setBodyCheckbox:function(n,t){var i=$(t.target).prop("checked");this.checkboxData[n.cid]=i;Object.keys(this.checkboxData).every(function(n){return this.checkboxData[n]}.bind(this))?this.$el.find('input[data-function-id="headerCheckbox"]').prop("checked",!0):this.$el.find('input[data-function-id="headerCheckbox"]').prop("checked",!1)},apply:function(n,t,i,r){r.checkedData=this.checkboxData;r.type=this.from;this.hide()},ON_CLICK_SERVICE:function(n,t,i,r){switch(n.ecFunctionId){case"headerCheckbox":return this.setHeaderCheckbox(n,t,i,r),!1;case"bodyCheckbox":return this.setBodyCheckbox(n,t,i,r),!1;case"apply":return this.apply(n,t,i,r),r.command="onClickCheckboxItemLayer",r.gridId=this.ecContainerId,!0}return!1}});